"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[1492],{7665:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"entity-patterns","title":"Entity Definition Patterns","description":"Learn how to define entities, DTOs, and attributes for your domain.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/entity-patterns.md","sourceDirName":".","slug":"/entity-patterns","permalink":"/docs/entity-patterns","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"description":"Learn how to define entities, DTOs, and attributes for your domain."},"sidebar":"tutorialSidebar","previous":{"title":"Key Design Patterns","permalink":"/docs/key-patterns"},"next":{"title":"Version Conflict Guide","permalink":"/docs/version-conflict-guide"}}');var s=t(4848),i=t(8453);const d={description:"Learn how to define entities, DTOs, and attributes for your domain."},a="Entity Definition Patterns",c={},o=[{value:"When to Use This Guide",id:"when-to-use-this-guide",level:2},{value:"Problems This Pattern Solves",id:"problems-this-pattern-solves",level:2},{value:"Entity Types Overview",id:"entity-types-overview",level:2},{value:"Data Entity",id:"data-entity",level:2},{value:"Use Case: Return Data from API Queries",id:"use-case-return-data-from-api-queries",level:3},{value:"Command Entity",id:"command-entity",level:2},{value:"Use Case: Create or Update Data via Commands",id:"use-case-create-or-update-data-via-commands",level:3},{value:"Data List Entity",id:"data-list-entity",level:2},{value:"Use Case: Return Paginated Lists",id:"use-case-return-paginated-lists",level:3},{value:"Command DTO",id:"command-dto",level:2},{value:"Use Case: Prepare Data for Command Publishing",id:"use-case-prepare-data-for-command-publishing",level:3},{value:"Attributes DTO",id:"attributes-dto",level:2},{value:"Use Case: Define Business Data Structure",id:"use-case-define-business-data-structure",level:3},{value:"Create/Update DTOs",id:"createupdate-dtos",level:2},{value:"Use Case: Validate API Input",id:"use-case-validate-api-input",level:3},{value:"Detail/Search DTOs",id:"detailsearch-dtos",level:2},{value:"Use Case: Query Parameters for List and Detail Endpoints",id:"use-case-query-parameters-for-list-and-detail-endpoints",level:3},{value:"Complete Domain Example",id:"complete-domain-example",level:2},{value:"Use Case: Full E-Commerce Order Domain",id:"use-case-full-e-commerce-order-domain",level:3},{value:"Directory Structure",id:"directory-structure",level:3},{value:"Enums",id:"enums",level:3},{value:"Attributes DTO",id:"attributes-dto-1",level:3},{value:"Data Entity",id:"data-entity-1",level:3},{value:"Command Entity",id:"command-entity-1",level:3},{value:"List Entity",id:"list-entity",level:3},{value:"Command DTO",id:"command-dto-1",level:3},{value:"Create DTO",id:"create-dto",level:3},{value:"Update DTO",id:"update-dto",level:3},{value:"Search DTO",id:"search-dto",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Separate Read and Write Entities",id:"1-separate-read-and-write-entities",level:3},{value:"2. Use Typed Attributes",id:"2-use-typed-attributes",level:3},{value:"3. Add Computed Properties",id:"3-add-computed-properties",level:3},{value:"4. Validate Input DTOs",id:"4-validate-input-dtos",level:3},{value:"5. Use Enums for Status Fields",id:"5-use-enums-for-status-fields",level:3}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"entity-definition-patterns",children:"Entity Definition Patterns"})}),"\n",(0,s.jsx)(n.p,{children:"This guide explains how to define entities, DTOs, and attributes in MBC CQRS Serverless applications. Proper entity definition ensures type safety, clear separation of read and write operations, and maintainable code."}),"\n",(0,s.jsx)(n.h2,{id:"when-to-use-this-guide",children:"When to Use This Guide"}),"\n",(0,s.jsx)(n.p,{children:"Use this guide when you need to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create a new domain entity (Product, Order, User, etc.)"}),"\n",(0,s.jsx)(n.li,{children:"Define input validation for API endpoints"}),"\n",(0,s.jsx)(n.li,{children:"Structure data for DynamoDB storage and RDS synchronization"}),"\n",(0,s.jsx)(n.li,{children:"Implement pagination for list queries"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"problems-this-pattern-solves",children:"Problems This Pattern Solves"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Problem"}),(0,s.jsx)(n.th,{children:"Solution"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"No type safety for entity attributes"}),(0,s.jsx)(n.td,{children:"Define TypeScript interfaces for attributes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Same entity used for reads and writes causes confusion"}),(0,s.jsx)(n.td,{children:"Separate DataEntity (read) and CommandEntity (write)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Inconsistent validation across endpoints"}),(0,s.jsx)(n.td,{children:"Use DTOs with class-validator decorators"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Missing audit fields (createdAt, updatedAt)"}),(0,s.jsx)(n.td,{children:"Base classes include standard audit fields"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"entity-types-overview",children:"Entity Types Overview"}),"\n",(0,s.jsx)(n.p,{children:"The framework provides three base entity classes:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Class"}),(0,s.jsx)(n.th,{children:"Purpose"}),(0,s.jsx)(n.th,{children:"Usage"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DataEntity"})}),(0,s.jsx)(n.td,{children:"Read operations"}),(0,s.jsx)(n.td,{children:"Query results from DynamoDB/RDS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CommandEntity"})}),(0,s.jsx)(n.td,{children:"Write operations"}),(0,s.jsx)(n.td,{children:"Commands sent to DynamoDB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DataListEntity"})}),(0,s.jsx)(n.td,{children:"Paginated lists"}),(0,s.jsx)(n.td,{children:"List responses with metadata"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"data-entity",children:"Data Entity"}),"\n",(0,s.jsx)(n.h3,{id:"use-case-return-data-from-api-queries",children:"Use Case: Return Data from API Queries"}),"\n",(0,s.jsx)(n.p,{children:"Scenario: Your API needs to return product information to the frontend."}),"\n",(0,s.jsx)(n.p,{children:"Problem: Raw DynamoDB items lack type safety and may contain version suffixes in keys."}),"\n",(0,s.jsx)(n.p,{children:"Solution: Use DataEntity to wrap query results with typed attributes and computed properties."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { DataEntity } from "@mbc-cqrs-serverless/core";\n\nexport interface ProductAttributes {\n  description: string;\n  price: number;\n  category: string;\n  inStock: boolean;\n  tags?: string[];\n}\n\nexport class ProductDataEntity extends DataEntity {\n  attributes: ProductAttributes;\n\n  constructor(partial: Partial<ProductDataEntity>) {\n    super(partial);\n    Object.assign(this, partial);\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"DataEntity"})," base class includes:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pk"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Partition key. Format: ",(0,s.jsx)(n.code,{children:"{tenantCode}#{entityType}"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sk"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Sort key. Format: ",(0,s.jsx)(n.code,{children:"{entityType}#{entityId}"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"id"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Unique entity identifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"code"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Business code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"name"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Display name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"version"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Version number for optimistic locking"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"tenantCode"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Tenant code for multi-tenant isolation"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"type"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Entity type identifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cpk"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Command partition key - references source command record"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"csk"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Command sort key with version - references exact command version"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"seq"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Sequence number"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ttl"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Time-to-live in seconds for DynamoDB TTL"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"isDeleted"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Soft delete flag"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"source"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Event source identifier (e.g., 'POST /api/master', 'SQS')"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"requestId"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Unique request ID for tracing and idempotency"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"createdAt"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Date"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Timestamp when the entity was created"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"createdBy"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"User ID who created the entity"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"createdIp"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"IP address of the creator"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"updatedAt"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Date"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Timestamp when the entity was last updated"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"updatedBy"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"User ID who last updated the entity"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"updatedIp"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"IP address of the last updater"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"attributes"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"any"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Custom attributes object for domain-specific data"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"key"})," getter returns a ",(0,s.jsx)(n.code,{children:"DetailKey"})," object with ",(0,s.jsx)(n.code,{children:"pk"})," and ",(0,s.jsx)(n.code,{children:"sk"})," for DynamoDB operations."]}),"\n",(0,s.jsx)(n.h2,{id:"command-entity",children:"Command Entity"}),"\n",(0,s.jsx)(n.h3,{id:"use-case-create-or-update-data-via-commands",children:"Use Case: Create or Update Data via Commands"}),"\n",(0,s.jsx)(n.p,{children:"Scenario: User submits a form to create a new product or update an existing one."}),"\n",(0,s.jsx)(n.p,{children:"Problem: Need to structure data for DynamoDB command publishing with proper keys and version."}),"\n",(0,s.jsx)(n.p,{children:"Solution: Use CommandEntity to structure write operations with required fields for CQRS command processing."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { CommandEntity } from "@mbc-cqrs-serverless/core";\n\nexport interface ProductAttributes {\n  description: string;\n  price: number;\n  category: string;\n  inStock: boolean;\n  tags?: string[];\n}\n\nexport class ProductCommandEntity extends CommandEntity {\n  attributes: ProductAttributes;\n\n  constructor(partial: Partial<ProductCommandEntity>) {\n    super();\n    Object.assign(this, partial);\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"CommandEntity"})," base class includes:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pk"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Partition key. Format: ",(0,s.jsx)(n.code,{children:"{tenantCode}#{entityType}"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sk"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Sort key. Format: ",(0,s.jsx)(n.code,{children:"{entityType}#{entityId}@{version}"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"id"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Unique entity identifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"code"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Business code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"name"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Display name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"version"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Version number for optimistic locking"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"tenantCode"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Tenant code for multi-tenant isolation"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"type"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Entity type identifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"status"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Processing status (e.g., 'PENDING', 'COMPLETED', 'FAILED')"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"seq"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Sequence number"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ttl"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Time-to-live in seconds for DynamoDB TTL"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"isDeleted"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Soft delete flag"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"source"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Event source identifier (e.g., 'POST /api/master', 'SQS')"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"requestId"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Unique request ID for tracing and idempotency"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"createdAt"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Date"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Timestamp when the command was created"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"createdBy"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"User ID who created the command"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"createdIp"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"IP address of the creator"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"updatedAt"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Date"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Timestamp when the command was last updated"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"updatedBy"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"User ID who last updated the command"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"updatedIp"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"IP address of the last updater"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"attributes"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"any"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Custom attributes object for domain-specific data"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"key"})," getter returns a ",(0,s.jsx)(n.code,{children:"DetailKey"})," object with ",(0,s.jsx)(n.code,{children:"pk"})," and ",(0,s.jsx)(n.code,{children:"sk"})," for DynamoDB operations."]}),"\n",(0,s.jsxs)(n.admonition,{title:"CommandEntity vs DataEntity",type:"info",children:[(0,s.jsxs)(n.p,{children:["The main differences between ",(0,s.jsx)(n.code,{children:"CommandEntity"})," and ",(0,s.jsx)(n.code,{children:"DataEntity"})," are:"]}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Aspect"}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.code,{children:"CommandEntity"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.code,{children:"DataEntity"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Table"}),(0,s.jsx)(n.td,{children:"Command (write) table"}),(0,s.jsx)(n.td,{children:"Data (read) table"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Sort Key"}),(0,s.jsxs)(n.td,{children:["Includes version suffix (",(0,s.jsx)(n.code,{children:"@{version}"}),")"]}),(0,s.jsx)(n.td,{children:"No version suffix"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"status"})}),(0,s.jsx)(n.td,{children:"Yes (processing status)"}),(0,s.jsx)(n.td,{children:"No"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"cpk"}),"/",(0,s.jsx)(n.code,{children:"csk"})]}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Yes (references source command)"})]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"data-list-entity",children:"Data List Entity"}),"\n",(0,s.jsx)(n.h3,{id:"use-case-return-paginated-lists",children:"Use Case: Return Paginated Lists"}),"\n",(0,s.jsx)(n.p,{children:"Scenario: Frontend requests a list of products with pagination."}),"\n",(0,s.jsx)(n.p,{children:"Problem: Need to return both the items and total count for pagination UI."}),"\n",(0,s.jsx)(n.p,{children:"Solution: Use DataListEntity to wrap list results with total count and pagination cursor."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { DataListEntity } from "@mbc-cqrs-serverless/core";\nimport { ProductDataEntity } from "./product-data.entity";\n\nexport class ProductListEntity extends DataListEntity {\n  items: ProductDataEntity[];\n\n  constructor(partial: Partial<ProductListEntity>) {\n    super(partial);\n    Object.assign(this, partial);\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"DataListEntity"})," base class includes:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Inherited from DataListEntity\n{\n  total: number;        // Total count\n  lastSk?: string;      // Last sort key for pagination\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"command-dto",children:"Command DTO"}),"\n",(0,s.jsx)(n.h3,{id:"use-case-prepare-data-for-command-publishing",children:"Use Case: Prepare Data for Command Publishing"}),"\n",(0,s.jsx)(n.p,{children:"Scenario: Service layer needs to create a command from validated input."}),"\n",(0,s.jsx)(n.p,{children:"Solution: Use CommandDto to transform input data into the structure required by CommandService."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { CommandDto } from "@mbc-cqrs-serverless/core";\n\nexport interface ProductAttributes {\n  description: string;\n  price: number;\n  category: string;\n  inStock: boolean;\n  tags?: string[];\n}\n\nexport class ProductCommandDto extends CommandDto {\n  attributes: ProductAttributes;\n\n  constructor(partial: Partial<ProductCommandDto>) {\n    super();\n    Object.assign(this, partial);\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.admonition,{title:"CommandDto Features",type:"info",children:[(0,s.jsxs)(n.p,{children:["The base ",(0,s.jsx)(n.code,{children:"CommandDto"})," class includes:"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Swagger decorators (",(0,s.jsx)(n.code,{children:"@ApiProperty"}),", ",(0,s.jsx)(n.code,{children:"@ApiPropertyOptional"}),") for API documentation"]}),"\n",(0,s.jsxs)(n.li,{children:["Validation decorators from ",(0,s.jsx)(n.code,{children:"class-validator"})," (",(0,s.jsx)(n.code,{children:"@IsString"}),", ",(0,s.jsx)(n.code,{children:"@IsNumber"}),", ",(0,s.jsx)(n.code,{children:"@IsOptional"}),", etc.)"]}),"\n",(0,s.jsxs)(n.li,{children:["Properties: ",(0,s.jsx)(n.code,{children:"pk"}),", ",(0,s.jsx)(n.code,{children:"sk"}),", ",(0,s.jsx)(n.code,{children:"id"}),", ",(0,s.jsx)(n.code,{children:"code"}),", ",(0,s.jsx)(n.code,{children:"name"}),", ",(0,s.jsx)(n.code,{children:"version"}),", ",(0,s.jsx)(n.code,{children:"tenantCode"})," (optional), ",(0,s.jsx)(n.code,{children:"type"}),", ",(0,s.jsx)(n.code,{children:"isDeleted"}),", ",(0,s.jsx)(n.code,{children:"seq"}),", ",(0,s.jsx)(n.code,{children:"ttl"}),", ",(0,s.jsx)(n.code,{children:"attributes"})]}),"\n"]}),(0,s.jsxs)(n.p,{children:["Note: ",(0,s.jsx)(n.code,{children:"tenantCode"})," is marked as optional (",(0,s.jsx)(n.code,{children:"@IsOptional()"}),") in the base class, allowing the framework to extract it from the invoke context if not provided."]})]}),"\n",(0,s.jsx)(n.h2,{id:"attributes-dto",children:"Attributes DTO"}),"\n",(0,s.jsx)(n.h3,{id:"use-case-define-business-data-structure",children:"Use Case: Define Business Data Structure"}),"\n",(0,s.jsx)(n.p,{children:"Scenario: Your entity has business-specific fields like price, status, and shipping information."}),"\n",(0,s.jsx)(n.p,{children:"Solution: Define TypeScript interfaces that describe the structure of your domain data."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// Simple attributes\nexport interface ProductAttributes {\n  description: string;\n  price: number;\n  category: string;\n  inStock: boolean;\n}\n\n// Complex attributes with nested objects\nexport interface OrderAttributes {\n  customerId: string;\n  status: OrderStatus;\n  items: OrderItem[];\n  shipping: {\n    address: string;\n    city: string;\n    postalCode: string;\n    country: string;\n  };\n  payment: {\n    method: PaymentMethod;\n    transactionId?: string;\n    paidAt?: string;\n  };\n  totalAmount: number;\n  currency: string;\n}\n\ninterface OrderItem {\n  productId: string;\n  productName: string;\n  quantity: number;\n  unitPrice: number;\n  subtotal: number;\n}\n\nenum OrderStatus {\n  PENDING = "PENDING",\n  CONFIRMED = "CONFIRMED",\n  SHIPPED = "SHIPPED",\n  DELIVERED = "DELIVERED",\n  CANCELLED = "CANCELLED",\n}\n\nenum PaymentMethod {\n  CREDIT_CARD = "CREDIT_CARD",\n  BANK_TRANSFER = "BANK_TRANSFER",\n  CASH_ON_DELIVERY = "CASH_ON_DELIVERY",\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"createupdate-dtos",children:"Create/Update DTOs"}),"\n",(0,s.jsx)(n.h3,{id:"use-case-validate-api-input",children:"Use Case: Validate API Input"}),"\n",(0,s.jsx)(n.p,{children:"Scenario: API receives JSON from frontend and needs to validate before processing."}),"\n",(0,s.jsx)(n.p,{children:"Problem: Invalid data (empty strings, negative prices) could corrupt your data store."}),"\n",(0,s.jsx)(n.p,{children:"Solution: Use class-validator decorators to define validation rules that run automatically."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { IsString, IsNumber, IsBoolean, IsOptional, Min } from "class-validator";\n\nexport class CreateProductDto {\n  @IsString()\n  name: string;\n\n  @IsString()\n  description: string;\n\n  @IsNumber()\n  @Min(0)\n  price: number;\n\n  @IsString()\n  category: string;\n\n  @IsBoolean()\n  @IsOptional()\n  inStock?: boolean;\n}\n\nexport class UpdateProductDto {\n  @IsString()\n  @IsOptional()\n  name?: string;\n\n  @IsOptional()\n  attributes?: Partial<ProductAttributes>;\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"detailsearch-dtos",children:"Detail/Search DTOs"}),"\n",(0,s.jsx)(n.h3,{id:"use-case-query-parameters-for-list-and-detail-endpoints",children:"Use Case: Query Parameters for List and Detail Endpoints"}),"\n",(0,s.jsx)(n.p,{children:"Scenario: Frontend sends query parameters for filtering, pagination, and detail lookups."}),"\n",(0,s.jsx)(n.p,{children:"Solution: Define DTOs that validate query parameters and provide default values."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { IsString, IsOptional, IsNumber, Min, Max } from "class-validator";\nimport { Type } from "class-transformer";\n\n// For single item lookup\nexport class DetailDto {\n  @IsString()\n  pk: string;\n\n  @IsString()\n  sk: string;\n}\n\n// For list queries\nexport class SearchProductDto {\n  @IsString()\n  tenantCode: string;\n\n  @IsString()\n  @IsOptional()\n  category?: string;\n\n  @IsBoolean()\n  @IsOptional()\n  inStock?: boolean;\n\n  @IsString()\n  @IsOptional()\n  search?: string;\n\n  @IsNumber()\n  @IsOptional()\n  @Type(() => Number)\n  @Min(1)\n  page?: number = 1;\n\n  @IsNumber()\n  @IsOptional()\n  @Type(() => Number)\n  @Min(1)\n  @Max(100)\n  limit?: number = 20;\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"complete-domain-example",children:"Complete Domain Example"}),"\n",(0,s.jsx)(n.h3,{id:"use-case-full-e-commerce-order-domain",children:"Use Case: Full E-Commerce Order Domain"}),"\n",(0,s.jsx)(n.p,{children:"Scenario: Building an order management system with orders, items, shipping, and payment."}),"\n",(0,s.jsx)(n.p,{children:"This example shows how all entity patterns work together in a real domain:"}),"\n",(0,s.jsx)(n.h3,{id:"directory-structure",children:"Directory Structure"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"src/order/\n\u251c\u2500\u2500 order.module.ts\n\u251c\u2500\u2500 order.service.ts\n\u251c\u2500\u2500 order.controller.ts\n\u251c\u2500\u2500 entity/\n\u2502   \u251c\u2500\u2500 order-data.entity.ts\n\u2502   \u251c\u2500\u2500 order-command.entity.ts\n\u2502   \u2514\u2500\u2500 order-list.entity.ts\n\u251c\u2500\u2500 dto/\n\u2502   \u251c\u2500\u2500 order-command.dto.ts\n\u2502   \u251c\u2500\u2500 order-attributes.dto.ts\n\u2502   \u251c\u2500\u2500 create-order.dto.ts\n\u2502   \u251c\u2500\u2500 update-order.dto.ts\n\u2502   \u251c\u2500\u2500 detail.dto.ts\n\u2502   \u2514\u2500\u2500 search-order.dto.ts\n\u251c\u2500\u2500 handler/\n\u2502   \u2514\u2500\u2500 order-rds.handler.ts\n\u2514\u2500\u2500 constant/\n    \u2514\u2500\u2500 order.enum.ts\n"})}),"\n",(0,s.jsx)(n.h3,{id:"enums",children:"Enums"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// constant/order.enum.ts\nexport enum OrderStatus {\n  DRAFT = "DRAFT",\n  PENDING = "PENDING",\n  CONFIRMED = "CONFIRMED",\n  PROCESSING = "PROCESSING",\n  SHIPPED = "SHIPPED",\n  DELIVERED = "DELIVERED",\n  CANCELLED = "CANCELLED",\n  REFUNDED = "REFUNDED",\n}\n\nexport enum PaymentMethod {\n  CREDIT_CARD = "CREDIT_CARD",\n  DEBIT_CARD = "DEBIT_CARD",\n  BANK_TRANSFER = "BANK_TRANSFER",\n  DIGITAL_WALLET = "DIGITAL_WALLET",\n  CASH_ON_DELIVERY = "CASH_ON_DELIVERY",\n}\n\nexport enum PaymentStatus {\n  PENDING = "PENDING",\n  AUTHORIZED = "AUTHORIZED",\n  CAPTURED = "CAPTURED",\n  FAILED = "FAILED",\n  REFUNDED = "REFUNDED",\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"attributes-dto-1",children:"Attributes DTO"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// dto/order-attributes.dto.ts\nimport { OrderStatus, PaymentMethod, PaymentStatus } from "../constant/order.enum";\n\nexport interface OrderItem {\n  productId: string;\n  productCode: string;\n  productName: string;\n  quantity: number;\n  unitPrice: number;\n  discount: number;\n  subtotal: number;\n}\n\nexport interface ShippingInfo {\n  recipientName: string;\n  phoneNumber: string;\n  address: string;\n  city: string;\n  state: string;\n  postalCode: string;\n  country: string;\n  instructions?: string;\n}\n\nexport interface PaymentInfo {\n  method: PaymentMethod;\n  status: PaymentStatus;\n  transactionId?: string;\n  authorizedAt?: string;\n  capturedAt?: string;\n}\n\nexport interface OrderAttributes {\n  customerId: string;\n  customerEmail: string;\n  status: OrderStatus;\n  items: OrderItem[];\n  shipping: ShippingInfo;\n  payment: PaymentInfo;\n  subtotal: number;\n  shippingFee: number;\n  tax: number;\n  discount: number;\n  totalAmount: number;\n  currency: string;\n  notes?: string;\n  orderedAt: string;\n  confirmedAt?: string;\n  shippedAt?: string;\n  deliveredAt?: string;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"data-entity-1",children:"Data Entity"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// entity/order-data.entity.ts\nimport { DataEntity } from "@mbc-cqrs-serverless/core";\nimport { OrderAttributes } from "../dto/order-attributes.dto";\n\nexport class OrderDataEntity extends DataEntity {\n  attributes: OrderAttributes;\n\n  constructor(partial: Partial<OrderDataEntity>) {\n    super(partial);\n    Object.assign(this, partial);\n  }\n\n  // Computed properties\n  get status(): string {\n    return this.attributes?.status;\n  }\n\n  get totalAmount(): number {\n    return this.attributes?.totalAmount ?? 0;\n  }\n\n  get itemCount(): number {\n    return this.attributes?.items?.length ?? 0;\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"command-entity-1",children:"Command Entity"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// entity/order-command.entity.ts\nimport { CommandEntity } from "@mbc-cqrs-serverless/core";\nimport { OrderAttributes } from "../dto/order-attributes.dto";\n\nexport class OrderCommandEntity extends CommandEntity {\n  attributes: OrderAttributes;\n\n  constructor(partial: Partial<OrderCommandEntity>) {\n    super();\n    Object.assign(this, partial);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"list-entity",children:"List Entity"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// entity/order-list.entity.ts\nimport { DataListEntity } from "@mbc-cqrs-serverless/core";\nimport { OrderDataEntity } from "./order-data.entity";\n\nexport class OrderListEntity extends DataListEntity {\n  items: OrderDataEntity[];\n\n  constructor(partial: Partial<OrderListEntity>) {\n    super(partial);\n    Object.assign(this, partial);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"command-dto-1",children:"Command DTO"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// dto/order-command.dto.ts\nimport { CommandDto } from "@mbc-cqrs-serverless/core";\nimport { OrderAttributes } from "./order-attributes.dto";\n\nexport class OrderCommandDto extends CommandDto {\n  attributes: OrderAttributes;\n\n  constructor(partial: Partial<OrderCommandDto>) {\n    super();\n    Object.assign(this, partial);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"create-dto",children:"Create DTO"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// dto/create-order.dto.ts\nimport {\n  IsString,\n  IsEmail,\n  IsArray,\n  ValidateNested,\n  IsNumber,\n  Min,\n  IsOptional,\n} from "class-validator";\nimport { Type } from "class-transformer";\n\nclass CreateOrderItemDto {\n  @IsString()\n  productId: string;\n\n  @IsNumber()\n  @Min(1)\n  quantity: number;\n}\n\nclass CreateShippingDto {\n  @IsString()\n  recipientName: string;\n\n  @IsString()\n  phoneNumber: string;\n\n  @IsString()\n  address: string;\n\n  @IsString()\n  city: string;\n\n  @IsString()\n  state: string;\n\n  @IsString()\n  postalCode: string;\n\n  @IsString()\n  country: string;\n\n  @IsString()\n  @IsOptional()\n  instructions?: string;\n}\n\nexport class CreateOrderDto {\n  @IsString()\n  customerId: string;\n\n  @IsEmail()\n  customerEmail: string;\n\n  @IsArray()\n  @ValidateNested({ each: true })\n  @Type(() => CreateOrderItemDto)\n  items: CreateOrderItemDto[];\n\n  @ValidateNested()\n  @Type(() => CreateShippingDto)\n  shipping: CreateShippingDto;\n\n  @IsString()\n  @IsOptional()\n  notes?: string;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"update-dto",children:"Update DTO"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// dto/update-order.dto.ts\nimport { IsString, IsEnum, IsOptional, ValidateNested } from "class-validator";\nimport { Type } from "class-transformer";\nimport { OrderStatus, PaymentStatus } from "../constant/order.enum";\n\nclass UpdateShippingDto {\n  @IsString()\n  @IsOptional()\n  recipientName?: string;\n\n  @IsString()\n  @IsOptional()\n  phoneNumber?: string;\n\n  @IsString()\n  @IsOptional()\n  address?: string;\n\n  @IsString()\n  @IsOptional()\n  instructions?: string;\n}\n\nexport class UpdateOrderDto {\n  @IsEnum(OrderStatus)\n  @IsOptional()\n  status?: OrderStatus;\n\n  @ValidateNested()\n  @Type(() => UpdateShippingDto)\n  @IsOptional()\n  shipping?: UpdateShippingDto;\n\n  @IsString()\n  @IsOptional()\n  notes?: string;\n}\n\nexport class UpdatePaymentDto {\n  @IsEnum(PaymentStatus)\n  status: PaymentStatus;\n\n  @IsString()\n  @IsOptional()\n  transactionId?: string;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"search-dto",children:"Search DTO"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// dto/search-order.dto.ts\nimport { IsString, IsEnum, IsOptional, IsNumber, Min, Max, IsDateString } from "class-validator";\nimport { Type } from "class-transformer";\nimport { OrderStatus } from "../constant/order.enum";\n\nexport class SearchOrderDto {\n  @IsString()\n  tenantCode: string;\n\n  @IsString()\n  @IsOptional()\n  customerId?: string;\n\n  @IsEnum(OrderStatus)\n  @IsOptional()\n  status?: OrderStatus;\n\n  @IsDateString()\n  @IsOptional()\n  orderedFrom?: string;\n\n  @IsDateString()\n  @IsOptional()\n  orderedTo?: string;\n\n  @IsNumber()\n  @IsOptional()\n  @Type(() => Number)\n  minAmount?: number;\n\n  @IsNumber()\n  @IsOptional()\n  @Type(() => Number)\n  maxAmount?: number;\n\n  @IsNumber()\n  @IsOptional()\n  @Type(() => Number)\n  @Min(1)\n  page?: number = 1;\n\n  @IsNumber()\n  @IsOptional()\n  @Type(() => Number)\n  @Min(1)\n  @Max(100)\n  limit?: number = 20;\n\n  @IsString()\n  @IsOptional()\n  sortBy?: "orderedAt" | "totalAmount" | "status" = "orderedAt";\n\n  @IsString()\n  @IsOptional()\n  sortOrder?: "asc" | "desc" = "desc";\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"1-separate-read-and-write-entities",children:"1. Separate Read and Write Entities"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"DataEntity"})," for reads and ",(0,s.jsx)(n.code,{children:"CommandEntity"})," for writes:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Read operations return DataEntity\nasync findOne(key: DetailDto): Promise<OrderDataEntity>\n\n// Write operations return DataEntity (after command is processed)\nasync create(dto: CreateOrderDto): Promise<OrderDataEntity>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-use-typed-attributes",children:"2. Use Typed Attributes"}),"\n",(0,s.jsx)(n.p,{children:"Always define interfaces for attributes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"interface ProductAttributes {\n  description: string;\n  price: number;\n  // ...\n}\n\n// Not this:\nattributes: Record<string, any>  // Avoid\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-add-computed-properties",children:"3. Add Computed Properties"}),"\n",(0,s.jsx)(n.p,{children:"Add getters for commonly accessed nested data:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export class OrderDataEntity extends DataEntity {\n  attributes: OrderAttributes;\n\n  get totalAmount(): number {\n    return this.attributes?.totalAmount ?? 0;\n  }\n\n  get isPaid(): boolean {\n    return this.attributes?.payment?.status === PaymentStatus.CAPTURED;\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-validate-input-dtos",children:"4. Validate Input DTOs"}),"\n",(0,s.jsx)(n.p,{children:"Use class-validator for input validation:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { IsString, IsNumber, Min, IsEmail } from "class-validator";\n\nexport class CreateOrderDto {\n  @IsEmail()\n  customerEmail: string;\n\n  @IsNumber()\n  @Min(0)\n  totalAmount: number;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"5-use-enums-for-status-fields",children:"5. Use Enums for Status Fields"}),"\n",(0,s.jsx)(n.p,{children:"Define enums for status and type fields:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'enum OrderStatus {\n  PENDING = "PENDING",\n  CONFIRMED = "CONFIRMED",\n  // ...\n}\n\n// In DTO\n@IsEnum(OrderStatus)\nstatus: OrderStatus;\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>a});var r=t(6540);const s={},i=r.createContext(s);function d(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);