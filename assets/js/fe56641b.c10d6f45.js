"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[4390],{5930:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"monitoring-logging","title":"Monitoring and Logging","description":"Set up monitoring and logging for your MBC CQRS Serverless application.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/monitoring-logging.md","sourceDirName":".","slug":"/monitoring-logging","permalink":"/docs/monitoring-logging","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"description":"Set up monitoring and logging for your MBC CQRS Serverless application."},"sidebar":"tutorialSidebar","previous":{"title":"CI/CD with CodePipeline","permalink":"/docs/codepipeline-cicd"},"next":{"title":"Configuring","permalink":"/docs/configuring"}}');var i=t(4848),s=t(8453);const a={description:"Set up monitoring and logging for your MBC CQRS Serverless application."},o="Monitoring and Logging",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Built-in Features",id:"built-in-features",level:3},{value:"CloudWatch Logs",id:"cloudwatch-logs",level:2},{value:"Lambda Logging",id:"lambda-logging",level:3},{value:"Log Retention",id:"log-retention",level:3},{value:"Log Format",id:"log-format",level:3},{value:"CloudWatch Metrics",id:"cloudwatch-metrics",level:2},{value:"Custom Metrics",id:"custom-metrics",level:3},{value:"Key Metrics to Monitor",id:"key-metrics-to-monitor",level:3},{value:"CDK Dashboard",id:"cdk-dashboard",level:3},{value:"CloudWatch Alarms",id:"cloudwatch-alarms",level:2},{value:"Create Alarms",id:"create-alarms",level:3},{value:"Recommended Alarms",id:"recommended-alarms",level:3},{value:"AWS X-Ray Tracing",id:"aws-x-ray-tracing",level:2},{value:"Enable X-Ray",id:"enable-x-ray",level:3},{value:"Instrument Application",id:"instrument-application",level:3},{value:"Centralized Logging",id:"centralized-logging",level:2},{value:"Log Aggregation Pattern",id:"log-aggregation-pattern",level:3},{value:"Log Insights Queries",id:"log-insights-queries",level:3},{value:"Application Performance Monitoring",id:"application-performance-monitoring",level:2},{value:"Performance Metrics",id:"performance-metrics",level:3},{value:"Health Checks",id:"health-checks",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Logging",id:"logging",level:3},{value:"Metrics",id:"metrics",level:3},{value:"Alerting",id:"alerting",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"monitoring-and-logging",children:"Monitoring and Logging"})}),"\n",(0,i.jsx)(n.p,{children:"This guide covers setting up comprehensive monitoring and logging for MBC CQRS Serverless applications on AWS."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"A complete observability strategy includes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logging"}),": Capturing application events and errors"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Metrics"}),": Measuring performance and usage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tracing"}),": Following requests across services"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Alerting"}),": Notifying on issues"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"built-in-features",children:"Built-in Features"}),"\n",(0,i.jsx)(n.p,{children:"The MBC CQRS Serverless framework provides the following observability features out-of-the-box:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"RequestLogger"}),": Extended NestJS logger with context (tenantCode, userId, requestId, sourceIp)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AWS X-Ray Tracing"}),": Enabled by default in the CDK template for Lambda and Step Functions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"JSON Logging Format"}),": Lambda functions log in JSON format for easy querying"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Configurable Log Levels"}),": Set via LOG_LEVEL environment variable"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{title:"AWS Services Guidance",type:"info",children:(0,i.jsx)(n.p,{children:"The sections below provide guidance on setting up additional AWS CloudWatch features (metrics, dashboards, alarms). These are not built into the framework but are recommended patterns for production deployments."})}),"\n",(0,i.jsx)(n.h2,{id:"cloudwatch-logs",children:"CloudWatch Logs"}),"\n",(0,i.jsx)(n.h3,{id:"lambda-logging",children:"Lambda Logging"}),"\n",(0,i.jsx)(n.p,{children:"The framework includes a built-in RequestLogger that automatically adds context to your logs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// The framework's RequestLogger is used automatically\n// Log output includes: context, requestId, ip, tenantCode, userId\n\nimport { Logger, Injectable } from '@nestjs/common';\n\n@Injectable()\nexport class YourService {\n  private readonly logger = new Logger(YourService.name);\n\n  async doSomething() {\n    // These logs automatically include user context in Lambda\n    this.logger.log('Operation started');\n    this.logger.debug('Debug information');\n    this.logger.error('Error occurred');\n  }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can enhance with structured logging for more detailed tracking:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { Logger, Injectable } from '@nestjs/common';\n\n@Injectable()\nexport class TodoService {\n  private readonly logger = new Logger(TodoService.name);\n\n  async create(dto: CreateTodoDto): Promise<Todo> {\n    this.logger.log({\n      action: 'create_todo',\n      input: dto,\n      userId: context.userId,\n    });\n\n    try {\n      const result = await this.save(dto);\n      this.logger.log({\n        action: 'todo_created',\n        todoId: result.id,\n        duration: Date.now() - startTime,\n      });\n      return result;\n    } catch (error) {\n      this.logger.error({\n        action: 'create_todo_failed',\n        error: error.message,\n        stack: error.stack,\n      });\n      throw error;\n    }\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"log-retention",children:"Log Retention"}),"\n",(0,i.jsx)(n.p,{children:"Configure log retention in CDK:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import * as logs from 'aws-cdk-lib/aws-logs';\n\nconst logGroup = new logs.LogGroup(this, 'AppLogGroup', {\n  logGroupName: `/aws/lambda/${props.appName}-${props.envName}`,\n  retention: logs.RetentionDays.ONE_MONTH,\n  removalPolicy: cdk.RemovalPolicy.DESTROY,\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"log-format",children:"Log Format"}),"\n",(0,i.jsx)(n.p,{children:"Recommended log format for easy querying:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface LogEntry {\n  timestamp: string;\n  level: 'DEBUG' | 'INFO' | 'WARN' | 'ERROR';\n  message: string;\n  context: string;\n  correlationId?: string;\n  userId?: string;\n  duration?: number;\n  error?: {\n    name: string;\n    message: string;\n    stack: string;\n  };\n  metadata?: Record<string, any>;\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"cloudwatch-metrics",children:"CloudWatch Metrics"}),"\n",(0,i.jsx)(n.admonition,{title:"Implementation Required",type:"info",children:(0,i.jsx)(n.p,{children:"Custom metrics are not built into the framework. The following examples show how you can implement custom metrics in your application using the AWS SDK."})}),"\n",(0,i.jsx)(n.h3,{id:"custom-metrics",children:"Custom Metrics"}),"\n",(0,i.jsx)(n.p,{children:"Publish custom metrics from your application:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { CloudWatch } from 'aws-sdk';\n\nconst cloudwatch = new CloudWatch();\n\nasync function publishMetric(\n  metricName: string,\n  value: number,\n  unit: string = 'Count',\n): Promise<void> {\n  await cloudwatch.putMetricData({\n    Namespace: 'YourApp/Custom',\n    MetricData: [\n      {\n        MetricName: metricName,\n        Value: value,\n        Unit: unit,\n        Dimensions: [\n          { Name: 'Environment', Value: process.env.ENVIRONMENT },\n        ],\n      },\n    ],\n  }).promise();\n}\n\n// Usage\nawait publishMetric('TodosCreated', 1);\nawait publishMetric('ProcessingTime', 150, 'Milliseconds');\n"})}),"\n",(0,i.jsx)(n.h3,{id:"key-metrics-to-monitor",children:"Key Metrics to Monitor"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Category"}),(0,i.jsx)(n.th,{children:"Metric"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Lambda"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Invocations"})}),(0,i.jsx)(n.td,{children:"Number of function calls"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Lambda"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Duration"})}),(0,i.jsx)(n.td,{children:"Execution time"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Lambda"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Errors"})}),(0,i.jsx)(n.td,{children:"Failed invocations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Lambda"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ConcurrentExecutions"})}),(0,i.jsx)(n.td,{children:"Parallel executions"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"API Gateway"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Count"})}),(0,i.jsx)(n.td,{children:"Request count"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"API Gateway"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Latency"})}),(0,i.jsx)(n.td,{children:"Response time"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"API Gateway"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"4XXError"})}),(0,i.jsx)(n.td,{children:"Client errors"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"API Gateway"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"5XXError"})}),(0,i.jsx)(n.td,{children:"Server errors"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"DynamoDB"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ConsumedReadCapacity"})}),(0,i.jsx)(n.td,{children:"Read usage"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"DynamoDB"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ConsumedWriteCapacity"})}),(0,i.jsx)(n.td,{children:"Write usage"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"DynamoDB"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ThrottledRequests"})}),(0,i.jsx)(n.td,{children:"Throttled operations"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"cdk-dashboard",children:"CDK Dashboard"}),"\n",(0,i.jsx)(n.admonition,{title:"CDK Customization",type:"info",children:(0,i.jsx)(n.p,{children:"Dashboards are not included in the default CDK template. Add the following to your CDK stack to create a CloudWatch dashboard."})}),"\n",(0,i.jsx)(n.p,{children:"Create a CloudWatch dashboard:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import * as cloudwatch from 'aws-cdk-lib/aws-cloudwatch';\n\nconst dashboard = new cloudwatch.Dashboard(this, 'AppDashboard', {\n  dashboardName: `${props.appName}-${props.envName}`,\n});\n\ndashboard.addWidgets(\n  new cloudwatch.GraphWidget({\n    title: 'Lambda Invocations',\n    left: [handler.metricInvocations()],\n  }),\n  new cloudwatch.GraphWidget({\n    title: 'Lambda Duration',\n    left: [handler.metricDuration()],\n  }),\n  new cloudwatch.GraphWidget({\n    title: 'Lambda Errors',\n    left: [handler.metricErrors()],\n  }),\n  new cloudwatch.GraphWidget({\n    title: 'API Gateway Requests',\n    left: [\n      api.metricCount(),\n      api.metricClientError(),\n      api.metricServerError(),\n    ],\n  }),\n);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"cloudwatch-alarms",children:"CloudWatch Alarms"}),"\n",(0,i.jsx)(n.admonition,{title:"CDK Customization",type:"info",children:(0,i.jsx)(n.p,{children:"Alarms are not included in the default CDK template. Add the following to your CDK stack for production monitoring."})}),"\n",(0,i.jsx)(n.h3,{id:"create-alarms",children:"Create Alarms"}),"\n",(0,i.jsx)(n.p,{children:"Set up alarms for critical metrics:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import * as cloudwatch from 'aws-cdk-lib/aws-cloudwatch';\nimport * as sns from 'aws-cdk-lib/aws-sns';\nimport * as actions from 'aws-cdk-lib/aws-cloudwatch-actions';\n\n// SNS topic for notifications\nconst alertTopic = new sns.Topic(this, 'AlertTopic');\n\n// Lambda error alarm\nconst errorAlarm = new cloudwatch.Alarm(this, 'LambdaErrorAlarm', {\n  metric: handler.metricErrors(),\n  threshold: 5,\n  evaluationPeriods: 1,\n  alarmDescription: 'Lambda function errors exceed threshold',\n  treatMissingData: cloudwatch.TreatMissingData.NOT_BREACHING,\n});\nerrorAlarm.addAlarmAction(new actions.SnsAction(alertTopic));\n\n// High latency alarm\nconst latencyAlarm = new cloudwatch.Alarm(this, 'LatencyAlarm', {\n  metric: handler.metricDuration({\n    statistic: 'p99',\n  }),\n  threshold: 5000, // 5 seconds\n  evaluationPeriods: 3,\n  alarmDescription: 'P99 latency exceeds 5 seconds',\n});\nlatencyAlarm.addAlarmAction(new actions.SnsAction(alertTopic));\n\n// DynamoDB throttling alarm\nconst throttleAlarm = new cloudwatch.Alarm(this, 'ThrottleAlarm', {\n  metric: table.metricThrottledRequests(),\n  threshold: 1,\n  evaluationPeriods: 1,\n  alarmDescription: 'DynamoDB throttling detected',\n});\nthrottleAlarm.addAlarmAction(new actions.SnsAction(alertTopic));\n"})}),"\n",(0,i.jsx)(n.h3,{id:"recommended-alarms",children:"Recommended Alarms"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Alarm"}),(0,i.jsx)(n.th,{children:"Metric"}),(0,i.jsx)(n.th,{children:"Threshold"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"High Error Rate"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Lambda Errors"})}),(0,i.jsx)(n.td,{children:"> 5 per minute"}),(0,i.jsx)(n.td,{children:"Indicates application issues"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"High Latency"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Lambda Duration p99"})}),(0,i.jsx)(n.td,{children:"> 5 seconds"}),(0,i.jsx)(n.td,{children:"Slow response times"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"DynamoDB Throttling"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ThrottledRequests"})}),(0,i.jsx)(n.td,{children:"> 0"}),(0,i.jsx)(n.td,{children:"Capacity issues"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5XX Errors"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"API Gateway 5XXError"})}),(0,i.jsx)(n.td,{children:"> 1%"}),(0,i.jsx)(n.td,{children:"Server errors"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Dead Letter Queue"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"SQS ApproximateNumberOfMessages"})}),(0,i.jsx)(n.td,{children:"> 0"}),(0,i.jsx)(n.td,{children:"Failed messages"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"aws-x-ray-tracing",children:"AWS X-Ray Tracing"}),"\n",(0,i.jsx)(n.admonition,{title:"Built-in Feature",type:"tip",children:(0,i.jsx)(n.p,{children:"X-Ray tracing is enabled by default in the MBC CQRS Serverless CDK template for Lambda functions and Step Functions."})}),"\n",(0,i.jsx)(n.h3,{id:"enable-x-ray",children:"Enable X-Ray"}),"\n",(0,i.jsx)(n.p,{children:"X-Ray tracing is already enabled in the default CDK template:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const handler = new lambda.Function(this, 'Handler', {\n  // ... other config\n  tracing: lambda.Tracing.ACTIVE,\n});\n\nconst api = new apigateway.HttpApi(this, 'Api', {\n  // ... other config\n});\n\n// Enable X-Ray for API Gateway\nconst stage = api.defaultStage?.node.defaultChild as apigateway.CfnStage;\nstage.addPropertyOverride('TracingEnabled', true);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"instrument-application",children:"Instrument Application"}),"\n",(0,i.jsx)(n.admonition,{title:"Optional Enhancement",type:"info",children:(0,i.jsx)(n.p,{children:"For deeper tracing of AWS SDK calls and HTTP requests, you can optionally add the aws-xray-sdk package to your application."})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import * as AWSXRay from 'aws-xray-sdk';\n\n// Instrument AWS SDK\nconst AWS = AWSXRay.captureAWS(require('aws-sdk'));\n\n// Instrument HTTP calls\nAWSXRay.captureHTTPsGlobal(require('http'));\nAWSXRay.captureHTTPsGlobal(require('https'));\n\n// Add custom annotations\nconst segment = AWSXRay.getSegment();\nconst subsegment = segment?.addNewSubsegment('CustomOperation');\nsubsegment?.addAnnotation('userId', userId);\nsubsegment?.addMetadata('request', requestData);\n// ... perform operation\nsubsegment?.close();\n"})}),"\n",(0,i.jsx)(n.h2,{id:"centralized-logging",children:"Centralized Logging"}),"\n",(0,i.jsx)(n.admonition,{title:"CDK Customization",type:"info",children:(0,i.jsx)(n.p,{children:"Centralized logging is not included in the default template. The following patterns show how to aggregate logs for complex applications."})}),"\n",(0,i.jsx)(n.h3,{id:"log-aggregation-pattern",children:"Log Aggregation Pattern"}),"\n",(0,i.jsx)(n.p,{children:"For complex applications, aggregate logs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Create a centralized log group\nconst centralLogGroup = new logs.LogGroup(this, 'CentralLogs', {\n  logGroupName: `/app/${props.appName}/central`,\n  retention: logs.RetentionDays.THREE_MONTHS,\n});\n\n// Subscribe Lambda logs\nnew logs.SubscriptionFilter(this, 'LambdaLogSubscription', {\n  logGroup: lambdaLogGroup,\n  destination: new destinations.LambdaDestination(logProcessorFunction),\n  filterPattern: logs.FilterPattern.allEvents(),\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"log-insights-queries",children:"Log Insights Queries"}),"\n",(0,i.jsx)(n.p,{children:"Useful CloudWatch Logs Insights queries:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Error analysis\nfields @timestamp, @message\n| filter @message like /ERROR/\n| stats count(*) by bin(1h)\n\n# Slow requests\nfields @timestamp, @duration, @requestId\n| filter @duration > 3000\n| sort @duration desc\n| limit 20\n\n# Request volume by endpoint\nfields @timestamp\n| filter @message like /HTTP/\n| parse @message /(?<method>\\w+) (?<path>\\/\\S+)/\n| stats count(*) by path, method\n| sort count desc\n\n# Cold starts\nfields @timestamp, @message\n| filter @message like /Init Duration/\n| parse @message /Init Duration: (?<initDuration>[\\d.]+) ms/\n| stats avg(initDuration), max(initDuration), count(*)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"application-performance-monitoring",children:"Application Performance Monitoring"}),"\n",(0,i.jsx)(n.admonition,{title:"Implementation Required",type:"info",children:(0,i.jsx)(n.p,{children:"The framework does not include built-in APM features. The following examples show patterns you can implement in your application."})}),"\n",(0,i.jsx)(n.h3,{id:"performance-metrics",children:"Performance Metrics"}),"\n",(0,i.jsx)(n.p,{children:"Track key performance indicators:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"class PerformanceMonitor {\n  private metrics: Map<string, number[]> = new Map();\n\n  startTimer(operation: string): () => void {\n    const start = Date.now();\n    return () => {\n      const duration = Date.now() - start;\n      this.recordMetric(operation, duration);\n    };\n  }\n\n  private recordMetric(name: string, value: number): void {\n    if (!this.metrics.has(name)) {\n      this.metrics.set(name, []);\n    }\n    this.metrics.get(name)!.push(value);\n  }\n\n  async flush(): Promise<void> {\n    for (const [name, values] of this.metrics.entries()) {\n      await publishMetric(name, average(values), 'Milliseconds');\n    }\n    this.metrics.clear();\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"health-checks",children:"Health Checks"}),"\n",(0,i.jsxs)(n.p,{children:["The framework provides a basic health check endpoint at ",(0,i.jsx)(n.code,{children:"GET /"})," that returns a simple response. For production applications, you may want to implement more comprehensive health checks:"]}),"\n",(0,i.jsx)(n.admonition,{title:"Built-in Health Check",type:"tip",children:(0,i.jsxs)(n.p,{children:["The default ",(0,i.jsx)(n.code,{children:"GET /"}),' endpoint returns "Hello World!" and can be used for basic liveness checks.']})}),"\n",(0,i.jsx)(n.p,{children:"For more detailed health checks, implement a custom controller:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"@Controller('health')\nexport class HealthController {\n  constructor(\n    private readonly prisma: PrismaService,\n    private readonly dynamodb: DynamoDBService,\n  ) {}\n\n  @Get()\n  async check(): Promise<HealthStatus> {\n    const checks = await Promise.allSettled([\n      this.checkDatabase(),\n      this.checkDynamoDB(),\n    ]);\n\n    return {\n      status: checks.every(c => c.status === 'fulfilled') ? 'healthy' : 'degraded',\n      timestamp: new Date().toISOString(),\n      checks: {\n        database: checks[0].status === 'fulfilled' ? 'ok' : 'failed',\n        dynamodb: checks[1].status === 'fulfilled' ? 'ok' : 'failed',\n      },\n    };\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"logging",children:"Logging"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use structured JSON logging"}),"\n",(0,i.jsx)(n.li,{children:"Include correlation IDs"}),"\n",(0,i.jsx)(n.li,{children:"Log at appropriate levels"}),"\n",(0,i.jsx)(n.li,{children:"Avoid logging sensitive data"}),"\n",(0,i.jsx)(n.li,{children:"Set appropriate retention periods"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"metrics",children:"Metrics"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Focus on actionable metrics"}),"\n",(0,i.jsx)(n.li,{children:"Use percentiles (p50, p95, p99) for latency"}),"\n",(0,i.jsx)(n.li,{children:"Set meaningful thresholds"}),"\n",(0,i.jsx)(n.li,{children:"Create dashboards for different audiences"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"alerting",children:"Alerting"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Avoid alert fatigue"}),"\n",(0,i.jsx)(n.li,{children:"Set appropriate thresholds"}),"\n",(0,i.jsx)(n.li,{children:"Include runbooks in alert descriptions"}),"\n",(0,i.jsx)(n.li,{children:"Use escalation policies"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./deployment-guide",children:"Deployment Guide"})," - Deploy with monitoring enabled"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./codepipeline-cicd",children:"CI/CD with CodePipeline"})," - Automate deployments"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./common-issues",children:"Troubleshooting"})," - Debug issues"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const i={},s=r.createContext(i);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);