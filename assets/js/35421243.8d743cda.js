"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[9875],{2014:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>c,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"form-handling-patterns","title":"Form Handling Patterns","description":"Learn how to handle forms effectively using React Hook Form with Zod validation.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/form-handling-patterns.md","sourceDirName":".","slug":"/form-handling-patterns","permalink":"/docs/form-handling-patterns","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"description":"Learn how to handle forms effectively using React Hook Form with Zod validation."},"sidebar":"tutorialSidebar","previous":{"title":"API Integration Patterns","permalink":"/docs/api-integration-patterns"},"next":{"title":"Master Web","permalink":"/docs/master-web"}}');var o=r(4848),s=r(8453);const i={description:"Learn how to handle forms effectively using React Hook Form with Zod validation."},a="Form Handling Patterns",d={},l=[{value:"When to Use This Guide",id:"when-to-use-this-guide",level:2},{value:"Problems This Pattern Solves",id:"problems-this-pattern-solves",level:2},{value:"Technology Stack",id:"technology-stack",level:2},{value:"Installation",id:"installation",level:2},{value:"Form Component Architecture",id:"form-component-architecture",level:2},{value:"Basic Form Structure",id:"basic-form-structure",level:2},{value:"Use Case: Product Create Form",id:"use-case-product-create-form",level:3},{value:"Zod Schema Definition",id:"zod-schema-definition",level:3},{value:"Form Component",id:"form-component",level:3},{value:"Reusable Form Components",id:"reusable-form-components",level:2},{value:"Use Case: Consistent Form Field Styling",id:"use-case-consistent-form-field-styling",level:3},{value:"Using CustomFormItem",id:"using-customformitem",level:3},{value:"Input Component (Simple, No Error Prop)",id:"input-component-simple-no-error-prop",level:3},{value:"Form Component Implementation",id:"form-component-implementation",level:2},{value:"Advanced Form Patterns",id:"advanced-form-patterns",level:2},{value:"Use Case: Order Form with Multiple Items",id:"use-case-order-form-with-multiple-items",level:3},{value:"Use Case: Payment Form with Conditional Fields",id:"use-case-payment-form-with-conditional-fields",level:3},{value:"Form with React Query",id:"form-with-react-query",level:2},{value:"Use Case: Create Product with API Integration",id:"use-case-create-product-with-api-integration",level:3},{value:"Use Case: Edit Product with Pre-populated Data",id:"use-case-edit-product-with-pre-populated-data",level:3},{value:"Complex Validation Patterns",id:"complex-validation-patterns",level:2},{value:"Use Case: Date Range Validation",id:"use-case-date-range-validation",level:3},{value:"Use Case: Unique Code Validation",id:"use-case-unique-code-validation",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Colocate Schemas with Forms",id:"1-colocate-schemas-with-forms",level:3},{value:"2. Use Mode Appropriately",id:"2-use-mode-appropriately",level:3},{value:"3. Extract Common Schemas",id:"3-extract-common-schemas",level:3},{value:"4. Handle Server Errors",id:"4-handle-server-errors",level:3}];function m(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"form-handling-patterns",children:"Form Handling Patterns"})}),"\n",(0,o.jsx)(n.p,{children:"This guide explains how to build type-safe forms with validation using React Hook Form and Zod. These patterns ensure data integrity before sending to the API and provide clear feedback to users."}),"\n",(0,o.jsx)(n.h2,{id:"when-to-use-this-guide",children:"When to Use This Guide"}),"\n",(0,o.jsx)(n.p,{children:"Use this guide when you need to:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Build forms for creating and editing entities (products, users, orders)"}),"\n",(0,o.jsx)(n.li,{children:"Validate user input before submitting to the API"}),"\n",(0,o.jsx)(n.li,{children:"Display field-level error messages to users"}),"\n",(0,o.jsx)(n.li,{children:"Handle complex forms with dynamic fields (order items, tags)"}),"\n",(0,o.jsx)(n.li,{children:"Show conditional fields based on other form values"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"problems-this-pattern-solves",children:"Problems This Pattern Solves"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Problem"}),(0,o.jsx)(n.th,{children:"Solution"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Invalid data sent to API"}),(0,o.jsx)(n.td,{children:"Zod validates before submission"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Type mismatch between form and API"}),(0,o.jsx)(n.td,{children:"Infer TypeScript types from Zod schema"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Form re-renders on every keystroke"}),(0,o.jsx)(n.td,{children:"React Hook Form uses uncontrolled inputs"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Hard to show validation errors"}),(0,o.jsx)(n.td,{children:"Automatic error state per field"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Dynamic fields are complex to manage"}),(0,o.jsx)(n.td,{children:"useFieldArray handles add/remove"})]})]})]}),"\n",(0,o.jsx)(n.h2,{id:"technology-stack",children:"Technology Stack"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Library"}),(0,o.jsx)(n.th,{children:"Purpose"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"React Hook Form"}),(0,o.jsx)(n.td,{children:"Form state management"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Zod"}),(0,o.jsx)(n.td,{children:"Schema validation"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"@hookform/resolvers"}),(0,o.jsx)(n.td,{children:"Zod integration"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"shadcn/ui Form"}),(0,o.jsx)(n.td,{children:"Form UI components"})]})]})]}),"\n",(0,o.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npm install react-hook-form zod @hookform/resolvers\n"})}),"\n",(0,o.jsx)(n.h2,{id:"form-component-architecture",children:"Form Component Architecture"}),"\n",(0,o.jsx)(n.p,{children:"The form system uses a layered component architecture:"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Component"}),(0,o.jsx)(n.th,{children:"Role"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"Form"})}),(0,o.jsx)(n.td,{children:"Context provider that wraps the entire form (uses FormProvider from react-hook-form)"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"FormField"})}),(0,o.jsx)(n.td,{children:"Connects a field to form state using Controller"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"FormItem"})}),(0,o.jsx)(n.td,{children:"Container for a single form field (label, input, error)"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"FormLabel"})}),(0,o.jsx)(n.td,{children:"Label that auto-connects to the field and shows error state"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"FormControl"})}),(0,o.jsx)(n.td,{children:"Passes form field props to the input element"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"FormMessage"})}),(0,o.jsx)(n.td,{children:"Displays validation error message"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"FormDescription"})}),(0,o.jsx)(n.td,{children:"Optional help text for the field"})]})]})]}),"\n",(0,o.jsx)(n.h2,{id:"basic-form-structure",children:"Basic Form Structure"}),"\n",(0,o.jsx)(n.h3,{id:"use-case-product-create-form",children:"Use Case: Product Create Form"}),"\n",(0,o.jsx)(n.p,{children:"Scenario: User needs to create a new product with code, name, price, and status."}),"\n",(0,o.jsx)(n.p,{children:"Solution: Define schema with validation rules, use Form components for consistent error display."}),"\n",(0,o.jsx)(n.h3,{id:"zod-schema-definition",children:"Zod Schema Definition"}),"\n",(0,o.jsx)(n.p,{children:"Define validation rules that match your API requirements:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// src/schemas/product.schema.ts\nimport { z } from 'zod';\n\nexport const createProductSchema = z.object({\n  code: z\n    .string()\n    .min(1, 'Code is required')\n    .max(50, 'Code must be 50 characters or less')\n    .regex(/^[A-Z0-9-]+$/, 'Code must be uppercase alphanumeric with hyphens'),\n  name: z\n    .string()\n    .min(1, 'Name is required')\n    .max(200, 'Name must be 200 characters or less'),\n  price: z\n    .number()\n    .min(0, 'Price must be positive')\n    .max(999999999, 'Price exceeds maximum'),\n  description: z\n    .string()\n    .max(2000, 'Description must be 2000 characters or less')\n    .optional(),\n  categoryId: z.string().min(1, 'Category is required'),\n  status: z.enum(['ACTIVE', 'INACTIVE', 'DRAFT']),\n});\n\nexport type CreateProductInput = z.infer<typeof createProductSchema>;\n\n// Update schema with optional fields and version\nexport const updateProductSchema = createProductSchema.partial().extend({\n  version: z.number().int().positive(),\n});\n\nexport type UpdateProductInput = z.infer<typeof updateProductSchema>;\n"})}),"\n",(0,o.jsx)(n.h3,{id:"form-component",children:"Form Component"}),"\n",(0,o.jsx)(n.p,{children:"Connect the schema to React Hook Form using Form components:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'// src/components/forms/ProductForm.tsx\n\'use client\';\n\nimport { useForm } from \'react-hook-form\';\nimport { zodResolver } from \'@hookform/resolvers/zod\';\nimport {\n  createProductSchema,\n  CreateProductInput,\n} from \'@/schemas/product.schema\';\nimport { Button } from \'@/components/ui/button\';\nimport { Input } from \'@/components/ui/input\';\nimport { Textarea } from \'@/components/ui/textarea\';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \'@/components/ui/form\';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \'@/components/ui/select\';\n\ninterface ProductFormProps {\n  onSubmit: (data: CreateProductInput) => Promise<void>;\n  defaultValues?: Partial<CreateProductInput>;\n  isLoading?: boolean;\n}\n\nexport function ProductForm({\n  onSubmit,\n  defaultValues,\n  isLoading,\n}: ProductFormProps) {\n  const form = useForm<CreateProductInput>({\n    resolver: zodResolver(createProductSchema),\n    defaultValues: {\n      status: \'DRAFT\',\n      ...defaultValues,\n    },\n  });\n\n  return (\n    <Form {...form}>\n      <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-4">\n        <FormField\n          control={form.control}\n          name="code"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Code</FormLabel>\n              <FormControl>\n                <Input {...field} disabled={isLoading} />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <FormField\n          control={form.control}\n          name="name"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Name</FormLabel>\n              <FormControl>\n                <Input {...field} disabled={isLoading} />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <FormField\n          control={form.control}\n          name="price"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Price</FormLabel>\n              <FormControl>\n                <Input\n                  type="number"\n                  {...field}\n                  onChange={(e) => field.onChange(Number(e.target.value))}\n                  disabled={isLoading}\n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <FormField\n          control={form.control}\n          name="description"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Description</FormLabel>\n              <FormControl>\n                <Textarea {...field} disabled={isLoading} />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <FormField\n          control={form.control}\n          name="status"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Status</FormLabel>\n              <Select\n                onValueChange={field.onChange}\n                defaultValue={field.value}\n                disabled={isLoading}\n              >\n                <FormControl>\n                  <SelectTrigger>\n                    <SelectValue placeholder="Select status" />\n                  </SelectTrigger>\n                </FormControl>\n                <SelectContent>\n                  <SelectItem value="DRAFT">Draft</SelectItem>\n                  <SelectItem value="ACTIVE">Active</SelectItem>\n                  <SelectItem value="INACTIVE">Inactive</SelectItem>\n                </SelectContent>\n              </Select>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <Button\n          type="submit"\n          loading={form.formState.isSubmitting || isLoading}\n          disabled={form.formState.isSubmitting || isLoading}\n        >\n          Save\n        </Button>\n      </form>\n    </Form>\n  );\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"reusable-form-components",children:"Reusable Form Components"}),"\n",(0,o.jsx)(n.h3,{id:"use-case-consistent-form-field-styling",children:"Use Case: Consistent Form Field Styling"}),"\n",(0,o.jsx)(n.p,{children:"Scenario: All form fields should have consistent label, error display, and required indicator."}),"\n",(0,o.jsx)(n.p,{children:"Solution: Create a custom wrapper component that uses shadcn/ui Form components."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// src/components/form/CustomFormItem.tsx\n'use client';\n\nimport * as React from 'react';\nimport { FormItem, FormLabel, FormMessage } from '@/components/ui/form';\nimport { cn } from '@/lib/utils';\n\nexport default function CustomFormItem({\n  className,\n  label,\n  required,\n  children,\n}: {\n  className?: string;\n  label: string;\n  children: React.ReactNode;\n  required?: boolean;\n}) {\n  return (\n    <FormItem className={cn('flex w-full flex-col gap-2', className)}>\n      <FormLabel className=\"font-semibold\">\n        <span className=\"text-[hsl(var(--foreground))]\">{label}</span>\n        {required && <span className=\"text-destructive ml-1\">*</span>}\n      </FormLabel>\n      <div className=\"relative flex-col\">\n        {children}\n        <FormMessage className=\"mt-2 text-xs font-semibold\" />\n      </div>\n    </FormItem>\n  );\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"using-customformitem",children:"Using CustomFormItem"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'<FormField\n  control={form.control}\n  name="code"\n  render={({ field }) => (\n    <CustomFormItem label="Code" required>\n      <FormControl>\n        <Input {...field} />\n      </FormControl>\n    </CustomFormItem>\n  )}\n/>\n'})}),"\n",(0,o.jsx)(n.h3,{id:"input-component-simple-no-error-prop",children:"Input Component (Simple, No Error Prop)"}),"\n",(0,o.jsx)(n.p,{children:"Note: The Input component does NOT have an error prop. Error display is handled by FormMessage."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// src/components/ui/input.tsx\nimport * as React from 'react';\nimport { cn } from '@/lib/utils';\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          'flex h-10 w-full rounded-md border border-[hsl(var(--input))] bg-[hsl(var(--background))] px-3 py-2 text-sm ring-offset-[hsl(var(--background))] file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-[hsl(var(--muted-foreground))] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[hsl(var(--ring))] focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\n\nInput.displayName = 'Input';\n\nexport { Input };\n"})}),"\n",(0,o.jsx)(n.h2,{id:"form-component-implementation",children:"Form Component Implementation"}),"\n",(0,o.jsx)(n.p,{children:"The Form components from shadcn/ui provide context-based error handling:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// src/components/ui/form.tsx\nimport * as React from 'react';\nimport * as LabelPrimitive from '@radix-ui/react-label';\nimport { Slot } from '@radix-ui/react-slot';\nimport {\n  Controller,\n  ControllerProps,\n  FieldPath,\n  FieldValues,\n  FormProvider,\n  useFormContext,\n} from 'react-hook-form';\nimport { cn } from '@/lib/utils';\nimport { Label } from './label';\n\n// Form is just FormProvider re-exported\nconst Form = FormProvider;\n\n// Context type for FormField\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\n> = {\n  name: TName;\n};\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n);\n\n// FormField wraps Controller and provides field context\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  );\n};\n\n// useFormField hook retrieves field state from context\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext);\n  const itemContext = React.useContext(FormItemContext);\n  const { getFieldState, formState } = useFormContext();\n\n  const fieldState = getFieldState(fieldContext.name, formState);\n\n  if (!fieldContext) {\n    throw new Error('useFormField should be used within <FormField>');\n  }\n\n  const { id } = itemContext;\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  };\n};\n\n// Context type for FormItem\ntype FormItemContextValue = {\n  id: string;\n};\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n);\n\n// FormItem provides unique ID via context\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId();\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn('space-y-2', className)} {...props} />\n    </FormItemContext.Provider>\n  );\n});\nFormItem.displayName = 'FormItem';\n\n// FormLabel shows error state via color\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField();\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && 'text-[hsl(var(--destructive))]', className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  );\n});\nFormLabel.displayName = 'FormLabel';\n\n// FormControl passes aria attributes for accessibility\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField();\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  );\n});\nFormControl.displayName = 'FormControl';\n\n// FormDescription provides help text\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField();\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn('text-sm text-[hsl(var(--muted-foreground))]', className)}\n      {...props}\n    />\n  );\n});\nFormDescription.displayName = 'FormDescription';\n\n// FormMessage automatically displays error from context\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField();\n  const body = error ? String(error?.message) : children;\n\n  if (!body) {\n    return null;\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\n        'text-sm font-medium text-[hsl(var(--destructive))]',\n        className\n      )}\n      {...props}\n    >\n      {body}\n    </p>\n  );\n});\nFormMessage.displayName = 'FormMessage';\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n};\n"})}),"\n",(0,o.jsx)(n.h2,{id:"advanced-form-patterns",children:"Advanced Form Patterns"}),"\n",(0,o.jsx)(n.h3,{id:"use-case-order-form-with-multiple-items",children:"Use Case: Order Form with Multiple Items"}),"\n",(0,o.jsx)(n.p,{children:"Scenario: User creates an order with multiple line items. Items can be added or removed."}),"\n",(0,o.jsx)(n.p,{children:"Problem: Managing array of fields with validation is complex."}),"\n",(0,o.jsx)(n.p,{children:"Solution: useFieldArray provides add, remove, and update methods with proper validation."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// src/components/forms/OrderForm.tsx\nimport { useForm, useFieldArray } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\n\nconst orderItemSchema = z.object({\n  productId: z.string().min(1, 'Product is required'),\n  quantity: z.number().min(1, 'Quantity must be at least 1'),\n  price: z.number().min(0),\n});\n\nconst orderSchema = z.object({\n  customerId: z.string().min(1, 'Customer is required'),\n  items: z.array(orderItemSchema).min(1, 'At least one item is required'),\n  notes: z.string().optional(),\n});\n\ntype OrderInput = z.infer<typeof orderSchema>;\n\nexport function OrderForm({\n  onSubmit,\n}: {\n  onSubmit: (data: OrderInput) => void;\n}) {\n  const form = useForm<OrderInput>({\n    resolver: zodResolver(orderSchema),\n    defaultValues: {\n      items: [{ productId: '', quantity: 1, price: 0 }],\n    },\n  });\n\n  const { fields, append, remove } = useFieldArray({\n    control: form.control,\n    name: 'items',\n  });\n\n  return (\n    <Form {...form}>\n      <form onSubmit={form.handleSubmit(onSubmit)}>\n        <FormField\n          control={form.control}\n          name=\"customerId\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Customer</FormLabel>\n              <FormControl>\n                <Input {...field} />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <div className=\"space-y-4\">\n          <h3>Order Items</h3>\n          {fields.map((field, index) => (\n            <div key={field.id} className=\"flex gap-4 items-end\">\n              <FormField\n                control={form.control}\n                name={`items.${index}.productId`}\n                render={({ field }) => (\n                  <FormItem>\n                    <FormControl>\n                      <Input {...field} placeholder=\"Product ID\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name={`items.${index}.quantity`}\n                render={({ field }) => (\n                  <FormItem>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        {...field}\n                        onChange={(e) => field.onChange(Number(e.target.value))}\n                        placeholder=\"Qty\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button type=\"button\" variant=\"destructive\" onClick={() => remove(index)}>\n                Remove\n              </Button>\n            </div>\n          ))}\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={() => append({ productId: '', quantity: 1, price: 0 })}\n          >\n            Add Item\n          </Button>\n        </div>\n\n        <Button type=\"submit\">Create Order</Button>\n      </form>\n    </Form>\n  );\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"use-case-payment-form-with-conditional-fields",children:"Use Case: Payment Form with Conditional Fields"}),"\n",(0,o.jsx)(n.p,{children:"Scenario: Form shows different fields based on payment method selection."}),"\n",(0,o.jsx)(n.p,{children:"Problem: Need to watch a field value and conditionally render other fields."}),"\n",(0,o.jsx)(n.p,{children:"Solution: useWatch subscribes to field changes without causing full form re-render."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"import { useForm, useWatch } from 'react-hook-form';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\n\nfunction PaymentForm() {\n  const form = useForm({\n    defaultValues: {\n      paymentMethod: 'credit_card',\n      cardNumber: '',\n      bankAccount: '',\n    },\n  });\n\n  const paymentMethod = useWatch({\n    control: form.control,\n    name: 'paymentMethod',\n  });\n\n  return (\n    <Form {...form}>\n      <form>\n        <FormField\n          control={form.control}\n          name=\"paymentMethod\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Payment Method</FormLabel>\n              <Select onValueChange={field.onChange} defaultValue={field.value}>\n                <FormControl>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                </FormControl>\n                <SelectContent>\n                  <SelectItem value=\"credit_card\">Credit Card</SelectItem>\n                  <SelectItem value=\"bank_transfer\">Bank Transfer</SelectItem>\n                </SelectContent>\n              </Select>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        {paymentMethod === 'credit_card' && (\n          <FormField\n            control={form.control}\n            name=\"cardNumber\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>Card Number</FormLabel>\n                <FormControl>\n                  <Input {...field} placeholder=\"Card Number\" />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n        )}\n\n        {paymentMethod === 'bank_transfer' && (\n          <FormField\n            control={form.control}\n            name=\"bankAccount\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>Bank Account</FormLabel>\n                <FormControl>\n                  <Input {...field} placeholder=\"Bank Account\" />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n        )}\n      </form>\n    </Form>\n  );\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"form-with-react-query",children:"Form with React Query"}),"\n",(0,o.jsx)(n.h3,{id:"use-case-create-product-with-api-integration",children:"Use Case: Create Product with API Integration"}),"\n",(0,o.jsx)(n.p,{children:"Scenario: Submit form data to API and handle success/error states."}),"\n",(0,o.jsx)(n.p,{children:"Solution: Container component combines form with React Query mutation."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// src/containers/products/CreateProductForm.tsx\n'use client';\n\nimport { useRouter } from 'next/navigation';\nimport { useCreateProduct } from '@/hooks/useProducts';\nimport { ProductForm } from '@/components/forms/ProductForm';\nimport { CreateProductInput } from '@/schemas/product.schema';\nimport { toast } from '@/components/ui/toast';\n\nexport function CreateProductForm() {\n  const router = useRouter();\n  const createProduct = useCreateProduct();\n\n  const handleSubmit = async (data: CreateProductInput) => {\n    try {\n      await createProduct.mutateAsync(data);\n      toast.success('Product created successfully');\n      router.push('/products');\n    } catch (error) {\n      toast.error(\n        error instanceof Error ? error.message : 'Failed to create product'\n      );\n    }\n  };\n\n  return (\n    <ProductForm onSubmit={handleSubmit} isLoading={createProduct.isPending} />\n  );\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"use-case-edit-product-with-pre-populated-data",children:"Use Case: Edit Product with Pre-populated Data"}),"\n",(0,o.jsx)(n.p,{children:"Scenario: Load existing product data into form for editing."}),"\n",(0,o.jsx)(n.p,{children:"Problem: Need to fetch data before rendering form with default values."}),"\n",(0,o.jsx)(n.p,{children:"Solution: Container fetches data, passes to form as defaultValues."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// src/containers/products/EditProductForm.tsx\n'use client';\n\nimport { useRouter } from 'next/navigation';\nimport { useProduct, useUpdateProduct } from '@/hooks/useProducts';\nimport { ProductForm } from '@/components/forms/ProductForm';\nimport { UpdateProductInput } from '@/schemas/product.schema';\nimport { toast } from '@/components/ui/toast';\n\ninterface EditProductFormProps {\n  pk: string;\n  sk: string;\n}\n\nexport function EditProductForm({ pk, sk }: EditProductFormProps) {\n  const router = useRouter();\n  const { data: product, isLoading } = useProduct(pk, sk);\n  const updateProduct = useUpdateProduct();\n\n  const handleSubmit = async (data: UpdateProductInput) => {\n    try {\n      await updateProduct.mutateAsync({\n        pk,\n        sk,\n        dto: { ...data, version: product!.version },\n      });\n      toast.success('Product updated successfully');\n      router.push('/products');\n    } catch (error) {\n      toast.error(\n        error instanceof Error ? error.message : 'Failed to update product'\n      );\n    }\n  };\n\n  if (isLoading) return <Skeleton />;\n  if (!product) return <NotFound />;\n\n  return (\n    <ProductForm\n      defaultValues={product}\n      onSubmit={handleSubmit}\n      isLoading={updateProduct.isPending}\n    />\n  );\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"complex-validation-patterns",children:"Complex Validation Patterns"}),"\n",(0,o.jsx)(n.h3,{id:"use-case-date-range-validation",children:"Use Case: Date Range Validation"}),"\n",(0,o.jsx)(n.p,{children:"Scenario: End date must be after start date."}),"\n",(0,o.jsx)(n.p,{children:"Solution: Use Zod refine to validate across multiple fields."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"const dateRangeSchema = z\n  .object({\n    startDate: z.date(),\n    endDate: z.date(),\n  })\n  .refine((data) => data.endDate >= data.startDate, {\n    message: 'End date must be after start date',\n    path: ['endDate'],\n  });\n"})}),"\n",(0,o.jsx)(n.h3,{id:"use-case-unique-code-validation",children:"Use Case: Unique Code Validation"}),"\n",(0,o.jsx)(n.p,{children:"Scenario: Product code must not already exist in database."}),"\n",(0,o.jsx)(n.p,{children:"Problem: Need to call API to check uniqueness."}),"\n",(0,o.jsx)(n.p,{children:"Solution: Use async refine to validate against API."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"const uniqueCodeSchema = z.object({\n  code: z\n    .string()\n    .min(1, 'Code is required')\n    .refine(\n      async (code) => {\n        const exists = await checkCodeExists(code);\n        return !exists;\n      },\n      { message: 'This code is already in use' }\n    ),\n});\n\n// In the form\nconst form = useForm({\n  resolver: zodResolver(uniqueCodeSchema),\n  mode: 'onBlur', // Validate on blur for async validation\n});\n"})}),"\n",(0,o.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsx)(n.h3,{id:"1-colocate-schemas-with-forms",children:"1. Colocate Schemas with Forms"}),"\n",(0,o.jsx)(n.p,{children:"Why: Keeps validation logic close to the form that uses it."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"src/\n\u251c\u2500\u2500 components/forms/\n\u2502   \u2514\u2500\u2500 ProductForm/\n\u2502       \u251c\u2500\u2500 ProductForm.tsx\n\u2502       \u251c\u2500\u2500 ProductForm.schema.ts\n\u2502       \u2514\u2500\u2500 index.ts\n"})}),"\n",(0,o.jsx)(n.h3,{id:"2-use-mode-appropriately",children:"2. Use Mode Appropriately"}),"\n",(0,o.jsx)(n.p,{children:"Choose validation timing based on form complexity:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// Validate on submit (default) - best for simple forms\nuseForm({ mode: 'onSubmit' });\n\n// Validate on blur - best for forms with async validation\nuseForm({ mode: 'onBlur' });\n\n// Validate on change - best for real-time feedback\nuseForm({ mode: 'onChange' });\n"})}),"\n",(0,o.jsx)(n.h3,{id:"3-extract-common-schemas",children:"3. Extract Common Schemas"}),"\n",(0,o.jsx)(n.p,{children:"Why: Reuse validation rules across multiple forms."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// src/schemas/common.ts\nexport const requiredString = z.string().min(1, 'This field is required');\nexport const email = z.string().email('Invalid email address');\nexport const positiveNumber = z.number().positive('Must be positive');\n"})}),"\n",(0,o.jsx)(n.h3,{id:"4-handle-server-errors",children:"4. Handle Server Errors"}),"\n",(0,o.jsx)(n.p,{children:"Scenario: Server returns field-level validation errors."}),"\n",(0,o.jsx)(n.p,{children:"Solution: Use setError to display server errors on specific fields."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"function FormWithServerErrors() {\n  const form = useForm();\n\n  const onSubmit = async (data) => {\n    try {\n      await api.create(data);\n    } catch (error) {\n      if (error.details) {\n        // Set field-level errors from server\n        Object.entries(error.details).forEach(([field, messages]) => {\n          form.setError(field, { message: messages[0] });\n        });\n      }\n    }\n  };\n\n  return (\n    <Form {...form}>\n      <form onSubmit={form.handleSubmit(onSubmit)}>...</form>\n    </Form>\n  );\n}\n"})})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(m,{...e})}):m(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var t=r(6540);const o={},s=t.createContext(o);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);