"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[5291],{8014:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"common-issues","title":"Common Issues","description":"Solutions to common issues encountered when using MBC CQRS Serverless.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/common-issues.md","sourceDirName":".","slug":"/common-issues","permalink":"/docs/common-issues","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"description":"Solutions to common issues encountered when using MBC CQRS Serverless."},"sidebar":"tutorialSidebar","previous":{"title":"End-to-end test","permalink":"/docs/e2e-test"},"next":{"title":"Debugging Guide","permalink":"/docs/debugging-guide"}}');var r=s(4848),l=s(8453);const t={description:"Solutions to common issues encountered when using MBC CQRS Serverless."},o="Common Issues",d={},a=[{value:"Installation &amp; Setup",id:"installation--setup",level:2},{value:"npm install fails with peer dependency errors",id:"npm-install-fails-with-peer-dependency-errors",level:3},{value:"npm install fails with node-waf error",id:"npm-install-fails-with-node-waf-error",level:3},{value:"CLI command not found",id:"cli-command-not-found",level:3},{value:"Docker services fail to start",id:"docker-services-fail-to-start",level:3},{value:"Database Issues",id:"database-issues",level:2},{value:"DynamoDB connection refused",id:"dynamodb-connection-refused",level:3},{value:"Prisma migration errors",id:"prisma-migration-errors",level:3},{value:"Master API returns 500 Internal Server Error",id:"master-api-returns-500-internal-server-error",level:3},{value:"Serverless Offline fails with missing import_tmp stream",id:"missing-import-tmp-table",level:3},{value:"DynamoDB throughput exceeded",id:"dynamodb-throughput-exceeded",level:3},{value:"Lambda Errors",id:"lambda-errors",level:2},{value:"Lambda timeout",id:"lambda-timeout",level:3},{value:"Lambda out of memory",id:"lambda-out-of-memory",level:3},{value:"Module not found in Lambda",id:"module-not-found-in-lambda",level:3},{value:"Authentication Errors",id:"authentication-errors",level:2},{value:"Cognito token invalid",id:"cognito-token-invalid",level:3},{value:"CORS errors",id:"cors-errors",level:3},{value:"Event Processing",id:"event-processing",level:2},{value:"Events not being processed",id:"events-not-being-processed",level:3},{value:"Duplicate event processing",id:"duplicate-event-processing",level:3},{value:"Step Functions",id:"step-functions",level:2},{value:"Step Function execution failed",id:"step-function-execution-failed",level:3},{value:"Step Function timeout",id:"step-function-timeout",level:3},{value:"Deployment Issues",id:"deployment-issues",level:2},{value:"CDK deployment fails",id:"cdk-deployment-fails",level:3},{value:"Resource already exists",id:"resource-already-exists",level:3},{value:"Performance Issues",id:"performance-issues",level:2},{value:"Slow API response times",id:"slow-api-response-times",level:3},{value:"High Lambda costs",id:"high-lambda-costs",level:3},{value:"Getting Help",id:"getting-help",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"common-issues",children:"Common Issues"})}),"\n",(0,r.jsx)(n.p,{children:"This page lists common issues and their solutions when working with MBC CQRS Serverless applications."}),"\n",(0,r.jsx)(n.h2,{id:"installation--setup",children:"Installation & Setup"}),"\n",(0,r.jsx)(n.h3,{id:"npm-install-fails-with-peer-dependency-errors",children:"npm install fails with peer dependency errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": npm install fails with peer dependency warnings or errors."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Use --legacy-peer-deps flag\nnpm install --legacy-peer-deps\n\n# Or update npm to latest version\nnpm install -g npm@latest\n"})}),"\n",(0,r.jsx)(n.h3,{id:"npm-install-fails-with-node-waf-error",children:"npm install fails with node-waf error"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": npm install fails with ",(0,r.jsx)(n.code,{children:"node-waf: command not found"})," error, typically from the zlib package."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"npm error path node_modules/zlib\nnpm error command sh -c node-waf clean || true; node-waf configure build\nnpm error sh: node-waf: command not found\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause"}),": Some legacy serverless-offline plugins depend on packages that use the deprecated node-waf build tool."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Skip build scripts during installation\nnpm install --legacy-peer-deps --ignore-scripts\n\n# Then run postinstall scripts manually\nnpx prisma generate\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cli-command-not-found",children:"CLI command not found"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": ",(0,r.jsx)(n.code,{children:"mbc-cqrs"})," command is not recognized."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Install globally\nnpm install -g @mbc-cqrs-serverless/cli\n\n# Or use npx\nnpx @mbc-cqrs-serverless/cli new my-app\n"})}),"\n",(0,r.jsx)(n.h3,{id:"docker-services-fail-to-start",children:"Docker services fail to start"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": docker-compose up fails or services don't start."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check Docker is running\ndocker info\n\n# Clean up and restart\ndocker-compose -f infra-local/docker-compose.yml down -v\ndocker-compose -f infra-local/docker-compose.yml up -d\n\n# Check logs for specific service\ndocker-compose -f infra-local/docker-compose.yml logs dynamodb-local\n"})}),"\n",(0,r.jsx)(n.h2,{id:"database-issues",children:"Database Issues"}),"\n",(0,r.jsx)(n.h3,{id:"dynamodb-connection-refused",children:"DynamoDB connection refused"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Cannot connect to DynamoDB Local."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Verify DynamoDB Local is running:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker ps | grep dynamodb\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Check the endpoint URL in your configuration:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Should be http://localhost:8000 for local development\ndynamodbEndpoint: 'http://localhost:8000'\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Verify tables exist:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws dynamodb list-tables --endpoint-url http://localhost:8000\n"})}),"\n",(0,r.jsx)(n.h3,{id:"prisma-migration-errors",children:"Prisma migration errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Prisma migrate fails with connection errors."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Verify PostgreSQL is running:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker ps | grep postgres\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Check DATABASE_URL in .env:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'DATABASE_URL="postgresql://postgres:postgres@localhost:5432/myapp?schema=public"\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Reset and re-run migrations:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npx prisma migrate reset\nnpx prisma migrate dev\n"})}),"\n",(0,r.jsx)(n.h3,{id:"master-api-returns-500-internal-server-error",children:"Master API returns 500 Internal Server Error"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Master API endpoints (",(0,r.jsx)(n.code,{children:"/api/master-setting/list"}),", ",(0,r.jsx)(n.code,{children:"/api/master-data/list"}),") return 500 Internal Server Error."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause"}),": The Master module requires both DynamoDB tables and an RDS table. If the ",(0,r.jsx)(n.code,{children:"masters"})," table doesn't exist in RDS, the API will fail with a 500 error."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Verify the ",(0,r.jsx)(n.code,{children:"masters"})," table exists in RDS:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# For MySQL\ndocker exec mysql mysql -u root -proot mydb -e "SHOW TABLES LIKE \'masters\';"\n\n# For PostgreSQL\ndocker exec postgres psql -U postgres -d mydb -c "\\dt masters"\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"If the table is missing, add it to your Prisma schema:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-prisma",children:'model Master {\n  pk         String   @db.VarChar(256)\n  sk         String   @db.VarChar(512)\n  id         String   @id @db.VarChar(256)\n  name       String   @db.VarChar(256)\n  code       String   @db.VarChar(256)\n  version    Int      @default(0)\n  tenantCode String   @map("tenant_code") @db.VarChar(64)\n  type       String   @db.VarChar(256)\n  attributes Json?\n  isDeleted  Boolean  @default(false) @map("is_deleted")\n  createdAt  DateTime @default(now()) @map("created_at")\n  createdBy  String   @default("system") @map("created_by") @db.VarChar(256)\n  updatedAt  DateTime @default(now()) @updatedAt @map("updated_at")\n  updatedBy  String   @default("system") @map("updated_by") @db.VarChar(256)\n\n  @@unique([pk, sk])\n  @@index([tenantCode])\n  @@map("masters")\n}\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Run Prisma migration:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npx prisma migrate dev --name add_master_table\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Verify the DynamoDB tables also exist:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws dynamodb list-tables --endpoint-url http://localhost:8000 | grep master\n# Should show: master-command, master-data, master-history\n"})}),"\n",(0,r.jsx)(n.h3,{id:"missing-import-tmp-table",children:"Serverless Offline fails with missing import_tmp stream"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": ",(0,r.jsx)(n.code,{children:"npm run offline:sls"})," fails because the ",(0,r.jsx)(n.code,{children:"LOCAL_DDB_IMPORT_TMP_STREAM"})," environment variable is not set."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause"}),": The ",(0,r.jsx)(n.code,{children:"import_tmp.json"})," table definition file is missing from ",(0,r.jsx)(n.code,{children:"prisma/dynamodbs/"}),". Without it, ",(0,r.jsx)(n.code,{children:"npm run migrate"})," cannot create the ",(0,r.jsx)(n.code,{children:"import_tmp"})," DynamoDB table, so the stream ARN is never written to ",(0,r.jsx)(n.code,{children:".env"}),"."]}),"\n",(0,r.jsx)(n.admonition,{title:"Known Issue (Fixed in v1.1.1)",type:"warning",children:(0,r.jsxs)(n.p,{children:["In versions prior to v1.1.1, the ",(0,r.jsx)(n.code,{children:"import_tmp.json"})," template was not included in CLI scaffolded projects. This was fixed in ",(0,r.jsx)(n.a,{href:"/docs/changelog#v111",children:"version 1.1.1"}),"."]})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.p,{children:["Create ",(0,r.jsx)(n.code,{children:"prisma/dynamodbs/import_tmp.json"})," with the following content:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "TableName": "import_tmp",\n  "AttributeDefinitions": [\n    { "AttributeName": "pk", "AttributeType": "S" },\n    { "AttributeName": "sk", "AttributeType": "S" }\n  ],\n  "KeySchema": [\n    { "AttributeName": "pk", "KeyType": "HASH" },\n    { "AttributeName": "sk", "KeyType": "RANGE" }\n  ],\n  "BillingMode": "PAY_PER_REQUEST",\n  "StreamSpecification": {\n    "StreamEnabled": true,\n    "StreamViewType": "NEW_IMAGE"\n  },\n  "TableClass": "STANDARD",\n  "DeletionProtectionEnabled": true\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Then re-run the migration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm run migrate\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The migration script will automatically create the table and add the ",(0,r.jsx)(n.code,{children:"LOCAL_DDB_IMPORT_TMP_STREAM"})," entry to your ",(0,r.jsx)(n.code,{children:".env"})," file."]}),"\n",(0,r.jsx)(n.h3,{id:"dynamodb-throughput-exceeded",children:"DynamoDB throughput exceeded"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": ProvisionedThroughputExceededException error."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"For development: Use on-demand billing mode"}),"\n",(0,r.jsx)(n.li,{children:"For production: Increase provisioned capacity or enable auto-scaling"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// CDK configuration for on-demand\nconst table = new dynamodb.Table(this, 'Table', {\n  billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"lambda-errors",children:"Lambda Errors"}),"\n",(0,r.jsx)(n.h3,{id:"lambda-timeout",children:"Lambda timeout"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Task timed out after X seconds."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Increase timeout in CDK:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const handler = new lambda.Function(this, 'Handler', {\n  timeout: cdk.Duration.seconds(30),\n});\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Optimize cold start:"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reduce bundle size"}),"\n",(0,r.jsx)(n.li,{children:"Use provisioned concurrency for critical functions"}),"\n",(0,r.jsx)(n.li,{children:"Move initialization outside handler"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"lambda-out-of-memory",children:"Lambda out of memory"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Runtime.ExitError or memory limit exceeded."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const handler = new lambda.Function(this, 'Handler', {\n  memorySize: 1024, // Increase memory\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"module-not-found-in-lambda",children:"Module not found in Lambda"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Cannot find module 'xxx' error."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Check bundling configuration:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Ensure dependencies are bundled\nconst handler = new lambda_nodejs.NodejsFunction(this, 'Handler', {\n  bundling: {\n    externalModules: [], // Don't exclude anything\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Verify package.json dependencies are correct"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"authentication-errors",children:"Authentication Errors"}),"\n",(0,r.jsx)(n.h3,{id:"cognito-token-invalid",children:"Cognito token invalid"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": 401 Unauthorized or token validation fails."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Verify Cognito configuration:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Check USER_POOL_ID and CLIENT_ID match\nCOGNITO_USER_POOL_ID=ap-northeast-1_xxxxxx\nCOGNITO_CLIENT_ID=xxxxxxxxxxxxxxxxxxxxxxxxxx\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Check token expiration:"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Access tokens expire after 1 hour by default"}),"\n",(0,r.jsx)(n.li,{children:"Implement token refresh logic"}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Verify issuer URL:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const issuer = `https://cognito-idp.${region}.amazonaws.com/${userPoolId}`;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cors-errors",children:"CORS errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Access-Control-Allow-Origin error in browser."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Configure CORS in API Gateway:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const api = new apigateway.HttpApi(this, 'Api', {\n  corsPreflight: {\n    allowOrigins: ['http://localhost:3000', 'https://your-domain.com'],\n    allowMethods: [apigateway.CorsHttpMethod.ANY],\n    allowHeaders: ['Authorization', 'Content-Type'],\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Ensure OPTIONS requests are handled"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"event-processing",children:"Event Processing"}),"\n",(0,r.jsx)(n.h3,{id:"events-not-being-processed",children:"Events not being processed"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": DynamoDB streams or SQS messages not triggering handlers."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Check event source mapping:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws lambda list-event-source-mappings --function-name your-function\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Verify handler is registered:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"@EventHandler(YourEvent)\nexport class YourEventHandler implements IEventHandler<YourEvent> {\n  async execute(event: YourEvent): Promise<void> {\n    // Handler implementation\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Check CloudWatch Logs for errors"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"duplicate-event-processing",children:"Duplicate event processing"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Same event processed multiple times."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Implement idempotency:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Use a unique identifier to check if already processed\n// For commands, use pk + sk + version as the idempotency key\nconst idempotencyKey = `${command.pk}#${command.sk}@${command.version}`;\nif (await this.isProcessed(idempotencyKey)) {\n  return; // Skip duplicate\n}\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Configure SQS visibility timeout appropriately"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"step-functions",children:"Step Functions"}),"\n",(0,r.jsx)(n.h3,{id:"step-function-execution-failed",children:"Step Function execution failed"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": State machine execution fails with error."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check execution history in AWS Console:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Go to Step Functions \u2192 State machines \u2192 Your machine"}),"\n",(0,r.jsx)(n.li,{children:"Click on failed execution"}),"\n",(0,r.jsx)(n.li,{children:"Review error details in each step"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Add error handling:"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Add retry and catch in state machine definition\n{\n  "Retry": [\n    {\n      "ErrorEquals": ["States.TaskFailed"],\n      "IntervalSeconds": 2,\n      "MaxAttempts": 3,\n      "BackoffRate": 2\n    }\n  ],\n  "Catch": [\n    {\n      "ErrorEquals": ["States.ALL"],\n      "Next": "HandleError"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"step-function-timeout",children:"Step Function timeout"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Execution times out."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Increase timeout in state machine definition"}),"\n",(0,r.jsx)(n.li,{children:"Break long-running tasks into smaller steps"}),"\n",(0,r.jsx)(n.li,{children:"Use wait states with callbacks for async operations"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"deployment-issues",children:"Deployment Issues"}),"\n",(0,r.jsx)(n.h3,{id:"cdk-deployment-fails",children:"CDK deployment fails"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": cdk deploy fails with CloudFormation error."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Check CloudFormation events:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws cloudformation describe-stack-events --stack-name YourStack\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Common causes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"IAM permission issues"}),"\n",(0,r.jsx)(n.li,{children:"Resource limit exceeded"}),"\n",(0,r.jsx)(n.li,{children:"Invalid resource configuration"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Roll back and fix:"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws cloudformation delete-stack --stack-name YourStack\n# Fix the issue and redeploy\ncdk deploy\n"})}),"\n",(0,r.jsx)(n.h3,{id:"resource-already-exists",children:"Resource already exists"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Resource with name X already exists."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Use unique naming:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const bucket = new s3.Bucket(this, 'Bucket', {\n  bucketName: `${props.appName}-${props.envName}-${cdk.Aws.ACCOUNT_ID}`,\n});\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Or let CDK generate names by not specifying bucketName"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance-issues",children:"Performance Issues"}),"\n",(0,r.jsx)(n.h3,{id:"slow-api-response-times",children:"Slow API response times"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": API responses take too long."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Enable Lambda provisioned concurrency"}),"\n",(0,r.jsx)(n.li,{children:"Implement caching with API Gateway or DAX"}),"\n",(0,r.jsx)(n.li,{children:"Optimize database queries"}),"\n",(0,r.jsx)(n.li,{children:"Use connection pooling for RDS"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"high-lambda-costs",children:"High Lambda costs"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom"}),": Unexpectedly high Lambda billing."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Review invocation counts and duration"}),"\n",(0,r.jsx)(n.li,{children:"Optimize memory allocation (more memory = faster execution)"}),"\n",(0,r.jsx)(n.li,{children:"Implement request batching"}),"\n",(0,r.jsx)(n.li,{children:"Use reserved concurrency to limit scaling"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"getting-help",children:"Getting Help"}),"\n",(0,r.jsx)(n.p,{children:"If you can't find a solution here:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Check the ",(0,r.jsx)(n.a,{href:"./debugging-guide",children:"Debugging Guide"})," for investigation techniques"]}),"\n",(0,r.jsx)(n.li,{children:"Search existing issues on GitHub"}),"\n",(0,r.jsxs)(n.li,{children:["Create a new issue with:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Clear description of the problem"}),"\n",(0,r.jsx)(n.li,{children:"Steps to reproduce"}),"\n",(0,r.jsx)(n.li,{children:"Error messages and logs"}),"\n",(0,r.jsx)(n.li,{children:"Environment details (Node version, OS, etc.)"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var i=s(6540);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);