"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[959],{7955:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"notification-module","title":"Notification","description":"Learn about real-time notifications and email services in MBC CQRS Serverless.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/notification-module.md","sourceDirName":".","slug":"/notification-module","permalink":"/docs/notification-module","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"description":"Learn about real-time notifications and email services in MBC CQRS Serverless."},"sidebar":"tutorialSidebar","previous":{"title":"Import","permalink":"/docs/import"},"next":{"title":"EmailService","permalink":"/docs/email-service"}}');var s=i(4848),a=i(8453);const r={description:"Learn about real-time notifications and email services in MBC CQRS Serverless."},c="Notification",l={},d=[{value:"Architecture",id:"architecture",level:2},{value:"Real-time Notifications",id:"real-time-notifications",level:2},{value:"Overview",id:"overview",level:3},{value:"INotification Interface",id:"inotification-interface",level:3},{value:"AppSyncService",id:"appsyncservice",level:3},{value:"Method: <code>sendMessage(msg: INotification): Promise&lt;any&gt;</code>",id:"method-sendmessagemsg-inotification-promiseany",level:4},{value:"Configuration",id:"configuration",level:4},{value:"Usage",id:"usage",level:4},{value:"Authentication",id:"authentication",level:4},{value:"Automatic Notifications",id:"automatic-notifications",level:3},{value:"NotificationEvent",id:"notificationevent",level:3},{value:"NotificationEventHandler",id:"notificationeventhandler",level:3},{value:"Email Notifications",id:"email-notifications",level:2},{value:"EmailService",id:"emailservice",level:3},{value:"Configuration",id:"configuration-1",level:4},{value:"Basic Usage",id:"basic-usage",level:4},{value:"Email with Attachments",id:"email-with-attachments",level:4},{value:"Inline Template Emails",id:"inline-template-emails",level:3},{value:"Basic Usage",id:"basic-usage-1",level:4},{value:"Template Syntax",id:"template-syntax",level:4},{value:"Advanced Template Features",id:"advanced-template-features",level:4},{value:"Nested Property Access",id:"nested-property-access",level:5},{value:"Unicode and Japanese Key Support",id:"unicode-and-japanese-key-support",level:5},{value:"Whitespace in Placeholders",id:"whitespace-in-placeholders",level:5},{value:"Missing Variables",id:"missing-variables",level:5},{value:"Limitations",id:"limitations",level:5},{value:"TemplatedEmailNotification Interface",id:"templatedemailnotification-interface",level:4},{value:"InlineTemplateContent Interface",id:"inlinetemplatecontent-interface",level:4},{value:"Local Development",id:"local-development",level:4},{value:"EmailNotification Interface",id:"emailnotification-interface",level:4},{value:"Email Tags",id:"email-tags",level:3},{value:"Basic Usage",id:"basic-usage-2",level:4},{value:"EmailTag Interface",id:"emailtag-interface",level:4},{value:"Use Cases",id:"use-cases",level:4},{value:"Attachment Interface",id:"attachment-interface",level:4},{value:"See Also",id:"see-also",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"notification",children:"Notification"})}),"\n",(0,s.jsx)(n.p,{children:"The NotificationModule provides two types of notification capabilities in the MBC CQRS Serverless framework:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Real-time notifications"})," via AWS AppSync for WebSocket-based updates"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Email notifications"})," via AWS SES for sending emails"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Real-time Notifications"\n        A["DynamoDB Stream"] --\x3e B["NotificationEventHandler"]\n        B --\x3e C["AppSyncService"]\n        C --\x3e D["AppSync GraphQL"]\n        D --\x3e E["WebSocket Clients"]\n    end\n\n    subgraph "Email Notifications"\n        F["Application Code"] --\x3e G["EmailService"]\n        G --\x3e H["AWS SES"]\n        H --\x3e I["Email Recipients"]\n    end'}),"\n",(0,s.jsx)(n.h2,{id:"real-time-notifications",children:"Real-time Notifications"}),"\n",(0,s.jsx)(n.h3,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Real-time notifications are automatically sent when data changes occur in DynamoDB. The system uses AWS AppSync to deliver notifications to subscribed WebSocket clients."}),"\n",(0,s.jsx)(n.h3,{id:"inotification-interface",children:"INotification Interface"}),"\n",(0,s.jsx)(n.p,{children:"The notification payload structure:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"interface INotification {\n  id: string;        // Unique notification ID\n  table: string;     // Source DynamoDB table name\n  pk: string;        // Partition key of the changed item\n  sk: string;        // Sort key of the changed item\n  tenantCode: string; // Tenant code for filtering notifications\n  action: string;    // Type of change: 'INSERT', 'MODIFY', 'REMOVE'\n  content?: object;  // Optional payload with changed data\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"appsyncservice",children:"AppSyncService"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"AppSyncService"})," sends real-time notifications to AppSync for WebSocket delivery."]}),"\n",(0,s.jsxs)(n.h4,{id:"method-sendmessagemsg-inotification-promiseany",children:["Method: ",(0,s.jsx)(n.code,{children:"sendMessage(msg: INotification): Promise<any>"})]}),"\n",(0,s.jsx)(n.p,{children:"Sends a notification to AppSync via GraphQL mutation. The notification is delivered to all subscribed WebSocket clients."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'await this.appSyncService.sendMessage({\n  id: "unique-id",\n  table: "my-table",\n  pk: "ITEM#tenant1",\n  sk: "ITEM#001",\n  tenantCode: "tenant1",\n  action: "MODIFY",\n  content: { status: "updated" },\n});\n'})}),"\n",(0,s.jsx)(n.h4,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Set the following environment variables:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"APPSYNC_ENDPOINT=https://xxxxx.appsync-api.ap-northeast-1.amazonaws.com/graphql\nAPPSYNC_API_KEY=da2-xxxxxxxxxx  # Optional: Use API key auth instead of IAM\n"})}),"\n",(0,s.jsx)(n.h4,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { AppSyncService, INotification } from "@mbc-cqrs-serverless/core";\n\n@Injectable()\nexport class MyService {\n  constructor(private readonly appSyncService: AppSyncService) {}\n\n  async notifyClients() {\n    const notification: INotification = {\n      id: "notification-123",\n      table: "my-table",\n      pk: "ITEM#tenant1",\n      sk: "ITEM#item001",\n      tenantCode: "tenant1",\n      action: "MODIFY",\n      content: { status: "updated" },\n    };\n\n    await this.appSyncService.sendMessage(notification);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"authentication",children:"Authentication"}),"\n",(0,s.jsx)(n.p,{children:"The AppSyncService supports two authentication methods:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"API Key"}),": Set ",(0,s.jsx)(n.code,{children:"APPSYNC_API_KEY"})," environment variable"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"IAM Signature V4"}),": Used automatically when API key is not set"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"automatic-notifications",children:"Automatic Notifications"}),"\n",(0,s.jsx)(n.p,{children:"The framework automatically sends notifications when data changes through:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["DynamoDB Streams trigger the ",(0,s.jsx)(n.code,{children:"NotificationEventHandler"})]}),"\n",(0,s.jsxs)(n.li,{children:["Handler extracts change information and creates ",(0,s.jsx)(n.code,{children:"INotification"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"AppSyncService.sendMessage()"})," delivers to AppSync"]}),"\n",(0,s.jsx)(n.li,{children:"Connected clients receive updates via WebSocket subscription"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"notificationevent",children:"NotificationEvent"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"NotificationEvent"})," class represents a notification event from SQS. It implements ",(0,s.jsx)(n.code,{children:"IEvent"})," and wraps an SQS record containing notification data."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { NotificationEvent } from "@mbc-cqrs-serverless/core";\n\nclass NotificationEvent implements IEvent, SQSRecord {\n  source: string;\n  messageId: string;\n  receiptHandle: string;\n  body: string;              // JSON string containing INotification data\n  attributes: SQSRecordAttributes;\n  messageAttributes: SQSMessageAttributes;\n  md5OfBody: string;\n  eventSource: string;\n  eventSourceARN: string;\n  awsRegion: string;\n\n  // Creates a NotificationEvent from an SQS record\n  fromSqsRecord(record: SQSRecord): NotificationEvent;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"notificationeventhandler",children:"NotificationEventHandler"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"NotificationEventHandler"})," is the built-in event handler that processes ",(0,s.jsx)(n.code,{children:"NotificationEvent"})," and sends notifications to AppSync. It is automatically registered when using the notification module."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { NotificationEventHandler, NotificationEvent } from "@mbc-cqrs-serverless/core";\n\n@EventHandler(NotificationEvent)\nexport class NotificationEventHandler implements IEventHandler<NotificationEvent> {\n  async execute(event: NotificationEvent): Promise<any> {\n    // Parses the notification from event body\n    // Sends to AppSync via sendMessage()\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"You typically don't need to interact with this handler directly - it works automatically when notifications are published to the SQS queue."}),"\n",(0,s.jsx)(n.h2,{id:"email-notifications",children:"Email Notifications"}),"\n",(0,s.jsx)(n.h3,{id:"emailservice",children:"EmailService"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"EmailService"})," sends emails using AWS SES."]}),"\n",(0,s.jsx)(n.h4,{id:"configuration-1",children:"Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"SES_FROM_EMAIL=noreply@your-domain.com  # Required: Default sender address\nSES_REGION=ap-northeast-1                # Optional: SES region\nSES_ENDPOINT=                            # Optional: Custom endpoint for LocalStack\n"})}),"\n",(0,s.jsx)(n.h4,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { EmailService, EmailNotification } from "@mbc-cqrs-serverless/core";\n\n@Injectable()\nexport class MyService {\n  constructor(private readonly emailService: EmailService) {}\n\n  async sendWelcomeEmail(userEmail: string) {\n    const email: EmailNotification = {\n      toAddrs: [userEmail],\n      subject: "Welcome to Our Service",\n      body: "<h1>Welcome!</h1><p>Thank you for signing up.</p>",\n    };\n\n    await this.emailService.sendEmail(email);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"email-with-attachments",children:"Email with Attachments"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { EmailNotification, Attachment } from "@mbc-cqrs-serverless/core";\nimport * as fs from "fs";\n\nconst pdfBuffer = fs.readFileSync("report.pdf");\n\nconst email: EmailNotification = {\n  toAddrs: ["user@example.com"],\n  subject: "Monthly Report",\n  body: "<p>Please find attached your monthly report.</p>",\n  attachments: [\n    {\n      filename: "report.pdf",\n      content: pdfBuffer,\n      contentType: "application/pdf",\n    },\n  ],\n};\n\nawait this.emailService.sendEmail(email);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"inline-template-emails",children:"Inline Template Emails"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"sendInlineTemplateEmail()"})," method allows you to send templated emails with dynamic data substitution, without requiring pre-registered SES templates."]}),"\n",(0,s.jsx)(n.admonition,{title:"Version Note",type:"info",children:(0,s.jsxs)(n.p,{children:["Inline template emails (",(0,s.jsx)(n.code,{children:"sendInlineTemplateEmail()"}),") were added in ",(0,s.jsx)(n.a,{href:"/docs/changelog#v1023",children:"version 1.0.23"}),"."]})}),"\n",(0,s.jsx)(n.h4,{id:"basic-usage-1",children:"Basic Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { EmailService, TemplatedEmailNotification } from "@mbc-cqrs-serverless/core";\n\n@Injectable()\nexport class MyService {\n  constructor(private readonly emailService: EmailService) {}\n\n  async sendWelcomeEmail(user: { name: string; email: string }) {\n    const notification: TemplatedEmailNotification = {\n      toAddrs: [user.email],\n      template: {\n        subject: "Welcome, {{name}}!",\n        html: "<h1>Hello {{name}}</h1><p>Welcome to our service!</p>",\n        text: "Hello {{name}}, Welcome to our service!", // Optional plain text version\n      },\n      data: {\n        name: user.name,\n      },\n    };\n\n    await this.emailService.sendInlineTemplateEmail(notification);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"template-syntax",children:"Template Syntax"}),"\n",(0,s.jsxs)(n.p,{children:["Templates use ",(0,s.jsx)(n.code,{children:"{{variableName}}"})," placeholders that are replaced with values from the ",(0,s.jsx)(n.code,{children:"data"})," object:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'const notification: TemplatedEmailNotification = {\n  toAddrs: ["user@example.com"],\n  template: {\n    subject: "Order {{orderId}} Confirmation",\n    html: `\n      <h1>Thank you, {{customerName}}!</h1>\n      <p>Your order #{{orderId}} has been confirmed.</p>\n      <p>Total: {{currency}}{{totalAmount}}</p>\n    `,\n  },\n  data: {\n    customerName: "John Doe",\n    orderId: "12345",\n    currency: "$",\n    totalAmount: "99.99",\n  },\n};\n'})}),"\n",(0,s.jsx)(n.h4,{id:"advanced-template-features",children:"Advanced Template Features"}),"\n",(0,s.jsx)(n.admonition,{title:"Version Note",type:"info",children:(0,s.jsxs)(n.p,{children:["Nested property access and Unicode key support were added in ",(0,s.jsx)(n.a,{href:"/docs/changelog#v1025",children:"version 1.0.25"}),"."]})}),"\n",(0,s.jsx)(n.h5,{id:"nested-property-access",children:"Nested Property Access"}),"\n",(0,s.jsx)(n.p,{children:"You can access nested object properties using dot notation:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'const notification: TemplatedEmailNotification = {\n  toAddrs: ["user@example.com"],\n  template: {\n    subject: "Welcome {{user.profile.firstName}}!",\n    html: `\n      <p>Hello {{user.profile.firstName}} {{user.profile.lastName}},</p>\n      <p>Your verification code is: {{auth.otp}}</p>\n    `,\n  },\n  data: {\n    user: {\n      profile: {\n        firstName: "John",\n        lastName: "Doe",\n      },\n    },\n    auth: {\n      otp: "123456",\n    },\n  },\n};\n'})}),"\n",(0,s.jsx)(n.h5,{id:"unicode-and-japanese-key-support",children:"Unicode and Japanese Key Support"}),"\n",(0,s.jsx)(n.p,{children:"Template variables support Unicode characters, including Japanese keys:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'const notification: TemplatedEmailNotification = {\n  toAddrs: ["user@example.com"],\n  template: {\n    subject: "{{\u6ce8\u6587.\u78ba\u8a8d\u756a\u53f7}} - Order Confirmation",\n    html: `\n      <p>{{\u9867\u5ba2.\u540d\u524d}} \u69d8</p>\n      <p>\u3054\u6ce8\u6587\u756a\u53f7: {{\u6ce8\u6587.\u78ba\u8a8d\u756a\u53f7}}</p>\n      <p>\u5546\u54c1: {{\u6ce8\u6587.\u8a73\u7d30.\u54c1\u540d}}</p>\n    `,\n  },\n  data: {\n    "\u9867\u5ba2": {\n      "\u540d\u524d": "\u5c71\u7530 \u592a\u90ce",\n    },\n    "\u6ce8\u6587": {\n      "\u78ba\u8a8d\u756a\u53f7": "ORD-2024-001",\n      "\u8a73\u7d30": {\n        "\u54c1\u540d": "\u30ef\u30a4\u30e4\u30ec\u30b9\u30a4\u30e4\u30db\u30f3",\n      },\n    },\n  },\n};\n'})}),"\n",(0,s.jsx)(n.h5,{id:"whitespace-in-placeholders",children:"Whitespace in Placeholders"}),"\n",(0,s.jsxs)(n.p,{children:["Whitespace inside placeholders is automatically trimmed, so ",(0,s.jsx)(n.code,{children:"{{ name }}"})," and ",(0,s.jsx)(n.code,{children:"{{name}}"})," are equivalent:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// Both of these work identically\ntemplate: {\n  subject: "Hello {{ name }}!",  // Whitespace is trimmed\n  html: "<p>Hello {{name}}!</p>", // No whitespace\n}\n'})}),"\n",(0,s.jsx)(n.h5,{id:"missing-variables",children:"Missing Variables"}),"\n",(0,s.jsx)(n.p,{children:"If a variable is not found in the data object, the placeholder is preserved in the output. This helps identify missing data during development:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// If 'missingKey' is not in data, output will contain '{{missingKey}}'\ntemplate: {\n  html: \"<p>Value: {{missingKey}}</p>\",\n}\n"})}),"\n",(0,s.jsx)(n.h5,{id:"limitations",children:"Limitations"}),"\n",(0,s.jsx)(n.p,{children:"The following limitations apply to template variable names (for security reasons):"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Limitation"}),(0,s.jsx)(n.th,{children:"Value"}),(0,s.jsx)(n.th,{children:"Reason"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Maximum variable name length"}),(0,s.jsx)(n.td,{children:"255 characters"}),(0,s.jsx)(n.td,{children:"Prevents ReDoS (Regular Expression Denial of Service) attacks"})]})})]}),"\n",(0,s.jsx)(n.p,{children:"Variable names exceeding 255 characters will not be replaced and will remain as literal placeholders in the output."}),"\n",(0,s.jsx)(n.h4,{id:"templatedemailnotification-interface",children:"TemplatedEmailNotification Interface"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"fromAddr"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Sender email (uses SES_FROM_EMAIL if not set)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"toAddrs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string[]"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"List of recipient email addresses"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ccAddrs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string[]"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"CC recipients"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bccAddrs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string[]"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"BCC recipients"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"replyToAddrs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string[]"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Reply-to addresses"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"template"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"InlineTemplateContent"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Template with subject, HTML, and optional text"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"data"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Record<string, any>"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Data object for template variable substitution"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"configurationSetName"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"SES configuration set name for tracking"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"inlinetemplatecontent-interface",children:"InlineTemplateContent Interface"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"subject"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Email subject line (supports template variables)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"html"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"HTML body (supports template variables)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"text"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Plain text body (supports template variables)"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"local-development",children:"Local Development"}),"\n",(0,s.jsx)(n.p,{children:"When running locally without SES access, the method automatically falls back to manual template compilation, allowing you to test email flows during development."}),"\n",(0,s.jsx)(n.h4,{id:"emailnotification-interface",children:"EmailNotification Interface"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"fromAddr"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Sender email (uses SES_FROM_EMAIL if not set)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"toAddrs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string[]"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"List of recipient email addresses"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ccAddrs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string[]"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"CC recipients"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bccAddrs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string[]"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"BCC recipients"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"subject"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Email subject line"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"body"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Email body as HTML"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"replyToAddrs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string[]"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Reply-to addresses"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"attachments"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Attachment[]"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"File attachments"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"emailTags"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"EmailTag[]"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Tags for email categorization (SES Email Tags)"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"email-tags",children:"Email Tags"}),"\n",(0,s.jsx)(n.p,{children:"Email tags allow you to categorize and track emails sent through AWS SES. Tags are useful for filtering emails in SES analytics, CloudWatch, and event destinations."}),"\n",(0,s.jsx)(n.admonition,{title:"Version Note",type:"info",children:(0,s.jsxs)(n.p,{children:["EmailTags support was added in ",(0,s.jsx)(n.a,{href:"/docs/changelog#v110",children:"version 1.1.0"}),"."]})}),"\n",(0,s.jsx)(n.h4,{id:"basic-usage-2",children:"Basic Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { EmailService, EmailNotification, EmailTag } from "@mbc-cqrs-serverless/core";\n\nconst email: EmailNotification = {\n  toAddrs: ["user@example.com"],\n  subject: "Order Confirmation",\n  body: "<p>Your order has been confirmed.</p>",\n  emailTags: [\n    { name: "category", value: "order-confirmation" },\n    { name: "tenant", value: "tenant-123" },\n    { name: "environment", value: "production" },\n  ],\n};\n\nawait this.emailService.sendEmail(email);\n'})}),"\n",(0,s.jsx)(n.h4,{id:"emailtag-interface",children:"EmailTag Interface"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"name"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Tag name (e.g., 'category', 'campaign')"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"value"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Tag value for categorization"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Campaign tracking"}),": Tag emails by marketing campaign to analyze performance"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tenant isolation"}),": Tag by tenant code for multi-tenant email analytics"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Email type categorization"}),": Distinguish transactional emails from promotional ones"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Environment tagging"}),": Track emails across development, staging, and production"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"attachment-interface",children:"Attachment Interface"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"filename"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Filename shown to recipient"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"content"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Buffer"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"File content as Buffer"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"contentType"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"MIME type (e.g., 'application/pdf')"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./event-handling-patterns",children:"Event Handling Patterns"})," - How notifications integrate with events"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./environment-variables",children:"Environment Variables"})," - Configuration reference"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var t=i(6540);const s={},a=t.createContext(s);function r(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);