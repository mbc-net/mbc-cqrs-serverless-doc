"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[5299],{2496:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"installation","title":"Installation","description":"Installation","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/installation.md","sourceDirName":".","slug":"/installation","permalink":"/docs/installation","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"description":"Installation"},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/docs/getting-started"},"next":{"title":"Project structure","permalink":"/docs/project-structure"}}');var s=t(4848),r=t(8453);const i={description:"Installation"},o="Installation",c={},d=[{value:"Automatic Installation",id:"automatic-installation",level:2},{value:"Run the Development Server",id:"run-the-development-server",level:2},{value:"Configuring Local Service Ports",id:"configuring-local-ports",level:2},{value:"Available Port Variables",id:"available-port-variables",level:3},{value:"Example: Changing Ports",id:"example-changing-ports",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"installation",children:"Installation"})}),"\n",(0,s.jsx)(n.p,{children:"System Requirements:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://nodejs.org/en/download/package-manager",children:"Node.js"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://jqlang.github.io/jq/download/",children:"JQ cli"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html",children:"AWS cli"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.docker.com/engine/install/",children:"Docker"})}),"\n",(0,s.jsx)(n.li,{children:"windows, macOS and Linux are supported."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"automatic-installation",children:"Automatic Installation"}),"\n",(0,s.jsxs)(n.p,{children:["To get started, you can scaffold the project with the ",(0,s.jsx)(n.a,{href:"/docs/cli",children:"mbc-cqrs-serverless CLI"}),". To scaffold the project with the mbc-cqrs-serverless CLI, run the following commands. This will create a new project directory, and populate the directory with the initial core mbc-cqrs-serverless files and supporting modules, creating a conventional base structure for your project."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm i -g @mbc-cqrs-serverless/cli\nmbc new project-name\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you're new to mbc-cqrs-serverless, see the ",(0,s.jsx)(n.a,{href:"/docs/project-structure",children:"project structure"})," docs for an overview of all the possible files and folders in your application."]}),"\n",(0,s.jsx)(n.h2,{id:"run-the-development-server",children:"Run the Development Server"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"npm run build"})," to the build project using development mode."]}),"\n",(0,s.jsxs)(n.li,{children:["Open in other terminal session and run ",(0,s.jsx)(n.code,{children:"npm run offline:docker"})]}),"\n",(0,s.jsxs)(n.li,{children:["Open in other terminal session and run ",(0,s.jsx)(n.code,{children:"npm run migrate"})," to migrate RDS and dynamoDB table"]}),"\n",(0,s.jsxs)(n.li,{children:["Finally, run ",(0,s.jsx)(n.code,{children:"npm run offline:sls"})," to start serverless offline mode."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"After the server runs successfully, you can see:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'DEBUG[serverless-offline-sns][adapter]: successfully subscribed queue "http://localhost:9324/101010101010/notification-queue" to topic: "arn:aws:sns:ap-northeast-1:101010101010:MySnsTopic"\nOffline Lambda Server listening on http://localhost:4000\nserverless-offline-aws-eventbridge :: Plugin ready\nserverless-offline-aws-eventbridge :: Mock server running at port: 4010\nStarting Offline SQS at stage dev (ap-northeast-1)\nStarting Offline Dynamodb Streams at stage dev (ap-northeast-1)\n\nStarting Offline at stage dev (ap-northeast-1)\n\nOffline [http for lambda] listening on http://localhost:3002\nFunction names exposed for local invocation by aws-sdk:\n           * main: serverless-example-dev-main\nConfiguring JWT Authorization: ANY /{proxy+}\n\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502                                                                        \u2502\n   \u2502   ANY | http://localhost:3000/api/public                               \u2502\n   \u2502   POST | http://localhost:3000/2015-03-31/functions/main/invocations   \u2502\n   \u2502   ANY | http://localhost:3000/swagger-ui/{proxy*}                      \u2502\n   \u2502   POST | http://localhost:3000/2015-03-31/functions/main/invocations   \u2502\n   \u2502   ANY | http://localhost:3000/{proxy*}                                 \u2502\n   \u2502   POST | http://localhost:3000/2015-03-31/functions/main/invocations   \u2502\n   \u2502                                                                        \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nServer ready: http://localhost:3000 \ud83d\ude80\n'})}),"\n",(0,s.jsx)(n.p,{children:"You can also use several endpoints:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["API gateway: ",(0,s.jsx)(n.a,{href:"http://localhost:3000",children:"http://localhost:3000"})]}),"\n",(0,s.jsxs)(n.li,{children:["Offline Lambda Server: ",(0,s.jsx)(n.a,{href:"http://localhost:4000",children:"http://localhost:4000"})]}),"\n",(0,s.jsxs)(n.li,{children:["HTTP for lambda: ",(0,s.jsx)(n.a,{href:"http://localhost:3002",children:"http://localhost:3002"})]}),"\n",(0,s.jsxs)(n.li,{children:["Step functions: ",(0,s.jsx)(n.a,{href:"http://localhost:8083",children:"http://localhost:8083"})]}),"\n",(0,s.jsxs)(n.li,{children:["DynamoDB: ",(0,s.jsx)(n.a,{href:"http://localhost:8000",children:"http://localhost:8000"})]}),"\n",(0,s.jsxs)(n.li,{children:["DynamoDB admin: ",(0,s.jsx)(n.a,{href:"http://localhost:8001",children:"http://localhost:8001"})]}),"\n",(0,s.jsxs)(n.li,{children:["SNS: ",(0,s.jsx)(n.a,{href:"http://localhost:4002",children:"http://localhost:4002"})]}),"\n",(0,s.jsxs)(n.li,{children:["SQS: ",(0,s.jsx)(n.a,{href:"http://localhost:9324",children:"http://localhost:9324"})]}),"\n",(0,s.jsxs)(n.li,{children:["SQS admin: ",(0,s.jsx)(n.a,{href:"http://localhost:9325",children:"http://localhost:9325"})]}),"\n",(0,s.jsxs)(n.li,{children:["Localstack: ",(0,s.jsx)(n.a,{href:"http://localhost:4566",children:"http://localhost:4566"})]}),"\n",(0,s.jsxs)(n.li,{children:["AppSync: ",(0,s.jsx)(n.a,{href:"http://localhost:4001",children:"http://localhost:4001"})]}),"\n",(0,s.jsxs)(n.li,{children:["Cognito: ",(0,s.jsx)(n.a,{href:"http://localhost:9229",children:"http://localhost:9229"})]}),"\n",(0,s.jsxs)(n.li,{children:["EventBridge: ",(0,s.jsx)(n.a,{href:"http://localhost:4010",children:"http://localhost:4010"})]}),"\n",(0,s.jsxs)(n.li,{children:["Simple Email Service: ",(0,s.jsx)(n.a,{href:"http://localhost:8005",children:"http://localhost:8005"})]}),"\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"npx prisma studio"})," to open studio web: ",(0,s.jsx)(n.a,{href:"http://localhost:5000",children:"http://localhost:5000"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuring-local-ports",children:"Configuring Local Service Ports"}),"\n",(0,s.jsx)(n.admonition,{title:"Version Note",type:"info",children:(0,s.jsxs)(n.p,{children:["Local port configuration feature was added in ",(0,s.jsx)(n.a,{href:"/docs/changelog#v1026",children:"version 1.0.26"}),"."]})}),"\n",(0,s.jsxs)(n.p,{children:["If you have port conflicts with other services (e.g., another MySQL instance, another application using port 3000), you can configure the local service ports via environment variables in your ",(0,s.jsx)(n.code,{children:".env"})," file."]}),"\n",(0,s.jsx)(n.h3,{id:"available-port-variables",children:"Available Port Variables"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Variable"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Service"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_HTTP_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"3000"})}),(0,s.jsx)(n.td,{children:"API Gateway (Serverless Offline)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_LAMBDA_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"3002"})}),(0,s.jsx)(n.td,{children:"Lambda HTTP endpoint"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_DYNAMODB_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"8000"})}),(0,s.jsx)(n.td,{children:"DynamoDB Local"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_RDS_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"3306"})}),(0,s.jsx)(n.td,{children:"MySQL (RDS)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_S3_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"4566"})}),(0,s.jsx)(n.td,{children:"LocalStack (S3)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_SNS_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"4002"})}),(0,s.jsx)(n.td,{children:"SNS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_SQS_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"9324"})}),(0,s.jsx)(n.td,{children:"SQS (ElasticMQ)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_SQS_UI_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"9325"})}),(0,s.jsx)(n.td,{children:"SQS Admin UI"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_SFN_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"8083"})}),(0,s.jsx)(n.td,{children:"Step Functions Local"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_COGNITO_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"9229"})}),(0,s.jsx)(n.td,{children:"Cognito Local"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_APPSYNC_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"4001"})}),(0,s.jsx)(n.td,{children:"AppSync Simulator"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_EVENTBRIDGE_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"4010"})}),(0,s.jsx)(n.td,{children:"EventBridge"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_SES_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"8005"})}),(0,s.jsx)(n.td,{children:"Simple Email Service"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"LOCAL_DDB_ADMIN_PORT"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"8001"})}),(0,s.jsx)(n.td,{children:"DynamoDB Admin UI"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"example-changing-ports",children:"Example: Changing Ports"}),"\n",(0,s.jsxs)(n.p,{children:["To change the API Gateway port from 3000 to 3010 and MySQL port from 3306 to 3307, add the following to your ",(0,s.jsx)(n.code,{children:".env"})," file:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Change API Gateway port to 3010\nLOCAL_HTTP_PORT=3010\n\n# Change MySQL port to 3307\nLOCAL_RDS_PORT=3307\n\n# Change DynamoDB port to 9000\nLOCAL_DYNAMODB_PORT=9000\n"})}),"\n",(0,s.jsx)(n.p,{children:"After changing the ports, restart all services:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Stop all running services (Docker and Serverless Offline)"}),"\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"npm run offline:docker"})," to restart Docker services"]}),"\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"npm run offline:sls"})," to restart Serverless Offline"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["The port configuration is automatically applied to all related services including Docker Compose, Serverless Offline, and the DynamoDB stream trigger script. You only need to set the environment variables once in your ",(0,s.jsx)(n.code,{children:".env"})," file."]})}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsxs)(n.p,{children:["In the local environment, if you have trouble with the ",(0,s.jsx)(n.code,{children:"npm run migrate"})," command or cannot log in with local Cognito, you will need to add more permissions to files and folders using the command below:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo chmod -R 777 ./infra-local/cognito-local\nsudo chmod -R 777 ./infra-local/cognito-local/db/clients.json\nsudo chmod -R 777 ./infra-local\nsudo chmod -R 777 ./infra-local/docker-data/\nsudo chmod -R 777 ./infra-local/docker-data/dynamodb-local\n"})})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var l=t(6540);const s={},r=l.createContext(s);function i(e){const n=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);