"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[6922],{97:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"error-catalog","title":"Error Catalog","description":"Comprehensive error catalog with causes, solutions, and recovery strategies for MBC CQRS Serverless.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/error-catalog.md","sourceDirName":".","slug":"/error-catalog","permalink":"/docs/error-catalog","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"description":"Comprehensive error catalog with causes, solutions, and recovery strategies for MBC CQRS Serverless."},"sidebar":"tutorialSidebar","previous":{"title":"Interfaces","permalink":"/docs/interfaces"},"next":{"title":"Anti-Patterns Guide","permalink":"/docs/anti-patterns"}}');var s=r(4848),i=r(8453);const o={sidebar_position:2,description:"Comprehensive error catalog with causes, solutions, and recovery strategies for MBC CQRS Serverless."},d="Error Catalog",c={},a=[{value:"Quick Reference",id:"quick-reference",level:2},{value:"Command &amp; Data Errors",id:"command--data-errors",level:3},{value:"Tenant Errors",id:"tenant-errors",level:3},{value:"Sequence &amp; Task Errors",id:"sequence--task-errors",level:3},{value:"Validation Errors",id:"validation-errors",level:3},{value:"DynamoDB Errors",id:"dynamodb-errors",level:3},{value:"Authentication Errors",id:"authentication-errors",level:3},{value:"Import Module Errors",id:"import-module-errors",level:3},{value:"Step Functions Errors",id:"step-functions-errors",level:3},{value:"AWS Service Errors",id:"aws-service-errors",level:3},{value:"Command Service Errors",id:"command-service-errors",level:2},{value:"BadRequestException: &quot;The input is not a valid, item not found or version not match&quot;",id:"badrequestexception-the-input-is-not-a-valid-item-not-found-or-version-not-match",level:3},{value:"BadRequestException: &quot;The input key is not a valid, item not found&quot;",id:"badrequestexception-the-input-key-is-not-a-valid-item-not-found",level:3},{value:"BadRequestException: &quot;Invalid input version&quot;",id:"badrequestexception-invalid-input-version",level:3},{value:"Tenant Errors",id:"tenant-errors-1",level:2},{value:"BadRequestException: &quot;Tenant not found&quot;",id:"badrequestexception-tenant-not-found",level:3},{value:"BadRequestException: &quot;Tenant already exist&quot;",id:"badrequestexception-tenant-already-exist",level:3},{value:"Sequence Errors",id:"sequence-errors",level:2},{value:"BadRequestException: &quot;Sequence not found&quot;",id:"badrequestexception-sequence-not-found",level:3},{value:"Task Errors",id:"task-errors",level:2},{value:"NotFoundException: &quot;Task not found&quot;",id:"notfoundexception-task-not-found",level:3},{value:"Validation Errors",id:"validation-errors-1",level:2},{value:"BadRequestException: &quot;Validation failed&quot;",id:"badrequestexception-validation-failed",level:3},{value:"DynamoDB Errors",id:"dynamodb-errors-1",level:2},{value:"ProvisionedThroughputExceededException",id:"provisionedthroughputexceededexception",level:3},{value:"ConditionalCheckFailedException",id:"conditionalcheckfailedexception",level:3},{value:"ResourceNotFoundException",id:"resourcenotfoundexception",level:3},{value:"ValidationException: &quot;One or more parameter values were invalid&quot;",id:"validationexception-one-or-more-parameter-values-were-invalid",level:3},{value:"Cognito Authentication Errors",id:"cognito-authentication-errors",level:2},{value:"NotAuthorizedException",id:"notauthorizedexception",level:3},{value:"UserNotFoundException",id:"usernotfoundexception",level:3},{value:"UserNotConfirmedException",id:"usernotconfirmedexception",level:3},{value:"Import Module Errors",id:"import-module-errors",level:2},{value:"Step Functions Timeout (Import Job)",id:"step-functions-timeout-import-job",level:3},{value:"BadRequestException: &quot;No import strategy found for table: <code>{tableName}</code>&quot;",id:"badrequestexception-no-import-strategy-found-for-table-tablename",level:3},{value:"Import Job Stuck in PROCESSING Status",id:"import-job-stuck-in-processing-status",level:3},{value:"Step Functions Errors",id:"step-functions-errors-1",level:2},{value:"TaskTimedOut",id:"tasktimedout",level:3},{value:"TaskFailed",id:"taskfailed",level:3},{value:"S3 Errors",id:"s3-errors",level:2},{value:"NoSuchKey",id:"nosuchkey",level:3},{value:"AccessDenied",id:"accessdenied",level:3},{value:"SQS Errors",id:"sqs-errors",level:2},{value:"MessageNotInflight",id:"messagenotinflight",level:3},{value:"HTTP Status Code Reference",id:"http-status-code-reference",level:2},{value:"Error Handling Best Practices",id:"error-handling-best-practices",level:2},{value:"1. Centralized Error Handler",id:"1-centralized-error-handler",level:3},{value:"2. Retry with Exponential Backoff",id:"2-retry-with-exponential-backoff",level:3},{value:"3. Circuit Breaker Pattern",id:"3-circuit-breaker-pattern",level:3},{value:"Debugging Tips",id:"debugging-tips",level:2},{value:"See Also",id:"see-also",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"error-catalog",children:"Error Catalog"})}),"\n",(0,s.jsx)(n.p,{children:"This catalog provides comprehensive documentation of errors encountered in MBC CQRS Serverless, including their causes, solutions, and recovery strategies."}),"\n",(0,s.jsx)(n.h2,{id:"quick-reference",children:"Quick Reference"}),"\n",(0,s.jsx)(n.p,{children:"Use this table to quickly identify errors and jump to solutions."}),"\n",(0,s.jsx)(n.h3,{id:"command--data-errors",children:"Command & Data Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error Message"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Quick Fix"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-CMD-001"}),(0,s.jsx)(n.td,{children:"version not match"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsxs)(n.td,{children:["Fetch latest version or use ",(0,s.jsx)(n.code,{children:"version: -1"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-CMD-002"}),(0,s.jsx)(n.td,{children:"item not found"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Check if item exists before update"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-CMD-003"}),(0,s.jsx)(n.td,{children:"Invalid input version"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Use latest version from getItem()"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"tenant-errors",children:"Tenant Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error Message"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Quick Fix"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-TNT-001"}),(0,s.jsx)(n.td,{children:"Tenant not found"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Verify tenant exists with listTenants()"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-TNT-002"}),(0,s.jsx)(n.td,{children:"Tenant already exist"}),(0,s.jsx)(n.td,{children:"Low"}),(0,s.jsx)(n.td,{children:"Check existence before creating"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"sequence--task-errors",children:"Sequence & Task Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error Message"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Quick Fix"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-SEQ-001"}),(0,s.jsx)(n.td,{children:"Sequence not found"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Sequence auto-initializes on first use"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-TSK-001"}),(0,s.jsx)(n.td,{children:"Task not found"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Verify task exists with NotFoundException"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"validation-errors",children:"Validation Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error Message"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Quick Fix"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-VAL-001"}),(0,s.jsx)(n.td,{children:"Validation failed"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Check DTO constraints and input data"})]})})]}),"\n",(0,s.jsx)(n.h3,{id:"dynamodb-errors",children:"DynamoDB Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error Message"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Quick Fix"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-DDB-001"}),(0,s.jsx)(n.td,{children:"ProvisionedThroughputExceededException"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Implement exponential backoff retry"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-DDB-002"}),(0,s.jsx)(n.td,{children:"ConditionalCheckFailedException"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Refresh item and retry with new version"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-DDB-003"}),(0,s.jsx)(n.td,{children:"ResourceNotFoundException"}),(0,s.jsx)(n.td,{children:"Critical"}),(0,s.jsx)(n.td,{children:"Verify table exists and check env vars"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-DDB-004"}),(0,s.jsx)(n.td,{children:"ValidationException"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Avoid empty strings, escape reserved words"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"authentication-errors",children:"Authentication Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error Message"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Quick Fix"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-COG-001"}),(0,s.jsx)(n.td,{children:"NotAuthorizedException"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Refresh token or re-authenticate"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-COG-002"}),(0,s.jsx)(n.td,{children:"UserNotFoundException"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Check user exists in pool"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-COG-003"}),(0,s.jsx)(n.td,{children:"UserNotConfirmedException"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Resend confirmation code"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"import-module-errors",children:"Import Module Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error Message"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Quick Fix"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-IMP-001"}),(0,s.jsx)(n.td,{children:"Step Functions Timeout"}),(0,s.jsx)(n.td,{children:"Critical"}),(0,s.jsx)(n.td,{children:"Upgrade to v1.0.18+ for proper failure handling"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-IMP-002"}),(0,s.jsx)(n.td,{children:"No import strategy found"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Register ImportStrategy in module config"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-IMP-003"}),(0,s.jsx)(n.td,{children:"Import stuck in PROCESSING"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Check DynamoDB streams and SNS topics"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"step-functions-errors",children:"Step Functions Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error Message"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Quick Fix"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-SFN-001"}),(0,s.jsx)(n.td,{children:"TaskTimedOut"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Increase Lambda timeout or chunk processing"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-SFN-002"}),(0,s.jsx)(n.td,{children:"TaskFailed"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Add proper error handling with sendTaskFailure"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"aws-service-errors",children:"AWS Service Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Code"}),(0,s.jsx)(n.th,{children:"Error Message"}),(0,s.jsx)(n.th,{children:"Severity"}),(0,s.jsx)(n.th,{children:"Quick Fix"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-S3-001"}),(0,s.jsx)(n.td,{children:"NoSuchKey"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Check object exists with headObject"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-S3-002"}),(0,s.jsx)(n.td,{children:"AccessDenied"}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Add required IAM permissions"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"MBC-SQS-001"}),(0,s.jsx)(n.td,{children:"MessageNotInflight"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Process within visibility timeout"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"command-service-errors",children:"Command Service Errors"}),"\n",(0,s.jsx)(n.h3,{id:"badrequestexception-the-input-is-not-a-valid-item-not-found-or-version-not-match",children:'BadRequestException: "The input is not a valid, item not found or version not match"'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/core/src/commands/command.service.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Optimistic locking failure. The version number in the request does not match the current version in the database."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Option 1: Fetch latest version before update\nconst latest = await dataService.getItem({ pk, sk });\nawait commandService.publishPartialUpdateSync({\n  pk,\n  sk,\n  version: latest.version,\n  name: 'Updated Name',\n}, options);\n\n// Option 2: Use version: -1 for auto-fetch (async mode only)\nawait commandService.publishPartialUpdateAsync({\n  pk,\n  sk,\n  version: -1,\n  name: 'Updated Name',\n}, options);\n\n// Option 3: Implement retry logic\nasync function updateWithRetry(data, maxRetries = 3) {\n  for (let i = 0; i < maxRetries; i++) {\n    try {\n      const latest = await dataService.getItem({ pk: data.pk, sk: data.sk });\n      return await commandService.publishPartialUpdateSync({\n        ...data,\n        version: latest.version,\n      }, options);\n    } catch (error) {\n      if (error.message.includes('version not match') && i < maxRetries - 1) {\n        await new Promise(r => setTimeout(r, 100 * (i + 1)));\n        continue;\n      }\n      throw error;\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"badrequestexception-the-input-key-is-not-a-valid-item-not-found",children:'BadRequestException: "The input key is not a valid, item not found"'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/core/src/commands/command.service.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Attempting to update an item that does not exist in the database."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Check if item exists first\nconst existing = await dataService.getItem({ pk, sk });\nif (!existing) {\n  // Create new item\n  await commandService.publishAsync(newItem, options);\n} else {\n  // Update existing item\n  await commandService.publishPartialUpdateAsync({\n    pk,\n    sk,\n    version: existing.version,\n    ...updates,\n  }, options);\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"badrequestexception-invalid-input-version",children:'BadRequestException: "Invalid input version"'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/core/src/commands/command.service.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Using a version in publishSync that does not match the latest saved version."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),": Fetch the latest item and use its version, or use version: -1 with async methods."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"tenant-errors-1",children:"Tenant Errors"}),"\n",(0,s.jsx)(n.h3,{id:"badrequestexception-tenant-not-found",children:'BadRequestException: "Tenant not found"'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/tenant/src/services/tenant.service.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": The specified tenant does not exist or has been deleted."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Verify tenant exists\ntry {\n  const tenant = await tenantService.getTenant(tenantCode);\n} catch (error) {\n  if (error.message === 'Tenant not found') {\n    // List available tenants\n    const tenants = await tenantService.listTenants();\n    console.log('Available tenants:', tenants.items.map(t => t.code));\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"badrequestexception-tenant-already-exist",children:'BadRequestException: "Tenant already exist"'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/tenant/src/services/tenant.service.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Attempting to create a tenant with an existing code."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Check if tenant exists before creating\nconst existing = await tenantService.getTenant(tenantCode).catch(() => null);\nif (existing) {\n  console.log('Tenant already exists, using existing tenant');\n} else {\n  await tenantService.createTenant({ code: tenantCode, name: tenantName });\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"sequence-errors",children:"Sequence Errors"}),"\n",(0,s.jsx)(n.h3,{id:"badrequestexception-sequence-not-found",children:'BadRequestException: "Sequence not found"'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/sequence/src/services/sequence.service.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": The requested sequence key does not exist."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Generate sequence - auto-initializes on first use\ntry {\n  const result = await sequencesService.generateSequenceItem(\n    {\n      tenantCode,\n      typeCode: 'ORDER',\n    },\n    { invokeContext },\n  );\n} catch (error) {\n  // If error persists, check DynamoDB table permissions\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"task-errors",children:"Task Errors"}),"\n",(0,s.jsx)(n.h3,{id:"notfoundexception-task-not-found",children:'NotFoundException: "Task not found"'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/task/src/task.controller.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": The specified task does not exist or has been completed/deleted."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Verify task status before operations\nconst task = await taskService.getTask({ pk, sk });\nif (!task) {\n  throw new NotFoundException('Task not found');\n}\nif (task.status === 'completed') {\n  throw new BadRequestException('Task already completed');\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"validation-errors-1",children:"Validation Errors"}),"\n",(0,s.jsx)(n.h3,{id:"badrequestexception-validation-failed",children:'BadRequestException: "Validation failed"'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/core/src/pipe/class.validation.pipe.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": The request DTO failed class-validator validation."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Common Validation Errors"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Example DTO with validation\nexport class CreateOrderDto {\n  @IsNotEmpty({ message: 'Name is required' })\n  @IsString()\n  @MaxLength(100)\n  name: string;\n\n  @IsNotEmpty({ message: 'Code is required' })\n  @Matches(/^[A-Z0-9-]+$/, { message: 'Code must be uppercase alphanumeric' })\n  code: string;\n\n  @IsOptional()\n  @IsNumber()\n  @Min(0)\n  amount?: number;\n}\n\n// Common validation errors and fixes:\n// - \"name must be a string\" -> Ensure name is string type\n// - \"code should not be empty\" -> Provide code value\n// - \"amount must not be less than 0\" -> Use positive number\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Validate before sending\nimport { validate } from 'class-validator';\nimport { plainToInstance } from 'class-transformer';\n\nconst dto = plainToInstance(CreateOrderDto, requestBody);\nconst errors = await validate(dto);\nif (errors.length > 0) {\n  console.log('Validation errors:', errors.map(e => e.constraints));\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"dynamodb-errors-1",children:"DynamoDB Errors"}),"\n",(0,s.jsx)(n.h3,{id:"provisionedthroughputexceededexception",children:"ProvisionedThroughputExceededException"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS DynamoDB"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Read or write capacity has been exceeded on on-demand or provisioned tables."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Implement exponential backoff retry\nasync function withRetry<T>(\n  fn: () => Promise<T>,\n  maxRetries = 5,\n  baseDelay = 100\n): Promise<T> {\n  for (let i = 0; i < maxRetries; i++) {\n    try {\n      return await fn();\n    } catch (error) {\n      if (error.name === 'ProvisionedThroughputExceededException') {\n        const delay = baseDelay * Math.pow(2, i) + Math.random() * 100;\n        console.log(`Throughput exceeded, retrying in ${delay}ms...`);\n        await new Promise(r => setTimeout(r, delay));\n        continue;\n      }\n      throw error;\n    }\n  }\n  throw new Error('Max retries exceeded');\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Prevention"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Use on-demand capacity mode for unpredictable workloads"}),"\n",(0,s.jsx)(n.li,{children:"Implement request batching to reduce write operations"}),"\n",(0,s.jsx)(n.li,{children:"Use DAX for read-heavy workloads"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"conditionalcheckfailedexception",children:"ConditionalCheckFailedException"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS DynamoDB"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Optimistic locking condition failed (version mismatch) or unique constraint violation."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Handle conditional check failure\ntry {\n  await commandService.publishSync(item, options);\n} catch (error) {\n  if (error.name === 'ConditionalCheckFailedException') {\n    // Refresh and retry\n    const latest = await dataService.getItem({ pk, sk });\n    await commandService.publishSync({\n      ...item,\n      version: latest.version,\n    }, options);\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"resourcenotfoundexception",children:"ResourceNotFoundException"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS DynamoDB"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": The specified table or index does not exist."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Verify table exists\naws dynamodb describe-table --table-name your-table-name\n\n# Check environment variable\necho $DYNAMODB_TABLE_NAME\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"validationexception-one-or-more-parameter-values-were-invalid",children:'ValidationException: "One or more parameter values were invalid"'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS DynamoDB"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Invalid key structure, empty string for non-key attribute, or reserved word conflict."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Avoid empty strings\nconst item = {\n  pk: 'ORDER#tenant001',\n  sk: 'ORDER#ORD001',\n  name: value || null,  // Use null instead of empty string\n};\n\n// Use expression attribute names for reserved words\nconst params = {\n  ExpressionAttributeNames: {\n    '#name': 'name',\n    '#status': 'status',\n  },\n};\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"cognito-authentication-errors",children:"Cognito Authentication Errors"}),"\n",(0,s.jsx)(n.h3,{id:"notauthorizedexception",children:"NotAuthorizedException"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS Cognito"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Invalid credentials or token expired."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Frontend: Refresh token\ntry {\n  await Auth.currentSession();  // Auto-refreshes if needed\n} catch (error) {\n  if (error.name === 'NotAuthorizedException') {\n    // Redirect to login\n    await Auth.signOut();\n    window.location.href = '/login';\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"usernotfoundexception",children:"UserNotFoundException"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS Cognito"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": User does not exist in the user pool."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Check user exists before operations\ntry {\n  const user = await adminGetUser({ Username: email });\n} catch (error) {\n  if (error.name === 'UserNotFoundException') {\n    // Create new user or show registration form\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"usernotconfirmedexception",children:"UserNotConfirmedException"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS Cognito"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": User has not confirmed their email/phone."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"try {\n  await Auth.signIn(email, password);\n} catch (error) {\n  if (error.name === 'UserNotConfirmedException') {\n    // Resend confirmation code\n    await Auth.resendSignUp(email);\n    // Redirect to confirmation page\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"import-module-errors",children:"Import Module Errors"}),"\n",(0,s.jsx)(n.admonition,{title:"Related Documentation",type:"tip",children:(0,s.jsxs)(n.p,{children:["For API details and usage patterns, see ",(0,s.jsx)(n.a,{href:"./import-export-patterns#importstatushandler-api",children:"ImportStatusHandler API"}),". For version history, see ",(0,s.jsx)(n.a,{href:"./changelog#v1018",children:"Changelog v1.0.18"}),"."]})}),"\n",(0,s.jsx)(n.h3,{id:"step-functions-timeout-import-job",children:"Step Functions Timeout (Import Job)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/import/src/event/import-status.queue.event.handler.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptom"}),": Step Functions execution stays in ",(0,s.jsx)(n.code,{children:"RUNNING"})," state indefinitely for import jobs."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Prior to version 1.0.18, the ",(0,s.jsx)(n.code,{children:"ImportStatusHandler"})," only sent ",(0,s.jsx)(n.code,{children:"SendTaskSuccessCommand"})," for completed jobs. When an import job failed, no callback was sent to Step Functions, causing it to wait indefinitely for the ",(0,s.jsx)(n.code,{children:"waitForTaskToken"})," callback."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"})," (Fixed in 1.0.18+):\nThe handler now properly sends ",(0,s.jsx)(n.code,{children:"SendTaskFailureCommand"})," when import jobs fail:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Internal behavior (automatic, no user action needed):\n// - COMPLETED status \u2192 SendTaskSuccessCommand\n// - FAILED status \u2192 SendTaskFailureCommand\n"})}),"\n",(0,s.jsx)(n.p,{children:"If you're on an older version:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Upgrade to ",(0,s.jsx)(n.code,{children:"@mbc-cqrs-serverless/import@^1.0.18"})]}),"\n",(0,s.jsxs)(n.li,{children:["For stuck executions, manually stop them via AWS Console or CLI:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"aws stepfunctions stop-execution --execution-arn <execution-arn>\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h3,{id:"badrequestexception-no-import-strategy-found-for-table-tablename",children:['BadRequestException: "No import strategy found for table: ',(0,s.jsx)(n.code,{children:"{tableName}"}),'"']}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/import/src/import.service.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": No import strategy is registered for the specified table name."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":\nRegister an import strategy when configuring the ImportModule:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"ImportModule.register({\n  profiles: [\n    {\n      tableName: 'your-table-name',  // Must match the tableName in your import request\n      importStrategy: YourImportStrategy,\n      processStrategy: YourProcessStrategy,\n    },\n  ],\n})\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"import-job-stuck-in-processing-status",children:"Import Job Stuck in PROCESSING Status"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"packages/import/src/event/import.queue.event.handler.ts"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": An error occurred during import processing but the job status wasn't properly updated, or DynamoDB streams failed to trigger the next step."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Check CloudWatch logs for Lambda errors"}),"\n",(0,s.jsx)(n.li,{children:"Verify DynamoDB streams are enabled on the import_tmp table"}),"\n",(0,s.jsx)(n.li,{children:"Check if the SNS topic for import status notifications exists"}),"\n",(0,s.jsxs)(n.li,{children:["Clean up stuck records:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"await importService.updateStatus(\n  { pk: 'CSV_IMPORT#tenant', sk: 'table#taskCode' },\n  ImportStatusEnum.FAILED,\n  { error: 'Manual cleanup' }\n);\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"step-functions-errors-1",children:"Step Functions Errors"}),"\n",(0,s.jsx)(n.h3,{id:"tasktimedout",children:"TaskTimedOut"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS Step Functions"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Lambda function did not respond within the configured timeout."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Increase Lambda timeout in serverless.yml\nfunctions:\n  processTask:\n    handler: handler.process\n    timeout: 900  # 15 minutes max\n\n// Or break into smaller chunks\nasync function processInChunks(items, chunkSize = 100) {\n  for (let i = 0; i < items.length; i += chunkSize) {\n    const chunk = items.slice(i, i + chunkSize);\n    await processChunk(chunk);\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"taskfailed",children:"TaskFailed"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS Step Functions"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Lambda function threw an unhandled error."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Proper error handling with Step Functions\nexport async function handler(event: StepFunctionEvent) {\n  try {\n    const result = await processTask(event.input);\n\n    // Send success callback\n    await sfn.sendTaskSuccess({\n      taskToken: event.taskToken,\n      output: JSON.stringify(result),\n    }).promise();\n  } catch (error) {\n    // Send failure callback\n    await sfn.sendTaskFailure({\n      taskToken: event.taskToken,\n      error: error.name,\n      cause: error.message,\n    }).promise();\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"s3-errors",children:"S3 Errors"}),"\n",(0,s.jsx)(n.h3,{id:"nosuchkey",children:"NoSuchKey"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS S3"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": The specified object does not exist in the bucket."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Check if object exists before downloading\ntry {\n  await s3.headObject({ Bucket: bucket, Key: key }).promise();\n  const data = await s3.getObject({ Bucket: bucket, Key: key }).promise();\n} catch (error) {\n  if (error.code === 'NoSuchKey' || error.code === 'NotFound') {\n    console.log('File does not exist:', key);\n    return null;\n  }\n  throw error;\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"accessdenied",children:"AccessDenied"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS S3"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": IAM policy does not allow the requested operation."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Add required permissions in serverless.yml\nprovider:\n  iam:\n    role:\n      statements:\n        - Effect: Allow\n          Action:\n            - s3:GetObject\n            - s3:PutObject\n            - s3:DeleteObject\n          Resource:\n            - arn:aws:s3:::${self:custom.bucketName}/*\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"sqs-errors",children:"SQS Errors"}),"\n",(0,s.jsx)(n.h3,{id:"messagenotinflight",children:"MessageNotInflight"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": AWS SQS"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Attempting to delete or change visibility of a message that is no longer in flight."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Process messages within visibility timeout\nexport async function handler(event: SQSEvent) {\n  for (const record of event.Records) {\n    try {\n      await processMessage(record);\n      // Message auto-deleted on successful return\n    } catch (error) {\n      // Throw to keep message in queue for retry\n      throw error;\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"http-status-code-reference",children:"HTTP Status Code Reference"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Status"}),(0,s.jsx)(n.th,{children:"Exception"}),(0,s.jsx)(n.th,{children:"Meaning"}),(0,s.jsx)(n.th,{children:"Recovery Strategy"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"400"}),(0,s.jsx)(n.td,{children:"BadRequestException"}),(0,s.jsx)(n.td,{children:"Invalid input or business rule violation"}),(0,s.jsx)(n.td,{children:"Fix request data"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"401"}),(0,s.jsx)(n.td,{children:"UnauthorizedException"}),(0,s.jsx)(n.td,{children:"Authentication missing or invalid"}),(0,s.jsx)(n.td,{children:"Refresh token or re-login"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"403"}),(0,s.jsx)(n.td,{children:"ForbiddenException"}),(0,s.jsx)(n.td,{children:"Authenticated but not authorized"}),(0,s.jsx)(n.td,{children:"Check user permissions"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"404"}),(0,s.jsx)(n.td,{children:"NotFoundException"}),(0,s.jsx)(n.td,{children:"Resource not found"}),(0,s.jsx)(n.td,{children:"Verify resource exists"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"409"}),(0,s.jsx)(n.td,{children:"ConflictException"}),(0,s.jsx)(n.td,{children:"Version conflict (optimistic locking)"}),(0,s.jsx)(n.td,{children:"Refresh and retry"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"422"}),(0,s.jsx)(n.td,{children:"UnprocessableEntityException"}),(0,s.jsx)(n.td,{children:"Validation failed"}),(0,s.jsx)(n.td,{children:"Fix validation errors"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"429"}),(0,s.jsx)(n.td,{children:"TooManyRequestsException"}),(0,s.jsx)(n.td,{children:"Rate limit exceeded"}),(0,s.jsx)(n.td,{children:"Implement backoff retry"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"500"}),(0,s.jsx)(n.td,{children:"InternalServerErrorException"}),(0,s.jsx)(n.td,{children:"Unexpected server error"}),(0,s.jsx)(n.td,{children:"Check logs, report bug"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"502"}),(0,s.jsx)(n.td,{children:"BadGatewayException"}),(0,s.jsx)(n.td,{children:"Upstream service error"}),(0,s.jsx)(n.td,{children:"Retry with backoff"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"503"}),(0,s.jsx)(n.td,{children:"ServiceUnavailableException"}),(0,s.jsx)(n.td,{children:"Service temporarily unavailable"}),(0,s.jsx)(n.td,{children:"Retry later"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"504"}),(0,s.jsx)(n.td,{children:"GatewayTimeoutException"}),(0,s.jsx)(n.td,{children:"Upstream service timeout"}),(0,s.jsx)(n.td,{children:"Increase timeout or optimize"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"error-handling-best-practices",children:"Error Handling Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"1-centralized-error-handler",children:"1. Centralized Error Handler"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Create a global exception filter\n@Catch()\nexport class GlobalExceptionFilter implements ExceptionFilter {\n  catch(exception: unknown, host: ArgumentsHost) {\n    const ctx = host.switchToHttp();\n    const response = ctx.getResponse();\n    const request = ctx.getRequest();\n\n    const status = exception instanceof HttpException\n      ? exception.getStatus()\n      : 500;\n\n    const message = exception instanceof HttpException\n      ? exception.message\n      : 'Internal server error';\n\n    // Log error with context\n    console.error({\n      timestamp: new Date().toISOString(),\n      path: request.url,\n      method: request.method,\n      status,\n      message,\n      stack: exception instanceof Error ? exception.stack : undefined,\n    });\n\n    response.status(status).json({\n      statusCode: status,\n      message,\n      timestamp: new Date().toISOString(),\n      path: request.url,\n    });\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-retry-with-exponential-backoff",children:"2. Retry with Exponential Backoff"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"async function retryWithBackoff<T>(\n  operation: () => Promise<T>,\n  options: {\n    maxRetries?: number;\n    baseDelay?: number;\n    maxDelay?: number;\n    retryableErrors?: string[];\n  } = {}\n): Promise<T> {\n  const {\n    maxRetries = 3,\n    baseDelay = 100,\n    maxDelay = 10000,\n    retryableErrors = [\n      'ProvisionedThroughputExceededException',\n      'ThrottlingException',\n      'ServiceUnavailable',\n    ],\n  } = options;\n\n  let lastError: Error;\n\n  for (let attempt = 0; attempt <= maxRetries; attempt++) {\n    try {\n      return await operation();\n    } catch (error) {\n      lastError = error;\n\n      if (!retryableErrors.includes(error.name) || attempt === maxRetries) {\n        throw error;\n      }\n\n      const delay = Math.min(\n        baseDelay * Math.pow(2, attempt) + Math.random() * 100,\n        maxDelay\n      );\n\n      console.log(`Retry attempt ${attempt + 1} after ${delay}ms`);\n      await new Promise(resolve => setTimeout(resolve, delay));\n    }\n  }\n\n  throw lastError;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-circuit-breaker-pattern",children:"3. Circuit Breaker Pattern"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"class CircuitBreaker {\n  private failures = 0;\n  private lastFailure: number = 0;\n  private state: 'closed' | 'open' | 'half-open' = 'closed';\n\n  constructor(\n    private threshold: number = 5,\n    private timeout: number = 60000\n  ) {}\n\n  async execute<T>(operation: () => Promise<T>): Promise<T> {\n    if (this.state === 'open') {\n      if (Date.now() - this.lastFailure > this.timeout) {\n        this.state = 'half-open';\n      } else {\n        throw new Error('Circuit breaker is open');\n      }\n    }\n\n    try {\n      const result = await operation();\n      this.onSuccess();\n      return result;\n    } catch (error) {\n      this.onFailure();\n      throw error;\n    }\n  }\n\n  private onSuccess() {\n    this.failures = 0;\n    this.state = 'closed';\n  }\n\n  private onFailure() {\n    this.failures++;\n    this.lastFailure = Date.now();\n    if (this.failures >= this.threshold) {\n      this.state = 'open';\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"debugging-tips",children:"Debugging Tips"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Enable debug logging"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"DEBUG=* npm run offline\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Check CloudWatch logs for Lambda errors"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"aws logs tail /aws/lambda/your-function-name --follow\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use request IDs for tracing"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"console.log('RequestId:', context.awsRequestId);\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Verify environment variables"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"console.log('Config:', {\n  table: process.env.DYNAMODB_TABLE_NAME,\n  region: process.env.AWS_REGION,\n});\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Test locally with serverless-offline"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run offline -- --stage dev\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./debugging-guide",children:"Debugging Guide"})," - Detailed debugging procedures"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./common-issues",children:"Common Issues"})," - Frequently encountered problems"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./monitoring-logging",children:"Monitoring and Logging"})," - Production monitoring setup"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>d});var t=r(6540);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);