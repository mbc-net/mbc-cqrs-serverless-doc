"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[314],{4652:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"security-best-practices","title":"Security Best Practices","description":"Security best practices for building secure applications with MBC CQRS Serverless.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/security-best-practices.md","sourceDirName":".","slug":"/security-best-practices","permalink":"/docs/security-best-practices","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"sidebar_position":20,"description":"Security best practices for building secure applications with MBC CQRS Serverless."},"sidebar":"tutorialSidebar","previous":{"title":"Survey Web","permalink":"/docs/survey-web"},"next":{"title":"Authentication","permalink":"/docs/authentication"}}');var s=t(4848),r=t(8453);const a={sidebar_position:20,description:"Security best practices for building secure applications with MBC CQRS Serverless."},o="Security Best Practices",c={},l=[{value:"Input Validation",id:"input-validation",level:2},{value:"Validate All Input",id:"validate-all-input",level:3},{value:"Sanitize String Input",id:"sanitize-string-input",level:3},{value:"Validate File Uploads",id:"validate-file-uploads",level:3},{value:"Authentication",id:"authentication",level:2},{value:"Configure Cognito Securely",id:"configure-cognito-securely",level:3},{value:"Validate JWT Tokens",id:"validate-jwt-tokens",level:3},{value:"Token Refresh Strategy",id:"token-refresh-strategy",level:3},{value:"Authorization",id:"authorization",level:2},{value:"Implement Role-Based Access Control",id:"implement-role-based-access-control",level:3},{value:"Enforce Tenant Isolation",id:"enforce-tenant-isolation",level:3},{value:"Resource-Level Authorization",id:"resource-level-authorization",level:3},{value:"Data Protection",id:"data-protection",level:2},{value:"Encrypt Sensitive Data",id:"encrypt-sensitive-data",level:3},{value:"Mask Sensitive Data in Logs",id:"mask-sensitive-data-in-logs",level:3},{value:"Secure Environment Variables",id:"secure-environment-variables",level:3},{value:"API Security",id:"api-security",level:2},{value:"Rate Limiting",id:"rate-limiting",level:3},{value:"CORS Configuration",id:"cors-configuration",level:3},{value:"Request Size Limits",id:"request-size-limits",level:3},{value:"Infrastructure Security",id:"infrastructure-security",level:2},{value:"Least Privilege IAM Policies",id:"least-privilege-iam-policies",level:3},{value:"VPC Configuration",id:"vpc-configuration",level:3},{value:"Enable AWS CloudTrail",id:"enable-aws-cloudtrail",level:3},{value:"Security Checklist",id:"security-checklist",level:2},{value:"Pre-Deployment",id:"pre-deployment",level:3},{value:"Post-Deployment",id:"post-deployment",level:3},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"security-best-practices",children:"Security Best Practices"})}),"\n",(0,s.jsx)(n.p,{children:"This guide covers security best practices for building secure applications with MBC CQRS Serverless, including input validation, authentication, authorization, and data protection."}),"\n",(0,s.jsx)(n.h2,{id:"input-validation",children:"Input Validation"}),"\n",(0,s.jsx)(n.h3,{id:"validate-all-input",children:"Validate All Input"}),"\n",(0,s.jsx)(n.p,{children:"Always validate input at the API boundary using class-validator decorators."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import {\n  IsNotEmpty,\n  IsString,\n  IsEmail,\n  IsOptional,\n  MaxLength,\n  MinLength,\n  Matches,\n  IsNumber,\n  Min,\n  Max,\n  ValidateNested,\n  IsArray,\n  ArrayMaxSize,\n} from 'class-validator';\nimport { Type } from 'class-transformer';\n\nexport class CreateOrderDto {\n  @IsNotEmpty()\n  @IsString()\n  @MaxLength(100)\n  @Matches(/^[a-zA-Z0-9\\s\\-]+$/, {\n    message: 'Name contains invalid characters',\n  })\n  name: string;\n\n  @IsNotEmpty()\n  @IsString()\n  @Matches(/^[A-Z0-9\\-]+$/, {\n    message: 'Code must be uppercase alphanumeric with hyphens',\n  })\n  @MaxLength(50)\n  code: string;\n\n  @IsOptional()\n  @IsEmail()\n  customerEmail?: string;\n\n  @IsNumber()\n  @Min(0)\n  @Max(1000000)\n  amount: number;\n\n  @IsOptional()\n  @IsArray()\n  @ArrayMaxSize(100)\n  @ValidateNested({ each: true })\n  @Type(() => OrderItemDto)\n  items?: OrderItemDto[];\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"sanitize-string-input",children:"Sanitize String Input"}),"\n",(0,s.jsx)(n.p,{children:"Prevent XSS and injection attacks by sanitizing string input."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { Transform } from 'class-transformer';\nimport * as sanitizeHtml from 'sanitize-html';\n\nexport class CommentDto {\n  @IsString()\n  @MaxLength(1000)\n  @Transform(({ value }) => sanitizeHtml(value, {\n    allowedTags: [],  // Strip all HTML\n    allowedAttributes: {},\n  }))\n  content: string;\n\n  @IsString()\n  @MaxLength(500)\n  @Transform(({ value }) => sanitizeHtml(value, {\n    allowedTags: ['b', 'i', 'em', 'strong'],  // Allow basic formatting\n    allowedAttributes: {},\n  }))\n  description: string;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"validate-file-uploads",children:"Validate File Uploads"}),"\n",(0,s.jsx)(n.p,{children:"Restrict file types, sizes, and scan for malware."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Validate file type and size\nconst ALLOWED_MIME_TYPES = [\n  'image/jpeg',\n  'image/png',\n  'application/pdf',\n  'text/csv',\n];\nconst MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB\n\nasync function validateUpload(file: Express.Multer.File): Promise<void> {\n  // Check MIME type\n  if (!ALLOWED_MIME_TYPES.includes(file.mimetype)) {\n    throw new BadRequestException('File type not allowed');\n  }\n\n  // Check file size\n  if (file.size > MAX_FILE_SIZE) {\n    throw new BadRequestException('File too large');\n  }\n\n  // Verify file signature (magic bytes)\n  const fileType = await FileType.fromBuffer(file.buffer);\n  if (!fileType || !ALLOWED_MIME_TYPES.includes(fileType.mime)) {\n    throw new BadRequestException('Invalid file content');\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,s.jsx)(n.h3,{id:"configure-cognito-securely",children:"Configure Cognito Securely"}),"\n",(0,s.jsx)(n.p,{children:"Use strong password policies and MFA."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// CDK configuration for Cognito User Pool\nconst userPool = new cognito.UserPool(this, 'UserPool', {\n  selfSignUpEnabled: false,  // Disable self-registration if not needed\n  signInAliases: {\n    email: true,\n    username: false,\n  },\n  passwordPolicy: {\n    minLength: 12,\n    requireLowercase: true,\n    requireUppercase: true,\n    requireDigits: true,\n    requireSymbols: true,\n    tempPasswordValidity: Duration.days(7),\n  },\n  mfa: cognito.Mfa.REQUIRED,\n  mfaSecondFactor: {\n    sms: true,\n    otp: true,\n  },\n  accountRecovery: cognito.AccountRecovery.EMAIL_ONLY,\n  advancedSecurityMode: cognito.AdvancedSecurityMode.ENFORCED,\n});\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Default Implementation Note",type:"info",children:(0,s.jsxs)(n.p,{children:["The default implementation uses ",(0,s.jsx)(n.code,{children:"minLength: 6"})," for development convenience. For production environments, we strongly recommend using at least 12 characters as shown above, along with MFA enabled."]})}),"\n",(0,s.jsx)(n.h3,{id:"validate-jwt-tokens",children:"Validate JWT Tokens"}),"\n",(0,s.jsx)(n.p,{children:"Always validate JWT tokens on the server side."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common';\nimport { CognitoJwtVerifier } from 'aws-jwt-verify';\n\n@Injectable()\nexport class JwtAuthGuard implements CanActivate {\n  private verifier: CognitoJwtVerifier;\n\n  constructor() {\n    this.verifier = CognitoJwtVerifier.create({\n      userPoolId: process.env.COGNITO_USER_POOL_ID,\n      tokenUse: 'access',\n      clientId: process.env.COGNITO_CLIENT_ID,\n    });\n  }\n\n  async canActivate(context: ExecutionContext): Promise<boolean> {\n    const request = context.switchToHttp().getRequest();\n    const token = this.extractToken(request);\n\n    if (!token) {\n      throw new UnauthorizedException('Missing token');\n    }\n\n    try {\n      const payload = await this.verifier.verify(token);\n      request.user = payload;\n      return true;\n    } catch (error) {\n      throw new UnauthorizedException('Invalid token');\n    }\n  }\n\n  private extractToken(request: any): string | null {\n    const authHeader = request.headers.authorization;\n    if (!authHeader?.startsWith('Bearer ')) {\n      return null;\n    }\n    return authHeader.substring(7);\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"token-refresh-strategy",children:"Token Refresh Strategy"}),"\n",(0,s.jsx)(n.p,{children:"Implement secure token refresh without storing refresh tokens on client."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Frontend token refresh\nasync function refreshTokenIfNeeded(): Promise<string> {\n  try {\n    const session = await Auth.currentSession();\n    return session.getAccessToken().getJwtToken();\n  } catch (error) {\n    if (error.name === 'NotAuthorizedException') {\n      // Redirect to login\n      await Auth.signOut();\n      throw new Error('Session expired');\n    }\n    throw error;\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"authorization",children:"Authorization"}),"\n",(0,s.jsx)(n.h3,{id:"implement-role-based-access-control",children:"Implement Role-Based Access Control"}),"\n",(0,s.jsx)(n.p,{children:"Use Cognito groups for role-based authorization."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { SetMetadata, CanActivate, ExecutionContext } from '@nestjs/common';\n\nexport const ROLES_KEY = 'roles';\nexport const Roles = (...roles: string[]) => SetMetadata(ROLES_KEY, roles);\n\n@Injectable()\nexport class RolesGuard implements CanActivate {\n  constructor(private reflector: Reflector) {}\n\n  canActivate(context: ExecutionContext): boolean {\n    const requiredRoles = this.reflector.getAllAndOverride<string[]>(\n      ROLES_KEY,\n      [context.getHandler(), context.getClass()],\n    );\n\n    if (!requiredRoles) {\n      return true;\n    }\n\n    const { user } = context.switchToHttp().getRequest();\n    const userGroups = user['cognito:groups'] || [];\n\n    return requiredRoles.some(role => userGroups.includes(role));\n  }\n}\n\n// Usage in controller\n@Controller('admin')\n@UseGuards(JwtAuthGuard, RolesGuard)\nexport class AdminController {\n  @Get('users')\n  @Roles('admin', 'super-admin')\n  findAllUsers() {\n    // Only admin or super-admin can access\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"enforce-tenant-isolation",children:"Enforce Tenant Isolation"}),"\n",(0,s.jsx)(n.p,{children:"Always verify tenant access in multi-tenant applications."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@Injectable()\nexport class TenantGuard implements CanActivate {\n  canActivate(context: ExecutionContext): boolean {\n    const request = context.switchToHttp().getRequest();\n    const user = request.user;\n    const requestedTenant = request.params.tenantCode || request.body?.tenantCode;\n\n    if (!requestedTenant) {\n      return true;  // No tenant context required\n    }\n\n    const userTenants = user['custom:tenantCodes']?.split(',') || [];\n\n    if (!userTenants.includes(requestedTenant)) {\n      throw new ForbiddenException('Access denied to this tenant');\n    }\n\n    return true;\n  }\n}\n\n// Always include tenant in queries\nasync function getOrdersByTenant(tenantCode: string, userId: string) {\n  // Verify user has access to tenant first\n  const user = await this.userService.getUser(userId);\n  if (!user.tenantCodes.includes(tenantCode)) {\n    throw new ForbiddenException('Access denied');\n  }\n\n  // Tenant is always part of the partition key\n  return this.dataService.listItemsByPk(`ORDER#${tenantCode}`);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"resource-level-authorization",children:"Resource-Level Authorization"}),"\n",(0,s.jsx)(n.p,{children:"Check ownership before allowing operations."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"async function updateOrder(\n  orderId: string,\n  updates: UpdateOrderDto,\n  userId: string,\n): Promise<Order> {\n  const order = await this.dataService.getItem({ pk, sk });\n\n  if (!order) {\n    throw new NotFoundException('Order not found');\n  }\n\n  // Check ownership\n  if (order.createdBy !== userId && !this.isAdmin(userId)) {\n    throw new ForbiddenException('Not authorized to update this order');\n  }\n\n  return this.commandService.publishPartialUpdateSync({\n    pk: order.pk,\n    sk: order.sk,\n    version: order.version,\n    ...updates,\n  }, options);\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"data-protection",children:"Data Protection"}),"\n",(0,s.jsx)(n.h3,{id:"encrypt-sensitive-data",children:"Encrypt Sensitive Data"}),"\n",(0,s.jsx)(n.p,{children:"Encrypt sensitive data before storing."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import * as crypto from 'crypto';\n\nconst ENCRYPTION_KEY = process.env.ENCRYPTION_KEY; // 32 bytes for AES-256\nconst IV_LENGTH = 16;\n\nfunction encrypt(text: string): string {\n  const iv = crypto.randomBytes(IV_LENGTH);\n  const cipher = crypto.createCipheriv(\n    'aes-256-gcm',\n    Buffer.from(ENCRYPTION_KEY, 'hex'),\n    iv,\n  );\n\n  let encrypted = cipher.update(text, 'utf8', 'hex');\n  encrypted += cipher.final('hex');\n\n  const authTag = cipher.getAuthTag();\n\n  return `${iv.toString('hex')}:${authTag.toString('hex')}:${encrypted}`;\n}\n\nfunction decrypt(encryptedText: string): string {\n  const [ivHex, authTagHex, encrypted] = encryptedText.split(':');\n\n  const decipher = crypto.createDecipheriv(\n    'aes-256-gcm',\n    Buffer.from(ENCRYPTION_KEY, 'hex'),\n    Buffer.from(ivHex, 'hex'),\n  );\n\n  decipher.setAuthTag(Buffer.from(authTagHex, 'hex'));\n\n  let decrypted = decipher.update(encrypted, 'hex', 'utf8');\n  decrypted += decipher.final('utf8');\n\n  return decrypted;\n}\n\n// Usage\nconst sensitiveData = {\n  ssn: encrypt('123-45-6789'),\n  creditCard: encrypt('4111111111111111'),\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"mask-sensitive-data-in-logs",children:"Mask Sensitive Data in Logs"}),"\n",(0,s.jsx)(n.p,{children:"Never log sensitive information."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Create a logger that masks sensitive fields\nconst SENSITIVE_FIELDS = ['password', 'token', 'ssn', 'creditCard', 'secret'];\n\nfunction maskSensitiveData(obj: any): any {\n  if (!obj || typeof obj !== 'object') {\n    return obj;\n  }\n\n  const masked = Array.isArray(obj) ? [...obj] : { ...obj };\n\n  for (const key of Object.keys(masked)) {\n    if (SENSITIVE_FIELDS.some(field =>\n      key.toLowerCase().includes(field.toLowerCase())\n    )) {\n      masked[key] = '***MASKED***';\n    } else if (typeof masked[key] === 'object') {\n      masked[key] = maskSensitiveData(masked[key]);\n    }\n  }\n\n  return masked;\n}\n\n// Usage\nconsole.log('Request:', maskSensitiveData(requestBody));\n"})}),"\n",(0,s.jsx)(n.h3,{id:"secure-environment-variables",children:"Secure Environment Variables"}),"\n",(0,s.jsx)(n.p,{children:"Use AWS Secrets Manager for sensitive configuration."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import {\n  SecretsManagerClient,\n  GetSecretValueCommand,\n} from '@aws-sdk/client-secrets-manager';\n\nconst secretsClient = new SecretsManagerClient({});\n\nasync function getSecret(secretName: string): Promise<Record<string, string>> {\n  const command = new GetSecretValueCommand({ SecretId: secretName });\n  const response = await secretsClient.send(command);\n\n  if (response.SecretString) {\n    return JSON.parse(response.SecretString);\n  }\n\n  throw new Error('Secret not found');\n}\n\n// Cache secrets to avoid repeated API calls\nlet cachedSecrets: Record<string, string> | null = null;\n\nasync function getDatabasePassword(): Promise<string> {\n  if (!cachedSecrets) {\n    cachedSecrets = await getSecret('myapp/database');\n  }\n  return cachedSecrets.password;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"api-security",children:"API Security"}),"\n",(0,s.jsx)(n.h3,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,s.jsx)(n.p,{children:"Implement rate limiting to prevent abuse."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// API Gateway throttling in serverless.yml\nprovider:\n  apiGateway:\n    throttling:\n      burstLimit: 200\n      rateLimit: 100\n\n// Per-function throttling\nfunctions:\n  createOrder:\n    handler: handler.createOrder\n    events:\n      - http:\n          path: orders\n          method: post\n          throttling:\n            burstLimit: 10\n            rateLimit: 5\n"})}),"\n",(0,s.jsx)(n.h3,{id:"cors-configuration",children:"CORS Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Configure CORS strictly."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// serverless.yml\nprovider:\n  httpApi:\n    cors:\n      allowedOrigins:\n        - https://myapp.example.com\n        - https://admin.example.com\n      allowedHeaders:\n        - Content-Type\n        - Authorization\n        - X-Request-Id\n      allowedMethods:\n        - GET\n        - POST\n        - PUT\n        - DELETE\n        - OPTIONS\n      maxAge: 3600\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Default Implementation Note",type:"info",children:(0,s.jsxs)(n.p,{children:["The default implementation uses ",(0,s.jsx)(n.code,{children:"allowedOrigins: ['*']"})," for development convenience. For production environments, you should always restrict allowed origins to specific domains as shown above to prevent cross-site request forgery (CSRF) attacks."]})}),"\n",(0,s.jsx)(n.h3,{id:"request-size-limits",children:"Request Size Limits"}),"\n",(0,s.jsx)(n.p,{children:"Limit request payload size to prevent DoS."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// API Gateway payload limit in serverless.yml\nprovider:\n  apiGateway:\n    binaryMediaTypes:\n      - 'application/octet-stream'\n    maximumPayloadSize: 10485760  # 10MB\n\n// Application-level validation\n@Post('upload')\n@UseInterceptors(\n  FileInterceptor('file', {\n    limits: {\n      fileSize: 10 * 1024 * 1024,  // 10MB\n    },\n  }),\n)\nasync uploadFile(@UploadedFile() file: Express.Multer.File) {\n  // Process file\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"infrastructure-security",children:"Infrastructure Security"}),"\n",(0,s.jsx)(n.h3,{id:"least-privilege-iam-policies",children:"Least Privilege IAM Policies"}),"\n",(0,s.jsx)(n.p,{children:"Grant only necessary permissions to Lambda functions."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# serverless.yml\nprovider:\n  iam:\n    role:\n      statements:\n        # DynamoDB access - specific tables only\n        - Effect: Allow\n          Action:\n            - dynamodb:GetItem\n            - dynamodb:PutItem\n            - dynamodb:UpdateItem\n            - dynamodb:Query\n          Resource:\n            - !GetAtt OrderTable.Arn\n            - !Sub '${OrderTable.Arn}/index/*'\n\n        # S3 access - specific bucket and prefix\n        - Effect: Allow\n          Action:\n            - s3:GetObject\n            - s3:PutObject\n          Resource:\n            - !Sub 'arn:aws:s3:::${UploadBucket}/uploads/*'\n\n        # Secrets Manager - specific secrets only\n        - Effect: Allow\n          Action:\n            - secretsmanager:GetSecretValue\n          Resource:\n            - !Sub 'arn:aws:secretsmanager:${AWS::Region}:${AWS::AccountId}:secret:myapp/*'\n"})}),"\n",(0,s.jsx)(n.h3,{id:"vpc-configuration",children:"VPC Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Deploy Lambda functions in VPC for database access."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# serverless.yml\nprovider:\n  vpc:\n    securityGroupIds:\n      - !Ref LambdaSecurityGroup\n    subnetIds:\n      - !Ref PrivateSubnet1\n      - !Ref PrivateSubnet2\n\nresources:\n  Resources:\n    LambdaSecurityGroup:\n      Type: AWS::EC2::SecurityGroup\n      Properties:\n        GroupDescription: Lambda security group\n        VpcId: !Ref VPC\n        SecurityGroupEgress:\n          - IpProtocol: tcp\n            FromPort: 443\n            ToPort: 443\n            CidrIp: 0.0.0.0/0  # HTTPS outbound only\n          - IpProtocol: tcp\n            FromPort: 5432\n            ToPort: 5432\n            DestinationSecurityGroupId: !Ref RDSSecurityGroup\n"})}),"\n",(0,s.jsx)(n.h3,{id:"enable-aws-cloudtrail",children:"Enable AWS CloudTrail"}),"\n",(0,s.jsx)(n.p,{children:"Log all API calls for audit."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// CDK configuration\nconst trail = new cloudtrail.Trail(this, 'AuditTrail', {\n  bucket: auditBucket,\n  sendToCloudWatchLogs: true,\n  cloudWatchLogsRetention: logs.RetentionDays.ONE_YEAR,\n  includeGlobalServiceEvents: true,\n  isMultiRegionTrail: true,\n});\n\n// Log specific events\ntrail.addEventSelector(cloudtrail.DataResourceType.DYNAMODB_TABLE, [\n  `arn:aws:dynamodb:${this.region}:${this.account}:table/*`,\n]);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"security-checklist",children:"Security Checklist"}),"\n",(0,s.jsx)(n.h3,{id:"pre-deployment",children:"Pre-Deployment"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","All input is validated with class-validator"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Sensitive data is encrypted at rest"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","JWT token validation is implemented"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Role-based access control is configured"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Tenant isolation is enforced"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Rate limiting is configured"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","CORS is configured strictly"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","IAM policies follow least privilege"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Secrets are stored in Secrets Manager"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","VPC is configured for database access"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"post-deployment",children:"Post-Deployment"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","CloudTrail is enabled"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","CloudWatch alarms are configured"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Security groups are reviewed"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","API Gateway throttling is verified"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Penetration testing is completed"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./authentication",children:"Authentication"})," - Authentication setup"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./error-catalog",children:"Error Catalog"})," - Security-related errors"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./monitoring-logging",children:"Monitoring and Logging"})," - Security monitoring"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./deployment-guide",children:"Deployment Guide"})," - Secure deployment"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(6540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);