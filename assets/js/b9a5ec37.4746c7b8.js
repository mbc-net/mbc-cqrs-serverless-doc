"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[7096],{7593:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"migration/v1.1.0","title":"Migration Guide: v1.1.0","description":"Migration guide for upgrading to MBC CQRS Serverless v1.1.0, including TENANT_COMMON breaking change and tenant code normalization.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/migration/v1.1.0.md","sourceDirName":"migration","slug":"/migration/v1.1.0","permalink":"/docs/migration/v1.1.0","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"description":"Migration guide for upgrading to MBC CQRS Serverless v1.1.0, including TENANT_COMMON breaking change and tenant code normalization."},"sidebar":"tutorialSidebar","previous":{"title":"Glossary","permalink":"/docs/glossary"},"next":{"title":"Changelog","permalink":"/docs/changelog"}}');var s=t(4848),a=t(8453);const r={sidebar_position:1,description:"Migration guide for upgrading to MBC CQRS Serverless v1.1.0, including TENANT_COMMON breaking change and tenant code normalization."},d="Migration Guide: v1.1.0",o={},c=[{value:"Release Date",id:"release-date",level:2},{value:"Breaking Changes Summary",id:"breaking-changes-summary",level:2},{value:"Pre-Migration Checklist",id:"pre-migration-checklist",level:2},{value:"Breaking Change 1: TENANT_COMMON Value",id:"breaking-change-1-tenant_common-value",level:2},{value:"What Changed",id:"what-changed",level:3},{value:"Impact",id:"impact",level:3},{value:"Migration Steps",id:"migration-steps",level:3},{value:"Step 1: Identify Affected Data",id:"step-1-identify-affected-data",level:4},{value:"Step 2: Create Migration Script",id:"step-2-create-migration-script",level:4},{value:"Step 3: Run Migration",id:"step-3-run-migration",level:4},{value:"Step 4: Verify Migration",id:"step-4-verify-migration",level:4},{value:"Breaking Change 2: Tenant Code Normalization",id:"breaking-change-2-tenant-code-normalization",level:2},{value:"What Changed",id:"what-changed-1",level:3},{value:"Impact",id:"impact-1",level:3},{value:"Migration Strategy",id:"migration-strategy",level:3},{value:"Breaking Change 3: Deprecated Methods Removed",id:"breaking-change-3-deprecated-methods-removed",level:2},{value:"What Changed",id:"what-changed-2",level:3},{value:"Migration Steps",id:"migration-steps-1",level:3},{value:"CommandService Methods",id:"commandservice-methods",level:4},{value:"SequencesService Methods",id:"sequencesservice-methods",level:4},{value:"Why These Methods Were Removed",id:"why-these-methods-were-removed",level:3},{value:"New Features in v1.1.0",id:"new-features-in-v110",level:2},{value:"Utility Functions",id:"utility-functions",level:3},{value:"Improved Test Coverage",id:"improved-test-coverage",level:3},{value:"Upgrade Steps",id:"upgrade-steps",level:2},{value:"Step 1: Update Dependencies",id:"step-1-update-dependencies",level:3},{value:"Step 2: Run Data Migration",id:"step-2-run-data-migration",level:3},{value:"Step 3: Update Code (if necessary)",id:"step-3-update-code-if-necessary",level:3},{value:"Step 4: Test",id:"step-4-test",level:3},{value:"Rollback Procedure",id:"rollback-procedure",level:2},{value:"FAQ",id:"faq",level:2},{value:"Q: Can I skip the migration if I don&#39;t use common tenant?",id:"q-can-i-skip-the-migration-if-i-dont-use-common-tenant",level:3},{value:"Q: How long does the migration take?",id:"q-how-long-does-the-migration-take",level:3},{value:"Q: Can I run the migration while the application is running?",id:"q-can-i-run-the-migration-while-the-application-is-running",level:3},{value:"Support",id:"support",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"migration-guide-v110",children:"Migration Guide: v1.1.0"})}),"\n",(0,s.jsx)(n.p,{children:"This guide helps you upgrade from v1.0.x to v1.1.0. Version 1.1.0 includes breaking changes related to tenant code handling that require data migration."}),"\n",(0,s.jsx)(n.h2,{id:"release-date",children:"Release Date"}),"\n",(0,s.jsx)(n.p,{children:"2026-02-03"}),"\n",(0,s.jsx)(n.h2,{id:"breaking-changes-summary",children:"Breaking Changes Summary"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Change"}),(0,s.jsx)(n.th,{children:"Impact"}),(0,s.jsx)(n.th,{children:"Action Required"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"TENANT_COMMON"})," value changed to ",(0,s.jsx)(n.code,{children:"'common'"})]}),(0,s.jsxs)(n.td,{children:["Partition keys changed from ",(0,s.jsx)(n.code,{children:"TENANT#COMMON"})," to ",(0,s.jsx)(n.code,{children:"TENANT#common"})]}),(0,s.jsx)(n.td,{children:"Data migration required"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Tenant code normalization"}),(0,s.jsx)(n.td,{children:"All tenant codes normalized to lowercase"}),(0,s.jsx)(n.td,{children:"Data migration may be required"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Deprecated methods removed"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"publish()"}),", ",(0,s.jsx)(n.code,{children:"publishPartialUpdate()"}),", ",(0,s.jsx)(n.code,{children:"genNewSequence()"})," removed"]}),(0,s.jsx)(n.td,{children:"Update method calls"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"pre-migration-checklist",children:"Pre-Migration Checklist"}),"\n",(0,s.jsx)(n.p,{children:"Before upgrading, verify the following:"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Backup your DynamoDB tables"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Identify all tables using ",(0,s.jsx)(n.code,{children:"TENANT#COMMON"})," partition keys"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Identify all tables using uppercase tenant codes in partition keys"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Plan a maintenance window for the migration"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Test the migration in a non-production environment first"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"breaking-change-1-tenant_common-value",children:"Breaking Change 1: TENANT_COMMON Value"}),"\n",(0,s.jsx)(n.h3,{id:"what-changed",children:"What Changed"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"SettingTypeEnum.TENANT_COMMON"})," enum value changed:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Before (v1.0.x)\nexport enum SettingTypeEnum {\n  TENANT_COMMON = 'COMMON',  // Uppercase\n  // ...\n}\n\n// After (v1.1.0)\nexport enum SettingTypeEnum {\n  TENANT_COMMON = 'common',  // Lowercase\n  // ...\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"impact",children:"Impact"}),"\n",(0,s.jsx)(n.p,{children:"This affects partition keys in DynamoDB:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Table"}),(0,s.jsx)(n.th,{children:"Before"}),(0,s.jsx)(n.th,{children:"After"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Tenant settings"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"TENANT#COMMON"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"TENANT#common"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Master settings"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"MASTER_SETTING#COMMON#..."})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"MASTER_SETTING#common#..."})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Master data"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"MASTER_DATA#COMMON#..."})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"MASTER_DATA#common#..."})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"migration-steps",children:"Migration Steps"}),"\n",(0,s.jsx)(n.h4,{id:"step-1-identify-affected-data",children:"Step 1: Identify Affected Data"}),"\n",(0,s.jsxs)(n.p,{children:["Run a scan to find all items with ",(0,s.jsx)(n.code,{children:"COMMON"})," in partition keys:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Using AWS CLI\naws dynamodb scan \\\n  --table-name YOUR_TABLE_NAME \\\n  --filter-expression "contains(pk, :common)" \\\n  --expression-attribute-values \'{":common":{"S":"COMMON"}}\' \\\n  --output json > common_tenant_items.json\n'})}),"\n",(0,s.jsx)(n.h4,{id:"step-2-create-migration-script",children:"Step 2: Create Migration Script"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// scripts/migrate-tenant-common.ts\nimport {\n  DynamoDBClient,\n  ScanCommand,\n  TransactWriteItemsCommand,\n} from '@aws-sdk/client-dynamodb';\n\nconst client = new DynamoDBClient({});\nconst TABLE_NAME = process.env.DATA_TABLE_NAME || 'your-table-name';\n\nasync function migrateCommonTenant() {\n  console.log('Starting TENANT_COMMON migration...');\n\n  // Scan for items with COMMON in pk\n  const scanResult = await client.send(new ScanCommand({\n    TableName: TABLE_NAME,\n    FilterExpression: 'contains(pk, :common)',\n    ExpressionAttributeValues: {\n      ':common': { S: 'COMMON' },\n    },\n  }));\n\n  const items = scanResult.Items || [];\n  console.log(`Found ${items.length} items to migrate`);\n\n  // Process in batches of 25 (DynamoDB limit)\n  for (let i = 0; i < items.length; i += 25) {\n    const batch = items.slice(i, i + 25);\n    const transactItems = [];\n\n    for (const item of batch) {\n      const oldPk = item.pk.S!;\n      const newPk = oldPk.replace(/COMMON/g, 'common');\n\n      // Delete old item\n      transactItems.push({\n        Delete: {\n          TableName: TABLE_NAME,\n          Key: {\n            pk: { S: oldPk },\n            sk: item.sk,\n          },\n        },\n      });\n\n      // Create new item with lowercase pk\n      const newItem = { ...item, pk: { S: newPk } };\n      // Update tenantCode if present\n      if (newItem.tenantCode?.S === 'COMMON') {\n        newItem.tenantCode = { S: 'common' };\n      }\n\n      transactItems.push({\n        Put: {\n          TableName: TABLE_NAME,\n          Item: newItem,\n        },\n      });\n    }\n\n    await client.send(new TransactWriteItemsCommand({\n      TransactItems: transactItems,\n    }));\n\n    console.log(`Migrated batch ${Math.floor(i / 25) + 1}`);\n  }\n\n  console.log('Migration complete!');\n}\n\nmigrateCommonTenant().catch(console.error);\n"})}),"\n",(0,s.jsx)(n.h4,{id:"step-3-run-migration",children:"Step 3: Run Migration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Set environment variables\nexport DATA_TABLE_NAME=your-table-name\nexport AWS_REGION=ap-northeast-1\n\n# Run migration (dry run first)\nnpx ts-node scripts/migrate-tenant-common.ts\n"})}),"\n",(0,s.jsx)(n.h4,{id:"step-4-verify-migration",children:"Step 4: Verify Migration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Verify no items with uppercase COMMON remain\naws dynamodb scan \\\n  --table-name YOUR_TABLE_NAME \\\n  --filter-expression "contains(pk, :common)" \\\n  --expression-attribute-values \'{":common":{"S":"#COMMON"}}\' \\\n  --select COUNT\n'})}),"\n",(0,s.jsx)(n.h2,{id:"breaking-change-2-tenant-code-normalization",children:"Breaking Change 2: Tenant Code Normalization"}),"\n",(0,s.jsx)(n.h3,{id:"what-changed-1",children:"What Changed"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"getUserContext()"})," function now normalizes tenant codes to lowercase:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Before (v1.0.x)\nconst ctx = getUserContext(invokeContext);\nconsole.log(ctx.tenantCode); // "MY_TENANT" (as stored in Cognito)\n\n// After (v1.1.0)\nconst ctx = getUserContext(invokeContext);\nconsole.log(ctx.tenantCode); // "my_tenant" (normalized to lowercase)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"impact-1",children:"Impact"}),"\n",(0,s.jsx)(n.p,{children:"If your existing data uses uppercase tenant codes in partition keys, queries will fail to find that data."}),"\n",(0,s.jsx)(n.h3,{id:"migration-strategy",children:"Migration Strategy"}),"\n",(0,s.jsxs)(n.p,{children:["See the detailed migration guide: ",(0,s.jsx)(n.a,{href:"/docs/data-migration-patterns#tenant-code-normalization-migration",children:"Tenant Code Normalization Migration"})]}),"\n",(0,s.jsx)(n.p,{children:"Key options:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Strategy 1: Update DynamoDB Data"})," - Migrate existing data to use lowercase tenant codes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Strategy 2: Custom Normalization"})," - Override normalization behavior (not recommended for new projects)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Strategy 3: Gradual Migration"})," - Use dual-read pattern during transition"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"breaking-change-3-deprecated-methods-removed",children:"Breaking Change 3: Deprecated Methods Removed"}),"\n",(0,s.jsx)(n.h3,{id:"what-changed-2",children:"What Changed"}),"\n",(0,s.jsx)(n.p,{children:"The following deprecated methods have been removed in v1.1.0:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Package"}),(0,s.jsx)(n.th,{children:"Removed Method"}),(0,s.jsx)(n.th,{children:"Replacement"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"@mbc-cqrs-serverless/core"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CommandService.publish()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CommandService.publishAsync()"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"@mbc-cqrs-serverless/core"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CommandService.publishPartialUpdate()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CommandService.publishPartialUpdateAsync()"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"@mbc-cqrs-serverless/sequence"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"SequencesService.genNewSequence()"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"SequencesService.generateSequenceItem()"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"migration-steps-1",children:"Migration Steps"}),"\n",(0,s.jsx)(n.h4,{id:"commandservice-methods",children:"CommandService Methods"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Before (v1.0.x)\nconst item = await this.commandService.publish(input, opts);\nconst updated = await this.commandService.publishPartialUpdate(partialInput, opts);\n\n// After (v1.1.0)\nconst item = await this.commandService.publishAsync(input, opts);\nconst updated = await this.commandService.publishPartialUpdateAsync(partialInput, opts);\n"})}),"\n",(0,s.jsx)(n.h4,{id:"sequencesservice-methods",children:"SequencesService Methods"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Before (v1.0.x)\nconst sequence = await this.sequencesService.genNewSequence(dto, opts);\n\n// After (v1.1.0)\nconst sequence = await this.sequencesService.generateSequenceItem(dto, opts);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"why-these-methods-were-removed",children:"Why These Methods Were Removed"}),"\n",(0,s.jsx)(n.p,{children:"These methods were deprecated because:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:[(0,s.jsx)(n.code,{children:"publish()"})," / ",(0,s.jsx)(n.code,{children:"publishPartialUpdate()"})]}),": The naming was ambiguous. The ",(0,s.jsx)(n.code,{children:"Async"})," suffix clarifies that these methods use DynamoDB Streams for asynchronous data synchronization."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"genNewSequence()"})}),": The method was replaced by ",(0,s.jsx)(n.code,{children:"generateSequenceItem()"})," which provides a more consistent API and better return type."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"new-features-in-v110",children:"New Features in v1.1.0"}),"\n",(0,s.jsx)(n.h3,{id:"utility-functions",children:"Utility Functions"}),"\n",(0,s.jsx)(n.p,{children:"New utility functions are available for tenant code handling:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import {\n  normalizeTenantCode,\n  isCommonTenant,\n} from '@mbc-cqrs-serverless/core';\n\n// Normalize a tenant code\nconst normalized = normalizeTenantCode('MY_TENANT'); // \"my_tenant\"\n\n// Check if tenant is common\nconst isCommon = isCommonTenant('common'); // true\nconst isCommon2 = isCommonTenant('COMMON'); // true (case-insensitive)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"improved-test-coverage",children:"Improved Test Coverage"}),"\n",(0,s.jsx)(n.p,{children:"v1.1.0 includes comprehensive tests for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"TenantService methods (17 new tests)"}),"\n",(0,s.jsx)(n.li,{children:"SettingTypeEnum validation (7 new tests)"}),"\n",(0,s.jsx)(n.li,{children:"Tenant code normalization (70+ test cases)"}),"\n",(0,s.jsx)(n.li,{children:"Tenant normalization commands (30+ test cases)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"upgrade-steps",children:"Upgrade Steps"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-update-dependencies",children:"Step 1: Update Dependencies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install @mbc-cqrs-serverless/core@1.1.0\nnpm install @mbc-cqrs-serverless/tenant@1.1.0\nnpm install @mbc-cqrs-serverless/master@1.1.0\n# Update other packages as needed\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-run-data-migration",children:"Step 2: Run Data Migration"}),"\n",(0,s.jsx)(n.p,{children:"Follow the migration steps above for:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"TENANT_COMMON"})," partition key changes"]}),"\n",(0,s.jsx)(n.li,{children:"Tenant code normalization (if applicable)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-3-update-code-if-necessary",children:"Step 3: Update Code (if necessary)"}),"\n",(0,s.jsxs)(n.p,{children:["If you have hardcoded ",(0,s.jsx)(n.code,{children:"'COMMON'"})," strings, update them:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// Before\nconst pk = `TENANT#COMMON`;\n\n// After\nimport { SettingTypeEnum } from '@mbc-cqrs-serverless/tenant';\nconst pk = `TENANT#${SettingTypeEnum.TENANT_COMMON}`;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-4-test",children:"Step 4: Test"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Run your test suite\nnpm test\n\n# Test in staging environment\nnpm run deploy:stg\n"})}),"\n",(0,s.jsx)(n.h2,{id:"rollback-procedure",children:"Rollback Procedure"}),"\n",(0,s.jsx)(n.p,{children:"If you need to rollback to v1.0.x:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Restore DynamoDB tables from backup"}),"\n",(0,s.jsxs)(n.li,{children:["Downgrade packages:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install @mbc-cqrs-serverless/core@1.0.26\n# etc.\n"})}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Redeploy application"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"faq",children:"FAQ"}),"\n",(0,s.jsx)(n.h3,{id:"q-can-i-skip-the-migration-if-i-dont-use-common-tenant",children:"Q: Can I skip the migration if I don't use common tenant?"}),"\n",(0,s.jsxs)(n.p,{children:["If you never use the common tenant feature (shared resources across all tenants), you may not need to migrate ",(0,s.jsx)(n.code,{children:"TENANT_COMMON"})," data. However, you should still review tenant code normalization impact."]}),"\n",(0,s.jsx)(n.h3,{id:"q-how-long-does-the-migration-take",children:"Q: How long does the migration take?"}),"\n",(0,s.jsx)(n.p,{children:"Migration time depends on data volume. Estimate approximately:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"1,000 items: ~1 minute"}),"\n",(0,s.jsx)(n.li,{children:"10,000 items: ~5-10 minutes"}),"\n",(0,s.jsx)(n.li,{children:"100,000 items: ~30-60 minutes"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"q-can-i-run-the-migration-while-the-application-is-running",children:"Q: Can I run the migration while the application is running?"}),"\n",(0,s.jsx)(n.p,{children:"We recommend performing migration during a maintenance window to avoid race conditions. If zero-downtime is required, use the gradual migration strategy with dual-read pattern."}),"\n",(0,s.jsx)(n.h2,{id:"support",children:"Support"}),"\n",(0,s.jsx)(n.p,{children:"If you encounter issues during migration:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/mbc-net/mbc-cqrs-serverless/issues",children:"GitHub Issues"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://mbc-cqrs-serverless.mbc-net.com",children:"Documentation"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/changelog#v110",children:"Changelog v1.1.0"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/data-migration-patterns",children:"Data Migration Patterns"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/data-migration-patterns#tenant-code-normalization-migration",children:"Tenant Code Normalization Migration"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>d});var i=t(6540);const s={},a=i.createContext(s);function r(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);