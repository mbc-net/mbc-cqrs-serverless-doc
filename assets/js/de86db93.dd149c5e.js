"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[4386],{1543:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"configuring","title":"Configuring","description":"Configuration guide for MBC CQRS Serverless framework including TypeScript, ESLint, and project settings.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/configuring.md","sourceDirName":".","slug":"/configuring","permalink":"/docs/configuring","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"description":"Configuration guide for MBC CQRS Serverless framework including TypeScript, ESLint, and project settings."},"sidebar":"tutorialSidebar","previous":{"title":"Monitoring and Logging","permalink":"/docs/monitoring-logging"},"next":{"title":"Environment Variables","permalink":"/docs/environment-variables"}}');var t=r(4848),i=r(8453),s=r(4795);const a={sidebar_position:9,description:"Configuration guide for MBC CQRS Serverless framework including TypeScript, ESLint, and project settings."},l="Configuring",c={},d=[{value:"Project Configuration",id:"project-configuration",level:2},{value:"serverless.yml",id:"serverlessyml",level:3},{value:"NestJS Configuration",id:"nestjs-configuration",level:3},{value:"TypeScript Configuration",id:"typescript-configuration",level:2},{value:"tsconfig.json",id:"tsconfigjson",level:3},{value:"ESLint Configuration",id:"eslint-configuration",level:2},{value:".eslintrc.js",id:"eslintrcjs",level:3},{value:"Module Configuration",id:"module-configuration",level:2},{value:"CommandModule Options",id:"commandmodule-options",level:3},{value:"SequenceModule Options",id:"sequencemodule-options",level:3},{value:"TenantModule Options",id:"tenantmodule-options",level:3},{value:"NotificationModule",id:"notificationmodule",level:3},{value:"Logging Configuration",id:"logging-configuration",level:2},{value:"Configure Logger",id:"configure-logger",level:3},{value:"Validation Configuration",id:"validation-configuration",level:2},{value:"Global Validation Pipe",id:"global-validation-pipe",level:3},{value:"CORS Configuration",id:"cors-configuration",level:2},{value:"Configure CORS",id:"configure-cors",level:3},{value:"Stage-Specific Configuration",id:"stage-specific-configuration",level:2},{value:"Environment-Based Settings",id:"environment-based-settings",level:3},{value:"See Also",id:"see-also",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"configuring",children:"Configuring"})}),"\n",(0,t.jsx)(n.p,{children:"MBC CQRS serverless framework allows you to customize your project to meet specific requirements. This guide covers all configuration options available in the framework."}),"\n",(0,t.jsx)(n.h2,{id:"project-configuration",children:"Project Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"serverlessyml",children:"serverless.yml"}),"\n",(0,t.jsx)(n.p,{children:"The main configuration file for your serverless application."}),"\n",(0,t.jsx)(n.admonition,{title:"Table Prefix",type:"info",children:(0,t.jsxs)(n.p,{children:["The framework generates DynamoDB table prefixes automatically using ",(0,t.jsx)(n.code,{children:"NODE_ENV"})," and ",(0,t.jsx)(n.code,{children:"APP_NAME"})," environment variables. The format is ",(0,t.jsx)(n.code,{children:"{NODE_ENV}-{APP_NAME}-{tableName}"}),". For example, with ",(0,t.jsx)(n.code,{children:"NODE_ENV=dev"})," and ",(0,t.jsx)(n.code,{children:"APP_NAME=my-app"}),", a command table would be named ",(0,t.jsx)(n.code,{children:"dev-my-app-command"}),"."]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"service: my-app\n\nframeworkVersion: '3'\n\nplugins:\n  - serverless-offline\n  - serverless-plugin-typescript\n  - serverless-dynamodb-local\n\nprovider:\n  name: aws\n  runtime: nodejs18.x\n  stage: ${opt:stage, 'dev'}\n  region: ${opt:region, 'ap-northeast-1'}\n  memorySize: 512\n  timeout: 30\n\n  environment:\n    NODE_ENV: ${self:provider.stage}\n    APP_NAME: ${self:service}\n    COGNITO_USER_POOL_ID: ${env:COGNITO_USER_POOL_ID}\n    COGNITO_CLIENT_ID: ${env:COGNITO_CLIENT_ID}\n\n  iam:\n    role:\n      statements:\n        - Effect: Allow\n          Action:\n            - dynamodb:Query\n            - dynamodb:Scan\n            - dynamodb:GetItem\n            - dynamodb:PutItem\n            - dynamodb:UpdateItem\n            - dynamodb:DeleteItem\n          Resource:\n            - !GetAtt CommandTable.Arn\n            - !GetAtt DataTable.Arn\n\ncustom:\n  serverless-offline:\n    httpPort: 3000\n    lambdaPort: 3002\n\n  dynamodb:\n    stages:\n      - dev\n    start:\n      port: 8000\n      inMemory: true\n      migrate: true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"nestjs-configuration",children:"NestJS Configuration"}),"\n",(0,t.jsx)(n.p,{children:"Configure NestJS modules in your application."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// app.module.ts\nimport { Module } from '@nestjs/common';\nimport { ConfigModule } from '@nestjs/config';\nimport { CommandModule } from '@mbc-cqrs-serverless/core';\n\n@Module({\n  imports: [\n    // Load environment variables\n    ConfigModule.forRoot({\n      isGlobal: true,\n      envFilePath: ['.env.local', '.env'],\n    }),\n\n    // Configure Command Module\n    CommandModule.register({\n      tableName: process.env.DYNAMODB_TABLE_NAME,\n      dataSyncHandlers: [],\n    }),\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"typescript-configuration",children:"TypeScript Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"tsconfigjson",children:"tsconfig.json"}),"\n",(0,t.jsx)(n.p,{children:"Recommended TypeScript configuration for MBC CQRS Serverless projects."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "compilerOptions": {\n    "module": "commonjs",\n    "target": "ES2021",\n    "lib": ["ES2021"],\n    "declaration": true,\n    "strict": true,\n    "noImplicitAny": true,\n    "strictNullChecks": true,\n    "noImplicitThis": true,\n    "alwaysStrict": true,\n    "noUnusedLocals": false,\n    "noUnusedParameters": false,\n    "noImplicitReturns": true,\n    "noFallthroughCasesInSwitch": false,\n    "inlineSourceMap": true,\n    "inlineSources": true,\n    "experimentalDecorators": true,\n    "emitDecoratorMetadata": true,\n    "skipLibCheck": true,\n    "esModuleInterop": true,\n    "resolveJsonModule": true,\n    "baseUrl": ".",\n    "paths": {\n      "@/*": ["src/*"],\n      "@shared/*": ["src/shared/*"]\n    },\n    "outDir": "./dist"\n  },\n  "include": ["src/**/*"],\n  "exclude": ["node_modules", "dist"]\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"eslint-configuration",children:"ESLint Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"eslintrcjs",children:".eslintrc.js"}),"\n",(0,t.jsx)(n.p,{children:"Recommended ESLint configuration."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\n  parser: '@typescript-eslint/parser',\n  parserOptions: {\n    project: 'tsconfig.json',\n    sourceType: 'module',\n  },\n  plugins: ['@typescript-eslint/eslint-plugin'],\n  extends: [\n    'plugin:@typescript-eslint/recommended',\n    'plugin:prettier/recommended',\n  ],\n  root: true,\n  env: {\n    node: true,\n    jest: true,\n  },\n  ignorePatterns: ['.eslintrc.js', 'dist', 'node_modules'],\n  rules: {\n    '@typescript-eslint/interface-name-prefix': 'off',\n    '@typescript-eslint/explicit-function-return-type': 'off',\n    '@typescript-eslint/explicit-module-boundary-types': 'off',\n    '@typescript-eslint/no-explicit-any': 'warn',\n    '@typescript-eslint/no-unused-vars': ['warn', { argsIgnorePattern: '^_' }],\n  },\n};\n"})}),"\n",(0,t.jsx)(n.h2,{id:"module-configuration",children:"Module Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"commandmodule-options",children:"CommandModule Options"}),"\n",(0,t.jsx)(n.p,{children:"Configure the core CommandModule."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common';\nimport { CommandModule } from '@mbc-cqrs-serverless/core';\n\n@Module({\n  imports: [\n    CommandModule.register({\n      // Required: DynamoDB table name\n      tableName: 'order',\n\n      // Optional: Data sync handlers for RDS synchronization\n      dataSyncHandlers: [OrderRdsSyncHandler],\n\n      // Optional: Reserved for future use (not yet implemented)\n      skipError: false,\n\n      // Optional: Disable default DynamoDB data sync handler\n      disableDefaultHandler: false,\n    }),\n  ],\n})\nexport class OrderModule {}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"sequencemodule-options",children:"SequenceModule Options"}),"\n",(0,t.jsx)(n.p,{children:"Configure auto-incrementing sequences."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common';\nimport { SequenceModule } from '@mbc-cqrs-serverless/sequence';\n\n@Module({\n  imports: [\n    SequenceModule.register({\n      // Optional: Enable or disable default sequence controller\n      enableController: true,\n    }),\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Note: Rotation strategy (day, month, year, fiscal_yearly, none) is configured through master data settings, not module options. See the ",(0,t.jsx)(n.a,{href:"./sequence",children:"Sequence documentation"})," for details."]}),"\n",(0,t.jsx)(n.h3,{id:"tenantmodule-options",children:"TenantModule Options"}),"\n",(0,t.jsx)(n.p,{children:"Configure multi-tenant support."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common';\nimport { TenantModule } from '@mbc-cqrs-serverless/tenant';\n\n@Module({\n  imports: [\n    TenantModule.register({\n      // Optional: Enable or disable default tenant controller\n      enableController: true,\n\n      // Optional: Data sync handlers for RDS synchronization\n      dataSyncHandlers: [TenantRdsSyncHandler],\n    }),\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"notificationmodule",children:"NotificationModule"}),"\n",(0,t.jsx)(n.p,{children:"Configure email notifications via environment variables."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { Module } from '@nestjs/common';\nimport { NotificationModule } from '@mbc-cqrs-serverless/core';\n\n@Module({\n  imports: [\n    // NotificationModule is a global module - just import it\n    NotificationModule,\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,t.jsx)(n.p,{children:"NotificationModule is configured through environment variables:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Required: Default sender email address\nSES_FROM_EMAIL=noreply@example.com\n\n# Optional: AWS SES endpoint (for local development)\nSES_ENDPOINT=http://localhost:4566\n\n# Optional: AWS SES region\nSES_REGION=ap-northeast-1\n"})}),"\n",(0,t.jsx)(n.h2,{id:"logging-configuration",children:"Logging Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"configure-logger",children:"Configure Logger"}),"\n",(0,t.jsx)(n.p,{children:"Set up structured logging for production."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { Logger } from '@nestjs/common';\n\n// Configure log level based on environment\nconst LOG_LEVELS = {\n  production: ['error', 'warn', 'log'],\n  development: ['error', 'warn', 'log', 'debug', 'verbose'],\n  test: ['error', 'warn'],\n};\n\n// In main.ts or bootstrap\nconst app = await NestFactory.create(AppModule, {\n  logger: LOG_LEVELS[process.env.NODE_ENV] || LOG_LEVELS.development,\n});\n\n// Structured logging in services\n@Injectable()\nexport class OrderService {\n  private readonly logger = new Logger(OrderService.name);\n\n  async createOrder(dto: CreateOrderDto): Promise<Order> {\n    this.logger.log({\n      message: 'Creating order',\n      code: dto.code,\n      tenantCode: dto.tenantCode,\n    });\n\n    // ... implementation\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"validation-configuration",children:"Validation Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"global-validation-pipe",children:"Global Validation Pipe"}),"\n",(0,t.jsx)(n.p,{children:"Configure validation for all endpoints."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { ValidationPipe } from '@nestjs/common';\n\n// In main.ts or bootstrap\napp.useGlobalPipes(\n  new ValidationPipe({\n    // Transform payloads to DTO instances\n    transform: true,\n\n    // Strip properties not in DTO\n    whitelist: true,\n\n    // Throw error for extra properties\n    forbidNonWhitelisted: true,\n\n    // Transform primitive types\n    transformOptions: {\n      enableImplicitConversion: true,\n    },\n\n    // Custom error messages\n    exceptionFactory: (errors) => {\n      const messages = errors.map(error => ({\n        field: error.property,\n        errors: Object.values(error.constraints || {}),\n      }));\n      return new BadRequestException({\n        message: 'Validation failed',\n        errors: messages,\n      });\n    },\n  }),\n);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"cors-configuration",children:"CORS Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"configure-cors",children:"Configure CORS"}),"\n",(0,t.jsx)(n.p,{children:"Set up Cross-Origin Resource Sharing."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// In main.ts\napp.enableCors({\n  origin: process.env.ALLOWED_ORIGINS?.split(',') || [\n    'http://localhost:3000',\n  ],\n  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS'],\n  allowedHeaders: ['Content-Type', 'Authorization', 'X-Request-Id'],\n  credentials: true,\n  maxAge: 3600,\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"stage-specific-configuration",children:"Stage-Specific Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"environment-based-settings",children:"Environment-Based Settings"}),"\n",(0,t.jsx)(n.p,{children:"Configure different settings per environment."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// config/configuration.ts\nexport default () => ({\n  stage: process.env.STAGE || 'dev',\n\n  database: {\n    tablePrefix: `myapp-${process.env.STAGE}`,\n    commandTable: `myapp-${process.env.STAGE}-command`,\n    dataTable: `myapp-${process.env.STAGE}-data`,\n  },\n\n  aws: {\n    region: process.env.AWS_REGION || 'ap-northeast-1',\n    dynamodbEndpoint: process.env.DYNAMODB_ENDPOINT, // For local dev\n  },\n\n  auth: {\n    userPoolId: process.env.COGNITO_USER_POOL_ID,\n    clientId: process.env.COGNITO_CLIENT_ID,\n  },\n\n  features: {\n    enableDebugLogs: process.env.STAGE === 'dev',\n    enableMetrics: process.env.STAGE === 'prod',\n  },\n});\n\n// Usage\nimport { ConfigService } from '@nestjs/config';\n\n@Injectable()\nexport class AppService {\n  constructor(private configService: ConfigService) {}\n\n  getTableName(): string {\n    return this.configService.get<string>('database.commandTable');\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n","\n",(0,t.jsx)(s.A,{}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"./environment-variables",children:"Environment Variables"})," - Environment configuration"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"./absolute_imports_and_module_path_aliases",children:"Absolute Imports"})," - Path aliases"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"./deployment-guide",children:"Deployment Guide"})," - Deployment configuration"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},4795:(e,n,r)=>{r.d(n,{A:()=>y});r(6540);var o=r(4164),t=r(4718),i=r(8774),s=r(5846),a=r(6654),l=r(1312),c=r(1107);const d={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};var u=r(4848);function p({className:e,href:n,children:r}){return(0,u.jsx)(i.A,{href:n,className:(0,o.A)("card padding--lg",d.cardContainer,e),children:r})}function m({className:e,href:n,icon:r,title:t,description:i}){return(0,u.jsxs)(p,{href:n,className:e,children:[(0,u.jsxs)(c.A,{as:"h2",className:(0,o.A)("text--truncate",d.cardTitle),title:t,children:[r," ",t]}),i&&(0,u.jsx)("p",{className:(0,o.A)("text--truncate",d.cardDescription),title:i,children:i})]})}function g({item:e}){const n=(0,t.Nr)(e),r=function(){const{selectMessage:e}=(0,s.W)();return n=>e(n,(0,l.T)({message:"1 item|{count} items",id:"theme.docs.DocCard.categoryDescription.plurals",description:"The default description for a category card in the generated index about how many items this category includes"},{count:n}))}();return n?(0,u.jsx)(m,{className:e.className,href:n,icon:"\ud83d\uddc3\ufe0f",title:e.label,description:e.description??r(e.items.length)}):null}function f({item:e}){const n=(0,a.A)(e.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",r=(0,t.cC)(e.docId??void 0);return(0,u.jsx)(m,{className:e.className,href:e.href,icon:n,title:e.label,description:e.description??r?.description})}function h({item:e}){switch(e.type){case"link":return(0,u.jsx)(f,{item:e});case"category":return(0,u.jsx)(g,{item:e});default:throw new Error(`unknown item type ${JSON.stringify(e)}`)}}const v={docCardListItem:"docCardListItem_W1sv"};function j({className:e}){const n=(0,t.a4)();return(0,u.jsx)(y,{items:n,className:e})}function x({item:e}){return(0,u.jsx)("article",{className:(0,o.A)(v.docCardListItem,"col col--6"),children:(0,u.jsx)(h,{item:e})})}function y(e){const{items:n,className:r}=e;if(!n)return(0,u.jsx)(j,{...e});const i=(0,t.d1)(n);return(0,u.jsx)("section",{className:(0,o.A)("row",r),children:i.map(((e,n)=>(0,u.jsx)(x,{item:e},n)))})}},5846:(e,n,r)=>{r.d(n,{W:()=>c});var o=r(6540),t=r(4586);const i=["zero","one","two","few","many","other"];function s(e){return i.filter((n=>e.includes(n)))}const a={locale:"en",pluralForms:s(["one","other"]),select:e=>1===e?"one":"other"};function l(){const{i18n:{currentLocale:e}}=(0,t.A)();return(0,o.useMemo)((()=>{try{return function(e){const n=new Intl.PluralRules(e);return{locale:e,pluralForms:s(n.resolvedOptions().pluralCategories),select:e=>n.select(e)}}(e)}catch(n){return console.error(`Failed to use Intl.PluralRules for locale "${e}".\nDocusaurus will fallback to the default (English) implementation.\nError: ${n.message}\n`),a}}),[e])}function c(){const e=l();return{selectMessage:(n,r)=>function(e,n,r){const o=e.split("|");if(1===o.length)return o[0];o.length>r.pluralForms.length&&console.error(`For locale=${r.locale}, a maximum of ${r.pluralForms.length} plural forms are expected (${r.pluralForms.join(",")}), but the message contains ${o.length}: ${e}`);const t=r.select(n),i=r.pluralForms.indexOf(t);return o[Math.min(i,o.length-1)]}(r,n,e)}}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>a});var o=r(6540);const t={},i=o.createContext(t);function s(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);