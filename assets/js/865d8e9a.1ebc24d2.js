"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[6273],{4247:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"prisma","title":"Prisma","description":"Prisma related recipes.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/prisma.md","sourceDirName":".","slug":"/prisma","permalink":"/docs/prisma","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"description":"Prisma related recipes."},"sidebar":"tutorialSidebar","previous":{"title":"Database Selection Guide","permalink":"/docs/database-selection-guide"},"next":{"title":"Frontend Project Structure","permalink":"/docs/frontend-project-structure"}}');var r=t(4848),s=t(8453);const i={description:"Prisma related recipes."},o="Prisma",d={},c=[{value:"Design table convention",id:"design-table-convention",level:2}];function l(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"prisma",children:"Prisma"})}),"\n",(0,r.jsx)(n.p,{children:"In MBC CQRS serverless, we use prisma as an ORM. It helps developers more productive when working with databases."}),"\n",(0,r.jsx)(n.p,{children:"A common scenario when working with Prisma is needing to make changes to the database, such as creating tables, updating fields in tables, etc. Follow these steps:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Update prisma/schema.prisma file."}),"\n",(0,r.jsxs)(n.li,{children:["For local development, create and apply migrations with command npm run migrate",":dev","."]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsxs)(n.p,{children:["For local development, please make sure to set the correct ",(0,r.jsx)(n.code,{children:"DATABASE_URL"})," environment variable."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Example\nDATABASE_URL="postgresql://root:RootCqrs@localhost:5432/cqrs?schema=public"\n'})})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["You could view ",(0,r.jsx)(n.a,{href:"https://www.prisma.io/docs/orm/prisma-client",children:"prisma-client documentation"})," for more information"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"design-table-convention",children:"Design table convention"}),"\n",(0,r.jsx)(n.p,{children:"When creating an RDS table that maps to a DynamoDB table, ensure you add the necessary fields and indexes to the RDS table accordingly."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'id         String   @id\ncpk        String // Command PK\ncsk        String // Command SK\npk         String // Data PK\nsk         String // Data SK\ntenantCode String   @map("tenant_code") // Tenant code\nseq        Int      @default(0) // Sort order, uses sequence feature\ncode       String // Record code\nname       String // Record name\nversion    Int // Version\nisDeleted  Boolean  @default(false) @map("is_deleted") // Deleted flag\ncreatedBy  String   @default("") @map("created_by") // Created by\ncreatedIp  String   @default("") @map("created_ip") // Created IP, supports IPv6\ncreatedAt  DateTime @default(now()) @map("created_at") @db.Timestamp(0) // Created at\nupdatedBy  String   @default("") @map("updated_by") // Updated by\nupdatedIp  String   @default("") @map("updated_ip") // Updated IP, supports IPv6\nupdatedAt  DateTime @updatedAt @map("updated_at") @db.Timestamp(0) // Updated at\n\n// properties\n\n// relations\n\n// index\n@@unique([cpk, csk])\n@@unique([pk, sk])\n@@unique([tenantCode, code])\n@@index([tenantCode, name])\n'})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var a=t(6540);const r={},s=a.createContext(r);function i(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);