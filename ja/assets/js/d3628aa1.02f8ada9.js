"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[855],{6585:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"debugging-guide","title":"\u30c7\u30d0\u30c3\u30b0\u30ac\u30a4\u30c9","description":"MBC CQRS Serverless\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c7\u30d0\u30c3\u30b0\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002","source":"@site/i18n/ja/docusaurus-plugin-content-docs/current/debugging-guide.md","sourceDirName":".","slug":"/debugging-guide","permalink":"/ja/docs/debugging-guide","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"description":"MBC CQRS Serverless\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c7\u30d0\u30c3\u30b0\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002"},"sidebar":"tutorialSidebar","previous":{"title":"\u3088\u304f\u3042\u308b\u554f\u984c","permalink":"/ja/docs/common-issues"},"next":{"title":"\u30b5\u30f3\u30d7\u30eb","permalink":"/ja/docs/recipes"}}');var i=s(4848),t=s(8453);const l={description:"MBC CQRS Serverless\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c7\u30d0\u30c3\u30b0\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002"},r="\u30c7\u30d0\u30c3\u30b0\u30ac\u30a4\u30c9",d={},c=[{value:"\u30ed\u30fc\u30ab\u30eb\u958b\u767a\u74b0\u5883\u3067\u306e\u30c7\u30d0\u30c3\u30b0",id:"\u30ed\u30fc\u30ab\u30eb\u958b\u767a\u74b0\u5883\u3067\u306e\u30c7\u30d0\u30c3\u30b0",level:2},{value:"NestJS REPL\u306e\u4f7f\u7528",id:"nestjs-repl\u306e\u4f7f\u7528",level:3},{value:"VS Code\u3067\u306e\u30c7\u30d0\u30c3\u30b0",id:"vs-code\u3067\u306e\u30c7\u30d0\u30c3\u30b0",level:3},{value:"Serverless Offline\u3067\u306e\u30c7\u30d0\u30c3\u30b0",id:"serverless-offline\u3067\u306e\u30c7\u30d0\u30c3\u30b0",level:3},{value:"\u30b3\u30f3\u30bd\u30fc\u30eb\u30ed\u30ae\u30f3\u30b0",id:"\u30b3\u30f3\u30bd\u30fc\u30eb\u30ed\u30ae\u30f3\u30b0",level:3},{value:"DynamoDB\u306e\u30c7\u30d0\u30c3\u30b0",id:"dynamodb\u306e\u30c7\u30d0\u30c3\u30b0",level:2},{value:"\u30c6\u30fc\u30d6\u30eb\u5185\u5bb9\u306e\u8868\u793a",id:"\u30c6\u30fc\u30d6\u30eb\u5185\u5bb9\u306e\u8868\u793a",level:3},{value:"DynamoDB Streams",id:"dynamodb-streams",level:3},{value:"CloudWatch Logs",id:"cloudwatch-logs",level:2},{value:"\u30ed\u30b0\u306e\u8868\u793a",id:"\u30ed\u30b0\u306e\u8868\u793a",level:3},{value:"Log Insights\u30af\u30a8\u30ea",id:"log-insights\u30af\u30a8\u30ea",level:3},{value:"\u69cb\u9020\u5316\u30ed\u30b0\u5206\u6790",id:"\u69cb\u9020\u5316\u30ed\u30b0\u5206\u6790",level:3},{value:"Step Functions\u306e\u30c7\u30d0\u30c3\u30b0",id:"step-functions\u306e\u30c7\u30d0\u30c3\u30b0",level:2},{value:"\u5b9f\u884c\u5c65\u6b74",id:"\u5b9f\u884c\u5c65\u6b74",level:3},{value:"\u30a4\u30d9\u30f3\u30c8\u5c65\u6b74",id:"\u30a4\u30d9\u30f3\u30c8\u5c65\u6b74",level:3},{value:"CloudWatch\u3067\u306e\u30c7\u30d0\u30c3\u30b0",id:"cloudwatch\u3067\u306e\u30c7\u30d0\u30c3\u30b0",level:3},{value:"API Gateway\u306e\u30c7\u30d0\u30c3\u30b0",id:"api-gateway\u306e\u30c7\u30d0\u30c3\u30b0",level:2},{value:"\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u306e\u6709\u52b9\u5316",id:"\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u306e\u6709\u52b9\u5316",level:3},{value:"\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306e\u30c6\u30b9\u30c8",id:"\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306e\u30c6\u30b9\u30c8",level:3},{value:"X-Ray\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0",id:"x-ray\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0",level:2},{value:"CDK\u30ec\u30d9\u30eb\u306e\u8a2d\u5b9a",id:"cdk\u30ec\u30d9\u30eb\u306e\u8a2d\u5b9a",level:3},{value:"\u30aa\u30d7\u30b7\u30e7\u30f3: SDK\u30ec\u30d9\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30eb\u30e1\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3",id:"\u30aa\u30d7\u30b7\u30e7\u30f3-sdk\u30ec\u30d9\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30eb\u30e1\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3",level:3},{value:"\u30ab\u30b9\u30bf\u30e0\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u8ffd\u52a0",id:"\u30ab\u30b9\u30bf\u30e0\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u8ffd\u52a0",level:3},{value:"\u4e00\u822c\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u30d1\u30bf\u30fc\u30f3",id:"\u4e00\u822c\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u30d1\u30bf\u30fc\u30f3",level:2},{value:"\u30ea\u30af\u30a8\u30b9\u30c8\u76f8\u95a2",id:"\u30ea\u30af\u30a8\u30b9\u30c8\u76f8\u95a2",level:3},{value:"\u74b0\u5883\u5909\u6570\u306e\u30c7\u30d0\u30c3\u30b0",id:"\u74b0\u5883\u5909\u6570\u306e\u30c7\u30d0\u30c3\u30b0",level:3},{value:"\u6761\u4ef6\u4ed8\u304d\u30c7\u30d0\u30c3\u30b0",id:"\u6761\u4ef6\u4ed8\u304d\u30c7\u30d0\u30c3\u30b0",level:3},{value:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",id:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",level:2},{value:"\u30ed\u30fc\u30ab\u30ebStep Functions\u30c7\u30d0\u30c3\u30b0",id:"\u30ed\u30fc\u30ab\u30ebstep-functions\u30c7\u30d0\u30c3\u30b0",level:2},{value:"Step Functions Local\u306e\u8d77\u52d5",id:"step-functions-local\u306e\u8d77\u52d5",level:3},{value:"\u30ed\u30fc\u30ab\u30eb\u3067\u306e\u30b9\u30c6\u30fc\u30c8\u30de\u30b7\u30f3\u4f5c\u6210",id:"\u30ed\u30fc\u30ab\u30eb\u3067\u306e\u30b9\u30c6\u30fc\u30c8\u30de\u30b7\u30f3\u4f5c\u6210",level:3},{value:"\u5b9f\u884c\u306e\u958b\u59cb\u3068\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0",id:"\u5b9f\u884c\u306e\u958b\u59cb\u3068\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0",level:3},{value:"waitForTaskToken\u306e\u30c7\u30d0\u30c3\u30b0",id:"waitfortasktoken\u306e\u30c7\u30d0\u30c3\u30b0",level:3},{value:"CloudWatch\u3092\u4f7f\u7528\u3057\u305f\u672c\u756a\u30c7\u30d0\u30c3\u30b0",id:"cloudwatch\u3092\u4f7f\u7528\u3057\u305f\u672c\u756a\u30c7\u30d0\u30c3\u30b0",level:2},{value:"Lambda\u30ed\u30b0\u5206\u6790",id:"lambda\u30ed\u30b0\u5206\u6790",level:3},{value:"Step Functions\u5b9f\u884c\u5206\u6790",id:"step-functions\u5b9f\u884c\u5206\u6790",level:3},{value:"CQRS\u5411\u3051CloudWatch Logs Insights",id:"cqrs\u5411\u3051cloudwatch-logs-insights",level:3},{value:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u30c7\u30d0\u30c3\u30b0",id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u30c7\u30d0\u30c3\u30b0",level:2},{value:"\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u306e\u7406\u89e3",id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u306e\u7406\u89e3",level:3},{value:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u7279\u5b9a",id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u7279\u5b9a",level:3},{value:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u89e3\u6c7a",id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u89e3\u6c7a",level:3},{value:"DynamoDB\u30b3\u30de\u30f3\u30c9\u5c65\u6b74\u306e\u691c\u67fb",id:"dynamodb\u30b3\u30de\u30f3\u30c9\u5c65\u6b74\u306e\u691c\u67fb",level:2},{value:"\u30c6\u30fc\u30d6\u30eb\u69cb\u9020",id:"\u30c6\u30fc\u30d6\u30eb\u69cb\u9020",level:3},{value:"\u30b3\u30de\u30f3\u30c9\u5c65\u6b74\u306e\u30af\u30a8\u30ea",id:"\u30b3\u30de\u30f3\u30c9\u5c65\u6b74\u306e\u30af\u30a8\u30ea",level:3},{value:"DynamoDB Admin UI\u306e\u4f7f\u7528",id:"dynamodb-admin-ui\u306e\u4f7f\u7528",level:3},{value:"\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u3088\u308b\u5c65\u6b74\u30a2\u30af\u30bb\u30b9",id:"\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u3088\u308b\u5c65\u6b74\u30a2\u30af\u30bb\u30b9",level:3},{value:"\u4e00\u822c\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u30b7\u30ca\u30ea\u30aa",id:"\u4e00\u822c\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u30b7\u30ca\u30ea\u30aa",level:2},{value:"\u30b7\u30ca\u30ea\u30aa1\uff1a\u30b3\u30de\u30f3\u30c9\u304c\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306b\u8868\u793a\u3055\u308c\u306a\u3044",id:"\u30b7\u30ca\u30ea\u30aa1\u30b3\u30de\u30f3\u30c9\u304c\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306b\u8868\u793a\u3055\u308c\u306a\u3044",level:3},{value:"\u30b7\u30ca\u30ea\u30aa2\uff1aStep Function\u304cRUNNING\u72b6\u614b\u3067\u505c\u6b62",id:"\u30b7\u30ca\u30ea\u30aa2step-function\u304crunning\u72b6\u614b\u3067\u505c\u6b62",level:3},{value:"\u30b7\u30ca\u30ea\u30aa3\uff1a\u91cd\u8907\u30b3\u30de\u30f3\u30c9\u304c\u51e6\u7406\u3055\u308c\u3066\u3044\u308b",id:"\u30b7\u30ca\u30ea\u30aa3\u91cd\u8907\u30b3\u30de\u30f3\u30c9\u304c\u51e6\u7406\u3055\u308c\u3066\u3044\u308b",level:3},{value:"\u30b7\u30ca\u30ea\u30aa4\uff1a\u30c7\u30fc\u30bf\u540c\u671f\u30cf\u30f3\u30c9\u30e9\u30fc\u304c\u5b9f\u884c\u3055\u308c\u306a\u3044",id:"\u30b7\u30ca\u30ea\u30aa4\u30c7\u30fc\u30bf\u540c\u671f\u30cf\u30f3\u30c9\u30e9\u30fc\u304c\u5b9f\u884c\u3055\u308c\u306a\u3044",level:3},{value:"\u30b7\u30ca\u30ea\u30aa5\uff1aX-Ray\u30c8\u30ec\u30fc\u30b9\u304c\u8868\u793a\u3055\u308c\u306a\u3044",id:"\u30b7\u30ca\u30ea\u30aa5x-ray\u30c8\u30ec\u30fc\u30b9\u304c\u8868\u793a\u3055\u308c\u306a\u3044",level:3},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:2}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"\u30c7\u30d0\u30c3\u30b0\u30ac\u30a4\u30c9",children:"\u30c7\u30d0\u30c3\u30b0\u30ac\u30a4\u30c9"})}),"\n",(0,i.jsx)(e.p,{children:"\u3053\u306e\u30ac\u30a4\u30c9\u3067\u306f\u3001\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3068AWS\u74b0\u5883\u306e\u4e21\u65b9\u3067\u306eMBC CQRS Serverless\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c7\u30d0\u30c3\u30b0\u30c6\u30af\u30cb\u30c3\u30af\u3092\u8aac\u660e\u3057\u307e\u3059\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u30ed\u30fc\u30ab\u30eb\u958b\u767a\u74b0\u5883\u3067\u306e\u30c7\u30d0\u30c3\u30b0",children:"\u30ed\u30fc\u30ab\u30eb\u958b\u767a\u74b0\u5883\u3067\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.h3,{id:"nestjs-repl\u306e\u4f7f\u7528",children:"NestJS REPL\u306e\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"REPL\uff08Read-Eval-Print Loop\uff09\u3092\u4f7f\u7528\u3057\u3066\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u306b\u30c7\u30d0\u30c3\u30b0\u3067\u304d\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"npm run start:repl\n"})}),"\n",(0,i.jsx)(e.p,{children:"REPL\u3067\u306f\u4ee5\u4e0b\u306e\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"// Get a service instance (\u30b5\u30fc\u30d3\u30b9\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u53d6\u5f97)\n> get(TodoService)\nTodoService { ... }\n\n// Call methods directly (\u30e1\u30bd\u30c3\u30c9\u3092\u76f4\u63a5\u547c\u3073\u51fa\u3059)\n> await get(TodoService).findAll()\n[{ id: '1', title: 'Test' }, ...]\n\n// Show available methods on a service (\u30b5\u30fc\u30d3\u30b9\u3067\u5229\u7528\u53ef\u80fd\u306a\u30e1\u30bd\u30c3\u30c9\u3092\u8868\u793a)\n> methods(TodoService)\nMethods:\n \u25fb findAll\n \u25fb findOne\n \u25fb create\n \u25fb update\n \u25fb delete\n"})}),"\n",(0,i.jsxs)(e.p,{children:["NestJS REPL\u306e\u8a73\u7d30\u306b\u3064\u3044\u3066\u306f\u3001",(0,i.jsx)(e.a,{href:"https://docs.nestjs.com/recipes/repl",children:"NestJS REPL\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002"]}),"\n",(0,i.jsx)(e.h3,{id:"vs-code\u3067\u306e\u30c7\u30d0\u30c3\u30b0",children:"VS Code\u3067\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:".vscode/launch.json"})," \u8a2d\u5b9a\u3092\u4f5c\u6210\u3057\u307e\u3059\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\n  "version": "0.2.0",\n  "configurations": [\n    {\n      "type": "node",\n      "request": "launch",\n      "name": "Debug Serverless Offline",\n      "program": "${workspaceFolder}/node_modules/.bin/serverless",\n      "args": ["offline", "start"],\n      "cwd": "${workspaceFolder}/infra-local",\n      "env": {\n        "NODE_ENV": "development"\n      },\n      "console": "integratedTerminal"\n    },\n    {\n      "type": "node",\n      "request": "launch",\n      "name": "Debug Tests",\n      "program": "${workspaceFolder}/node_modules/.bin/jest",\n      "args": ["--runInBand", "--watchAll=false"],\n      "console": "integratedTerminal"\n    }\n  ]\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"serverless-offline\u3067\u306e\u30c7\u30d0\u30c3\u30b0",children:"Serverless Offline\u3067\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.p,{children:"Serverless Offline\u3067\u8a73\u7d30\u306a\u30ed\u30b0\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"SLS_DEBUG=* npm run offline:sls\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u307e\u305f\u306fserverless.yml\u306b\u8ffd\u52a0\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"custom:\n  serverless-offline:\n    httpPort: 3000\n    lambdaPort: 3002\n    printOutput: true\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u30b3\u30f3\u30bd\u30fc\u30eb\u30ed\u30ae\u30f3\u30b0",children:"\u30b3\u30f3\u30bd\u30fc\u30eb\u30ed\u30ae\u30f3\u30b0"}),"\n",(0,i.jsx)(e.p,{children:"\u30c7\u30d0\u30c3\u30b0\u3092\u5bb9\u6613\u306b\u3059\u308b\u305f\u3081\u306b\u69cb\u9020\u5316\u30ed\u30b0\u3092\u4f7f\u7528\u3057\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { Logger } from '@nestjs/common';\n\n@Injectable()\nexport class TodoService {\n  private readonly logger = new Logger(TodoService.name);\n\n  async create(dto: CreateTodoDto, invokeContext: IInvoke): Promise<Todo> {\n    this.logger.debug(`Creating todo: ${JSON.stringify(dto)}`);\n\n    try {\n      const result = await this.commandService.publishAsync(entity, { invokeContext });\n      this.logger.log(`Todo created: ${result.id}`);\n      return result;\n    } catch (error) {\n      this.logger.error(`Failed to create todo: ${error.message}`, error.stack);\n      throw error;\n    }\n  }\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"dynamodb\u306e\u30c7\u30d0\u30c3\u30b0",children:"DynamoDB\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.h3,{id:"\u30c6\u30fc\u30d6\u30eb\u5185\u5bb9\u306e\u8868\u793a",children:"\u30c6\u30fc\u30d6\u30eb\u5185\u5bb9\u306e\u8868\u793a"}),"\n",(0,i.jsx)(e.p,{children:"DynamoDB Local\u3067AWS CLI\u3092\u4f7f\u7528\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# List tables\naws dynamodb list-tables --endpoint-url http://localhost:8000\n\n# Scan table\naws dynamodb scan \\\n  --table-name your-table-name \\\n  --endpoint-url http://localhost:8000\n\n# Query by partition key\naws dynamodb query \\\n  --table-name your-table-name \\\n  --key-condition-expression "pk = :pk" \\\n  --expression-attribute-values \'{":pk":{"S":"TODO#123"}}\' \\\n  --endpoint-url http://localhost:8000\n'})}),"\n",(0,i.jsx)(e.h3,{id:"dynamodb-streams",children:"DynamoDB Streams"}),"\n",(0,i.jsx)(e.p,{children:"\u30b9\u30c8\u30ea\u30fc\u30e0\u30ec\u30b3\u30fc\u30c9\u3092\u30c7\u30d0\u30c3\u30b0\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"@EventHandler(DataSyncEvent)\nexport class DebugHandler implements IEventHandler<DataSyncEvent> {\n  async execute(event: DataSyncEvent): Promise<void> {\n    console.log('Stream record:', JSON.stringify(event.record, null, 2));\n    console.log('Event name:', event.eventName);\n    console.log('New image:', event.newImage);\n    console.log('Old image:', event.oldImage);\n  }\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"cloudwatch-logs",children:"CloudWatch Logs"}),"\n",(0,i.jsx)(e.h3,{id:"\u30ed\u30b0\u306e\u8868\u793a",children:"\u30ed\u30b0\u306e\u8868\u793a"}),"\n",(0,i.jsx)(e.p,{children:"AWS CLI\u3092\u4f7f\u7528\u3057\u3066\u30ed\u30b0\u3092\u30c6\u30fc\u30eb\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Find log group\naws logs describe-log-groups --log-group-name-prefix /aws/lambda/your-app\n\n# Tail logs\naws logs tail /aws/lambda/your-app-dev-handler --follow\n\n# Filter logs\naws logs filter-log-events \\\n  --log-group-name /aws/lambda/your-app-dev-handler \\\n  --filter-pattern "ERROR"\n'})}),"\n",(0,i.jsx)(e.h3,{id:"log-insights\u30af\u30a8\u30ea",children:"Log Insights\u30af\u30a8\u30ea"}),"\n",(0,i.jsx)(e.p,{children:"\u9ad8\u5ea6\u306a\u30af\u30a8\u30ea\u306b\u306fCloudWatch Logs Insights\u3092\u4f7f\u7528\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'# Find errors\nfields @timestamp, @message\n| filter @message like /ERROR/\n| sort @timestamp desc\n| limit 100\n\n# Analyze cold starts\nfields @timestamp, @message, @duration\n| filter @type = "REPORT"\n| stats avg(@duration), max(@duration), count(*) by bin(1h)\n\n# Find slow requests\nfields @timestamp, @message, @duration\n| filter @duration > 3000\n| sort @duration desc\n| limit 20\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u69cb\u9020\u5316\u30ed\u30b0\u5206\u6790",children:"\u69cb\u9020\u5316\u30ed\u30b0\u5206\u6790"}),"\n",(0,i.jsx)(e.p,{children:"\u69cb\u9020\u5316\u30ed\u30b0\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'fields @timestamp, level, message, context\n| filter level = "error"\n| sort @timestamp desc\n'})}),"\n",(0,i.jsx)(e.h2,{id:"step-functions\u306e\u30c7\u30d0\u30c3\u30b0",children:"Step Functions\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.h3,{id:"\u5b9f\u884c\u5c65\u6b74",children:"\u5b9f\u884c\u5c65\u6b74"}),"\n",(0,i.jsx)(e.p,{children:"AWS\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u5b9f\u884c\u3092\u8868\u793a\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Step Functions \u2192 \u30b9\u30c6\u30fc\u30c8\u30de\u30b7\u30f3 \u306b\u79fb\u52d5"}),"\n",(0,i.jsx)(e.li,{children:"\u30b9\u30c6\u30fc\u30c8\u30de\u30b7\u30f3\u3092\u9078\u629e"}),"\n",(0,i.jsx)(e.li,{children:"\u5b9f\u884c\u3092\u30af\u30ea\u30c3\u30af"}),"\n",(0,i.jsx)(e.li,{children:"\u30b9\u30c6\u30c3\u30d7\u30b9\u30c6\u30fc\u30bf\u30b9\u4ed8\u304d\u306e\u30d3\u30b8\u30e5\u30a2\u30eb\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3092\u8868\u793a"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u30a4\u30d9\u30f3\u30c8\u5c65\u6b74",children:"\u30a4\u30d9\u30f3\u30c8\u5c65\u6b74"}),"\n",(0,i.jsx)(e.p,{children:"AWS CLI\u3092\u4f7f\u7528\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# List executions\naws stepfunctions list-executions \\\n  --state-machine-arn arn:aws:states:REGION:ACCOUNT:stateMachine:YourMachine\n\n# Get execution details\naws stepfunctions describe-execution \\\n  --execution-arn arn:aws:states:REGION:ACCOUNT:execution:YourMachine:execution-id\n\n# Get execution history\naws stepfunctions get-execution-history \\\n  --execution-arn arn:aws:states:REGION:ACCOUNT:execution:YourMachine:execution-id\n"})}),"\n",(0,i.jsx)(e.h3,{id:"cloudwatch\u3067\u306e\u30c7\u30d0\u30c3\u30b0",children:"CloudWatch\u3067\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.p,{children:"Step Functions\u3067\u30ed\u30b0\u3092\u6709\u52b9\u5316\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const stateMachine = new sfn.StateMachine(this, 'StateMachine', {\n  definition: definition,\n  logs: {\n    destination: new logs.LogGroup(this, 'StateMachineLogGroup'),\n    level: sfn.LogLevel.ALL,\n  },\n  tracingEnabled: true, // Enable X-Ray\n});\n"})}),"\n",(0,i.jsx)(e.h2,{id:"api-gateway\u306e\u30c7\u30d0\u30c3\u30b0",children:"API Gateway\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.h3,{id:"\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u306e\u6709\u52b9\u5316",children:"\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u306e\u6709\u52b9\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const api = new apigateway.HttpApi(this, 'Api');\n\nconst stage = api.defaultStage?.node.defaultChild as apigateway.CfnStage;\nstage.accessLogSettings = {\n  destinationArn: logGroup.logGroupArn,\n  format: JSON.stringify({\n    requestId: '$context.requestId',\n    ip: '$context.identity.sourceIp',\n    method: '$context.httpMethod',\n    path: '$context.path',\n    status: '$context.status',\n    latency: '$context.responseLatency',\n    error: '$context.error.message',\n  }),\n};\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306e\u30c6\u30b9\u30c8",children:"\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306e\u30c6\u30b9\u30c8"}),"\n",(0,i.jsx)(e.p,{children:"\u8a73\u7d30\u51fa\u529b\u4ed8\u304d\u3067curl\u3092\u4f7f\u7528\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'curl -v -X POST https://your-api.execute-api.region.amazonaws.com/todos \\\n  -H "Authorization: Bearer YOUR_TOKEN" \\\n  -H "Content-Type: application/json" \\\n  -d \'{"title": "Test Todo"}\'\n'})}),"\n",(0,i.jsx)(e.h2,{id:"x-ray\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0",children:"X-Ray\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0"}),"\n",(0,i.jsxs)(e.p,{children:["X-Ray\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u306fCDK\u30ec\u30d9\u30eb\u3067Lambda\u95a2\u6570\u3068API Gateway\u306b\u5bfe\u3057\u3066\u81ea\u52d5\u7684\u306b\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u307e\u3059\u3002",(0,i.jsx)(e.code,{children:"aws-xray-sdk"}),"\u3092\u4f7f\u7528\u3057\u305fSDK\u30ec\u30d9\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30eb\u30e1\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3\u306f\u3001\u8ffd\u52a0\u306e\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u6a5f\u80fd\u304c\u5fc5\u8981\u306a\u5834\u5408\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u3059\u3002"]}),"\n",(0,i.jsx)(e.h3,{id:"cdk\u30ec\u30d9\u30eb\u306e\u8a2d\u5b9a",children:"CDK\u30ec\u30d9\u30eb\u306e\u8a2d\u5b9a"}),"\n",(0,i.jsx)(e.p,{children:"CDK\u30a4\u30f3\u30d5\u30e9\u30b9\u30c8\u30e9\u30af\u30c1\u30e3\u3067\u306fX-Ray\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9\u3067\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"// Lambda functions have X-Ray tracing enabled by default (Lambda\u95a2\u6570\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067X-Ray\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u304c\u6709\u52b9)\nconst handler = new NodejsFunction(this, 'Handler', {\n  // ...\n  tracing: lambda.Tracing.ACTIVE, // Enabled by default (\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u6709\u52b9)\n});\n\n// Step Functions can also enable X-Ray (Step Functions\u3067\u3082X-Ray\u3092\u6709\u52b9\u5316\u3067\u304d\u308b)\nconst stateMachine = new sfn.StateMachine(this, 'StateMachine', {\n  definition: definition,\n  tracingEnabled: true, // Enable X-Ray (X-Ray\u3092\u6709\u52b9\u5316)\n});\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u30aa\u30d7\u30b7\u30e7\u30f3-sdk\u30ec\u30d9\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30eb\u30e1\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3",children:"\u30aa\u30d7\u30b7\u30e7\u30f3: SDK\u30ec\u30d9\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30eb\u30e1\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3"}),"\n",(0,i.jsx)(e.p,{children:"\u3088\u308a\u8a73\u7d30\u306a\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001\u30aa\u30d7\u30b7\u30e7\u30f3\u3067X-Ray SDK\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"npm install aws-xray-sdk\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"// Optional: Instrument AWS SDK for detailed tracing (\u30aa\u30d7\u30b7\u30e7\u30f3: \u8a73\u7d30\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u7528\u306bAWS SDK\u3092\u30a4\u30f3\u30b9\u30c8\u30eb\u30e1\u30f3\u30c8)\nimport * as AWSXRay from 'aws-xray-sdk';\nconst AWS = AWSXRay.captureAWS(require('aws-sdk'));\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u30ab\u30b9\u30bf\u30e0\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u8ffd\u52a0",children:"\u30ab\u30b9\u30bf\u30e0\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u8ffd\u52a0"}),"\n",(0,i.jsx)(e.p,{children:"\u8a73\u7d30\u306a\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u306e\u305f\u3081\u306b\u30ab\u30b9\u30bf\u30e0\u30b5\u30d6\u30bb\u30b0\u30e1\u30f3\u30c8\u304c\u5fc5\u8981\u306a\u5834\u5408\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import * as AWSXRay from 'aws-xray-sdk';\n\nasync function processOrder(orderId: string): Promise<void> {\n  const segment = AWSXRay.getSegment();\n  const subsegment = segment?.addNewSubsegment('ProcessOrder');\n\n  try {\n    subsegment?.addAnnotation('orderId', orderId);\n    // Process order (\u6ce8\u6587\u3092\u51e6\u7406)\n    subsegment?.addMetadata('result', { status: 'success' });\n  } catch (error) {\n    subsegment?.addError(error);\n    throw error;\n  } finally {\n    subsegment?.close();\n  }\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u4e00\u822c\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u30d1\u30bf\u30fc\u30f3",children:"\u4e00\u822c\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,i.jsx)(e.h3,{id:"\u30ea\u30af\u30a8\u30b9\u30c8\u76f8\u95a2",children:"\u30ea\u30af\u30a8\u30b9\u30c8\u76f8\u95a2"}),"\n",(0,i.jsx)(e.p,{children:"\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u8ffd\u8de1\u3059\u308b\u305f\u3081\u306b\u76f8\u95a2ID\u3092\u8ffd\u52a0\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"@Injectable()\nexport class CorrelationMiddleware implements NestMiddleware {\n  use(req: Request, res: Response, next: NextFunction) {\n    const correlationId = req.headers['x-correlation-id'] || uuidv4();\n    req['correlationId'] = correlationId;\n    res.setHeader('x-correlation-id', correlationId);\n    next();\n  }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u74b0\u5883\u5909\u6570\u306e\u30c7\u30d0\u30c3\u30b0",children:"\u74b0\u5883\u5909\u6570\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"// Log environment on startup (development only)\nif (process.env.NODE_ENV === 'development') {\n  console.log('Environment:', {\n    NODE_ENV: process.env.NODE_ENV,\n    AWS_REGION: process.env.AWS_REGION,\n    DATABASE_URL: process.env.DATABASE_URL ? '[SET]' : '[NOT SET]',\n  });\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u6761\u4ef6\u4ed8\u304d\u30c7\u30d0\u30c3\u30b0",children:"\u6761\u4ef6\u4ed8\u304d\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const DEBUG = process.env.DEBUG === 'true';\n\nfunction debugLog(message: string, data?: any): void {\n  if (DEBUG) {\n    console.log(`[DEBUG] ${message}`, data ? JSON.stringify(data, null, 2) : '');\n  }\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",children:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8"}),"\n",(0,i.jsx)(e.p,{children:"\u554f\u984c\u3092\u30c7\u30d0\u30c3\u30b0\u3059\u308b\u969b\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u30ed\u30fc\u30ab\u30eb\u3067\u518d\u73fe"}),": \u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u518d\u73fe\u3067\u304d\u307e\u3059\u304b\uff1f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u30ed\u30b0\u3092\u78ba\u8a8d"}),": CloudWatch Logs\u3067\u30a8\u30e9\u30fc\u3092\u78ba\u8a8d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u8a2d\u5b9a\u3092\u78ba\u8a8d"}),": \u74b0\u5883\u5909\u6570\u3068\u8a2d\u5b9a\u3092\u78ba\u8a8d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5206\u96e2\u30c6\u30b9\u30c8"}),": \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u500b\u5225\u306b\u30c6\u30b9\u30c8"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6a29\u9650\u3092\u78ba\u8a8d"}),": IAM\u30ed\u30fc\u30eb\u3068\u30dd\u30ea\u30b7\u30fc\u3092\u78ba\u8a8d"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6700\u8fd1\u306e\u5909\u66f4\u3092\u78ba\u8a8d"}),": \u6700\u5f8c\u306b\u52d5\u4f5c\u3057\u305f\u6642\u304b\u3089\u4f55\u304c\u5909\u308f\u308a\u307e\u3057\u305f\u304b\uff1f"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u4f9d\u5b58\u95a2\u4fc2\u3092\u78ba\u8a8d"}),": \u3059\u3079\u3066\u306e\u30b5\u30fc\u30d3\u30b9\u306f\u6b63\u5e38\u3067\u3059\u304b\uff1f"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u30ed\u30fc\u30ab\u30ebstep-functions\u30c7\u30d0\u30c3\u30b0",children:"\u30ed\u30fc\u30ab\u30ebStep Functions\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.p,{children:"\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306fAWS Step Functions Local\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u304a\u308a\u3001\u30ed\u30fc\u30ab\u30eb\u958b\u767a\u74b0\u5883\u3067Step Functions\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3092\u30c6\u30b9\u30c8\u304a\u3088\u3073\u30c7\u30d0\u30c3\u30b0\u3067\u304d\u307e\u3059\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"step-functions-local\u306e\u8d77\u52d5",children:"Step Functions Local\u306e\u8d77\u52d5"}),"\n",(0,i.jsx)(e.p,{children:"Step Functions Local\u306f\u4ed6\u306e\u30ed\u30fc\u30ab\u30eb\u30b5\u30fc\u30d3\u30b9\u3068\u4e26\u884c\u3057\u3066Docker\u30b3\u30f3\u30c6\u30ca\u3068\u3057\u3066\u5b9f\u884c\u3055\u308c\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Start all local services including Step Functions (Step Functions\u3092\u542b\u3080\u3059\u3079\u3066\u306e\u30ed\u30fc\u30ab\u30eb\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5)\ncd infra-local\ndocker-compose up -d\n"})}),"\n",(0,i.jsx)(e.p,{children:"Step Functions Local\u30b5\u30fc\u30d3\u30b9\u306f\u30dd\u30fc\u30c88083\u3067\u5b9f\u884c\u3055\u308c\u3001\u30ed\u30fc\u30ab\u30eb\u306eLambda\u95a2\u6570\u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"\u30ed\u30fc\u30ab\u30eb\u3067\u306e\u30b9\u30c6\u30fc\u30c8\u30de\u30b7\u30f3\u4f5c\u6210",children:"\u30ed\u30fc\u30ab\u30eb\u3067\u306e\u30b9\u30c6\u30fc\u30c8\u30de\u30b7\u30f3\u4f5c\u6210"}),"\n",(0,i.jsx)(e.p,{children:"AWS CLI\u3092\u4f7f\u7528\u3057\u3066Step Functions Local\u3067\u30b9\u30c6\u30fc\u30c8\u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Create state machine from definition (\u5b9a\u7fa9\u304b\u3089\u30b9\u30c6\u30fc\u30c8\u30de\u30b7\u30f3\u3092\u4f5c\u6210)\naws stepfunctions create-state-machine \\\n  --endpoint-url http://localhost:8083 \\\n  --name command \\\n  --definition file://state-machine-definition.json \\\n  --role-arn "arn:aws:iam::101010101010:role/DummyRole"\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u5b9f\u884c\u306e\u958b\u59cb\u3068\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0",children:"\u5b9f\u884c\u306e\u958b\u59cb\u3068\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0"}),"\n",(0,i.jsx)(e.p,{children:"\u30ed\u30fc\u30ab\u30eb\u3067Step Functions\u5b9f\u884c\u3092\u958b\u59cb\u304a\u3088\u3073\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3057\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Start an execution (\u5b9f\u884c\u3092\u958b\u59cb)\naws stepfunctions start-execution \\\n  --endpoint-url http://localhost:8083 \\\n  --state-machine-arn arn:aws:states:ap-northeast-1:101010101010:stateMachine:command \\\n  --input \'{"pk":"TODO#tenant","sk":"item#001@1"}\'\n\n# List executions (\u5b9f\u884c\u4e00\u89a7\u3092\u8868\u793a)\naws stepfunctions list-executions \\\n  --endpoint-url http://localhost:8083 \\\n  --state-machine-arn arn:aws:states:ap-northeast-1:101010101010:stateMachine:command\n\n# Get execution history (\u5b9f\u884c\u5c65\u6b74\u3092\u53d6\u5f97)\naws stepfunctions get-execution-history \\\n  --endpoint-url http://localhost:8083 \\\n  --execution-arn arn:aws:states:ap-northeast-1:101010101010:execution:command:execution-id\n'})}),"\n",(0,i.jsx)(e.h3,{id:"waitfortasktoken\u306e\u30c7\u30d0\u30c3\u30b0",children:"waitForTaskToken\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.p,{children:"waitForTaskToken\u3092\u4f7f\u7528\u3059\u308bStep Functions\uff08\u30b3\u30de\u30f3\u30c9\u51e6\u7406\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u306a\u3069\uff09\u3092\u30c7\u30d0\u30c3\u30b0\u3059\u308b\u5834\u5408\u3001\u624b\u52d5\u3067\u30bf\u30b9\u30af\u6210\u529f\u307e\u305f\u306f\u5931\u6557\u3092\u9001\u4fe1\u3067\u304d\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Send task success (\u30bf\u30b9\u30af\u6210\u529f\u3092\u9001\u4fe1)\naws stepfunctions send-task-success \\\n  --endpoint-url http://localhost:8083 \\\n  --task-token "YOUR_TASK_TOKEN" \\\n  --task-output \'{"Payload":[[{"result":0}]]}\'\n\n# Send task failure (\u30bf\u30b9\u30af\u5931\u6557\u3092\u9001\u4fe1)\naws stepfunctions send-task-failure \\\n  --endpoint-url http://localhost:8083 \\\n  --task-token "YOUR_TASK_TOKEN" \\\n  --cause "Debug failure" \\\n  --error "TestError"\n'})}),"\n",(0,i.jsx)(e.h2,{id:"cloudwatch\u3092\u4f7f\u7528\u3057\u305f\u672c\u756a\u30c7\u30d0\u30c3\u30b0",children:"CloudWatch\u3092\u4f7f\u7528\u3057\u305f\u672c\u756a\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.h3,{id:"lambda\u30ed\u30b0\u5206\u6790",children:"Lambda\u30ed\u30b0\u5206\u6790"}),"\n",(0,i.jsx)(e.p,{children:"\u5404Lambda\u95a2\u6570\u306fCloudWatch\u306b\u30ed\u30b0\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u30d1\u30bf\u30fc\u30f3\u3092\u4f7f\u7528\u3057\u3066\u672c\u756a\u74b0\u5883\u306e\u554f\u984c\u3092\u5206\u6790\u3057\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Find log groups for your application (\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ed\u30b0\u30b0\u30eb\u30fc\u30d7\u3092\u691c\u7d22)\naws logs describe-log-groups \\\n  --log-group-name-prefix /aws/lambda/prod-myapp\n\n# Get recent log events (\u6700\u8fd1\u306e\u30ed\u30b0\u30a4\u30d9\u30f3\u30c8\u3092\u53d6\u5f97)\naws logs get-log-events \\\n  --log-group-name /aws/lambda/prod-myapp-handler \\\n  --log-stream-name '2024/01/15/[$LATEST]abc123' \\\n  --limit 100\n\n# Filter for errors in the last hour (\u904e\u53bb1\u6642\u9593\u306e\u30a8\u30e9\u30fc\u3092\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0)\naws logs filter-log-events \\\n  --log-group-name /aws/lambda/prod-myapp-handler \\\n  --start-time $(date -d '1 hour ago' +%s000) \\\n  --filter-pattern \"ERROR\"\n"})}),"\n",(0,i.jsx)(e.h3,{id:"step-functions\u5b9f\u884c\u5206\u6790",children:"Step Functions\u5b9f\u884c\u5206\u6790"}),"\n",(0,i.jsx)(e.p,{children:"\u672c\u756a\u74b0\u5883\u306eStep Functions\u30c7\u30d0\u30c3\u30b0\u306e\u5834\u5408\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# List failed executions (\u5931\u6557\u3057\u305f\u5b9f\u884c\u3092\u4e00\u89a7\u8868\u793a)\naws stepfunctions list-executions \\\n  --state-machine-arn arn:aws:states:REGION:ACCOUNT:stateMachine:command \\\n  --status-filter FAILED\n\n# Get detailed execution history (\u8a73\u7d30\u306a\u5b9f\u884c\u5c65\u6b74\u3092\u53d6\u5f97)\naws stepfunctions get-execution-history \\\n  --execution-arn arn:aws:states:REGION:ACCOUNT:execution:command:exec-id \\\n  --include-execution-data\n\n# Describe execution for input/output (\u5165\u51fa\u529b\u306e\u5b9f\u884c\u8a73\u7d30\u3092\u53d6\u5f97)\naws stepfunctions describe-execution \\\n  --execution-arn arn:aws:states:REGION:ACCOUNT:execution:command:exec-id\n"})}),"\n",(0,i.jsx)(e.h3,{id:"cqrs\u5411\u3051cloudwatch-logs-insights",children:"CQRS\u5411\u3051CloudWatch Logs Insights"}),"\n",(0,i.jsx)(e.p,{children:"MBC CQRS\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5411\u3051\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3055\u308c\u305fCloudWatch Logs Insights\u30af\u30a8\u30ea\u3092\u4f7f\u7528\u3057\u307e\u3059\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'# Find version conflicts (\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u3092\u691c\u7d22)\nfields @timestamp, @message\n| filter @message like /version not match|ConditionalCheckFailed/\n| sort @timestamp desc\n| limit 50\n\n# Track command processing (\u30b3\u30de\u30f3\u30c9\u51e6\u7406\u3092\u8ffd\u8de1)\nfields @timestamp, @message\n| filter @message like /publish|publishSync|publishAsync/\n| parse @message "pk=* sk=*" as pk, sk\n| sort @timestamp desc\n| limit 100\n\n# Analyze data sync operations (\u30c7\u30fc\u30bf\u540c\u671f\u64cd\u4f5c\u3092\u5206\u6790)\nfields @timestamp, @message\n| filter @message like /DataSyncHandler|sync_data/\n| sort @timestamp desc\n| limit 100\n\n# Find Step Functions timeouts (Step Functions\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u691c\u7d22)\nfields @timestamp, @message\n| filter @message like /waitForTaskToken|taskToken/\n| sort @timestamp desc\n| limit 50\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u30c7\u30d0\u30c3\u30b0",children:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u30c7\u30d0\u30c3\u30b0"}),"\n",(0,i.jsx)(e.p,{children:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306f\u3001\u8907\u6570\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u540c\u6642\u306b\u540c\u3058\u30a2\u30a4\u30c6\u30e0\u3092\u66f4\u65b0\u3057\u3088\u3046\u3068\u3057\u305f\u5834\u5408\u306b\u767a\u751f\u3057\u307e\u3059\u3002\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306f\u697d\u89b3\u7684\u30ed\u30c3\u30af\u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u306e\u4e00\u8cab\u6027\u3092\u78ba\u4fdd\u3057\u307e\u3059\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u306e\u7406\u89e3",children:"\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u306e\u7406\u89e3"}),"\n",(0,i.jsx)(e.p,{children:"MBC CQRS Serverless\u3067\u306f\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6a5f\u80fd\u3057\u307e\u3059\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u30bd\u30fc\u30c8\u30ad\u30fc\uff08sk\uff09\u5f62\u5f0f\uff1a",(0,i.jsx)(e.code,{children:"ITEM#code@version"}),"\uff08\u4f8b\uff1a",(0,i.jsx)(e.code,{children:"TODO#001@3"}),"\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["\u30d0\u30fc\u30b8\u30e7\u30f3\u533a\u5207\u308a\u6587\u5b57\uff1a",(0,i.jsx)(e.code,{children:"@"})]}),"\n",(0,i.jsxs)(e.li,{children:["VERSION_FIRST\uff1a",(0,i.jsx)(e.code,{children:"0"}),"\uff08\u521d\u671f\u30d0\u30fc\u30b8\u30e7\u30f3\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:["VERSION_LATEST\uff1a",(0,i.jsx)(e.code,{children:"-1"}),"\uff08\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u81ea\u52d5\u53d6\u5f97\uff09"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u7279\u5b9a",children:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u7279\u5b9a"}),"\n",(0,i.jsx)(e.p,{children:"\u30b3\u30de\u30f3\u30c9\u30c6\u30fc\u30d6\u30eb\u3067\u30d0\u30fc\u30b8\u30e7\u30f3\u5c65\u6b74\u3092\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Query all versions of an item (\u30a2\u30a4\u30c6\u30e0\u306e\u5168\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30af\u30a8\u30ea)\naws dynamodb query \\\n  --table-name prod-myapp-command \\\n  --endpoint-url http://localhost:8000 \\\n  --key-condition-expression "pk = :pk AND begins_with(sk, :sk)" \\\n  --expression-attribute-values \'{\n    ":pk": {"S": "TODO#tenant"},\n    ":sk": {"S": "TODO#001@"}\n  }\' \\\n  --scan-index-forward false\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u89e3\u6c7a",children:"\u30d0\u30fc\u30b8\u30e7\u30f3\u7af6\u5408\u306e\u89e3\u6c7a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"// Option 1: Use VERSION_LATEST (-1) for auto-versioning (\u30aa\u30d7\u30b7\u30e7\u30f31\uff1a\u81ea\u52d5\u30d0\u30fc\u30b8\u30e7\u30cb\u30f3\u30b0\u306bVERSION_LATEST (-1)\u3092\u4f7f\u7528)\nawait commandService.publishPartialUpdateAsync({\n  pk: 'TODO#tenant',\n  sk: 'TODO#001',\n  version: -1,  // Auto-fetches latest version (\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u81ea\u52d5\u53d6\u5f97)\n  name: 'Updated Name',\n}, options);\n\n// Option 2: Fetch and retry pattern (\u30aa\u30d7\u30b7\u30e7\u30f32\uff1a\u30d5\u30a7\u30c3\u30c1\u3068\u30ea\u30c8\u30e9\u30a4\u30d1\u30bf\u30fc\u30f3)\nasync function updateWithRetry(pk: string, sk: string, updates: any, maxRetries = 3) {\n  for (let i = 0; i < maxRetries; i++) {\n    try {\n      const latest = await dataService.getItem({ pk, sk });\n      return await commandService.publishPartialUpdateSync({\n        pk,\n        sk,\n        version: latest.version,\n        ...updates,\n      }, options);\n    } catch (error) {\n      if (error.message.includes('version not match') && i < maxRetries - 1) {\n        await new Promise(r => setTimeout(r, 100 * Math.pow(2, i)));\n        continue;\n      }\n      throw error;\n    }\n  }\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"dynamodb\u30b3\u30de\u30f3\u30c9\u5c65\u6b74\u306e\u691c\u67fb",children:"DynamoDB\u30b3\u30de\u30f3\u30c9\u5c65\u6b74\u306e\u691c\u67fb"}),"\n",(0,i.jsx)(e.p,{children:"\u30b3\u30de\u30f3\u30c9\u30c6\u30fc\u30d6\u30eb\u306f\u3059\u3079\u3066\u306e\u30b3\u30de\u30f3\u30c9\u306e\u5b8c\u5168\u306a\u5c65\u6b74\u3092\u4fdd\u5b58\u3057\u3001\u5b8c\u5168\u306a\u76e3\u67fb\u8a3c\u8de1\u3068\u30c7\u30d0\u30c3\u30b0\u3092\u53ef\u80fd\u306b\u3057\u307e\u3059\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"\u30c6\u30fc\u30d6\u30eb\u69cb\u9020",children:"\u30c6\u30fc\u30d6\u30eb\u69cb\u9020"}),"\n",(0,i.jsx)(e.p,{children:"\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306f\u30e2\u30b8\u30e5\u30fc\u30eb\u3054\u3068\u306b2\u3064\u306eDynamoDB\u30c6\u30fc\u30d6\u30eb\u3092\u4f7f\u7528\u3057\u307e\u3059\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"{env}-{app}-{module}-command"}),"\uff1a\u30d0\u30fc\u30b8\u30e7\u30f3\u4ed8\u304d\u306e\u30b3\u30de\u30f3\u30c9\u5c65\u6b74\u3092\u4fdd\u5b58"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"{env}-{app}-{module}-data"}),"\uff1a\u73fe\u5728\u306e\u72b6\u614b\uff08\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\uff09\u3092\u4fdd\u5b58"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u30b3\u30de\u30f3\u30c9\u5c65\u6b74\u306e\u30af\u30a8\u30ea",children:"\u30b3\u30de\u30f3\u30c9\u5c65\u6b74\u306e\u30af\u30a8\u30ea"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Get the latest version from data table (\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97)\naws dynamodb get-item \\\n  --table-name dev-myapp-sample-data \\\n  --endpoint-url http://localhost:8000 \\\n  --key \'{"pk":{"S":"TODO#tenant"},"sk":{"S":"TODO#001"}}\'\n\n# Get all command versions (\u3059\u3079\u3066\u306e\u30b3\u30de\u30f3\u30c9\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97)\naws dynamodb query \\\n  --table-name dev-myapp-sample-command \\\n  --endpoint-url http://localhost:8000 \\\n  --key-condition-expression "pk = :pk AND begins_with(sk, :sk)" \\\n  --expression-attribute-values \'{\n    ":pk": {"S": "TODO#tenant"},\n    ":sk": {"S": "TODO#001@"}\n  }\' \\\n  --projection-expression "pk, sk, version, createdAt, createdBy, #s, requestId" \\\n  --expression-attribute-names \'{"#s": "source"}\' \\\n  --scan-index-forward false\n\n# Get a specific version (\u7279\u5b9a\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97)\naws dynamodb get-item \\\n  --table-name dev-myapp-sample-command \\\n  --endpoint-url http://localhost:8000 \\\n  --key \'{"pk":{"S":"TODO#tenant"},"sk":{"S":"TODO#001@3"}}\'\n'})}),"\n",(0,i.jsx)(e.h3,{id:"dynamodb-admin-ui\u306e\u4f7f\u7528",children:"DynamoDB Admin UI\u306e\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"DynamoDB Admin\u306f\u30ed\u30fc\u30ab\u30eb\u306e DynamoDB\u30c6\u30fc\u30d6\u30eb\u3092\u95b2\u89a7\u3059\u308b\u305f\u3081\u306eWeb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u63d0\u4f9b\u3057\u307e\u3059\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\u30ed\u30fc\u30ab\u30eb\u30b5\u30fc\u30d3\u30b9\u5b9f\u884c\u4e2d\u306b ",(0,i.jsx)(e.a,{href:"http://localhost:8001",children:"http://localhost:8001"})," \u306b\u30a2\u30af\u30bb\u30b9"]}),"\n",(0,i.jsxs)(e.li,{children:["\u30c6\u30fc\u30d6\u30eb\u3092\u9078\u629e\uff08\u4f8b\uff1a",(0,i.jsx)(e.code,{children:"dev-myapp-sample-command"}),"\uff09"]}),"\n",(0,i.jsx)(e.li,{children:"pk\u307e\u305f\u306fsk\u3067\u7279\u5b9a\u306e\u30a2\u30a4\u30c6\u30e0\u3092\u691c\u7d22\u3059\u308b\u305f\u3081\u306b\u30d5\u30a3\u30eb\u30bf\u30fc\u3092\u4f7f\u7528"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u3088\u308b\u5c65\u6b74\u30a2\u30af\u30bb\u30b9",children:"\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u3088\u308b\u5c65\u6b74\u30a2\u30af\u30bb\u30b9"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { DynamoDbService } from '@mbc-cqrs-serverless/core';\n\n// Get all versions of an item (\u30a2\u30a4\u30c6\u30e0\u306e\u5168\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u5f97)\nasync function getCommandHistory(pk: string, baseSk: string) {\n  const result = await dynamoDbService.listItemsByPk(\n    commandTableName,\n    pk,\n    {\n      skExpession: 'begins_with(sk, :sk)',\n      skAttributeValues: { ':sk': `${baseSk}@` },\n    },\n    undefined,\n    100,\n    'desc', // Latest first (\u6700\u65b0\u9806)\n  );\n  return result.items;\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u4e00\u822c\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u30b7\u30ca\u30ea\u30aa",children:"\u4e00\u822c\u7684\u306a\u30c7\u30d0\u30c3\u30b0\u30b7\u30ca\u30ea\u30aa"}),"\n",(0,i.jsx)(e.h3,{id:"\u30b7\u30ca\u30ea\u30aa1\u30b3\u30de\u30f3\u30c9\u304c\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306b\u8868\u793a\u3055\u308c\u306a\u3044",children:"\u30b7\u30ca\u30ea\u30aa1\uff1a\u30b3\u30de\u30f3\u30c9\u304c\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306b\u8868\u793a\u3055\u308c\u306a\u3044"}),"\n",(0,i.jsx)(e.p,{children:"\u75c7\u72b6\uff1a\u30b3\u30de\u30f3\u30c9\u306f\u516c\u958b\u3055\u308c\u307e\u3057\u305f\u304c\u3001\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306b\u306f\u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u30c7\u30d0\u30c3\u30b0\u624b\u9806\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u30b3\u30de\u30f3\u30c9\u30c6\u30fc\u30d6\u30eb\u3067\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'aws dynamodb query --table-name dev-myapp-sample-command \\\n  --endpoint-url http://localhost:8000 \\\n  --key-condition-expression "pk = :pk" \\\n  --expression-attribute-values \'{":pk":{"S":"TODO#tenant"}}\' \\\n  --scan-index-forward false --limit 5\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"DynamoDB Streams\u304c\u6709\u52b9\u3067\u51e6\u7406\u4e2d\u304b\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:".env\u3067LOCAL_DDB_SAMPLE_STREAM\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d"}),"\n",(0,i.jsx)(e.li,{children:"Lambda\u30ed\u30b0\u3067\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u30a8\u30e9\u30fc\u3092\u78ba\u8a8d"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Step Functions\u5b9f\u884c\u3092\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"aws stepfunctions list-executions \\\n  --endpoint-url http://localhost:8083 \\\n  --state-machine-arn arn:aws:states:ap-northeast-1:101010101010:stateMachine:command \\\n  --status-filter RUNNING\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u30c7\u30fc\u30bf\u540c\u671f\u30cf\u30f3\u30c9\u30e9\u30fc\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"// Check in your module (\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u78ba\u8a8d)\n@Module({\n  imports: [\n    CommandModule.register({\n      tableName: 'sample',\n      dataSyncHandlers: [YourSyncHandler], // Ensure registered (\u767b\u9332\u3092\u78ba\u8a8d)\n    }),\n  ],\n})\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u30b7\u30ca\u30ea\u30aa2step-function\u304crunning\u72b6\u614b\u3067\u505c\u6b62",children:"\u30b7\u30ca\u30ea\u30aa2\uff1aStep Function\u304cRUNNING\u72b6\u614b\u3067\u505c\u6b62"}),"\n",(0,i.jsx)(e.p,{children:"\u75c7\u72b6\uff1aStep Functions\u5b9f\u884c\u304c\u5b8c\u4e86\u3057\u307e\u305b\u3093\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u30c7\u30d0\u30c3\u30b0\u624b\u9806\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5b9f\u884c\u8a73\u7d30\u3092\u53d6\u5f97\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"aws stepfunctions describe-execution \\\n  --endpoint-url http://localhost:8083 \\\n  --execution-arn YOUR_EXECUTION_ARN\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"taskToken\u3092\u5f85\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"wait_prev_command"}),"\u3067\u505c\u6b62\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u524d\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u307e\u3060\u51e6\u7406\u4e2d\u3067\u3059"]}),"\n",(0,i.jsx)(e.li,{children:"\u524d\u306e\u30b3\u30de\u30f3\u30c9\u306etaskToken\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u304c\u9001\u4fe1\u3055\u308c\u305f\u304b\u78ba\u8a8d"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u30b3\u30de\u30f3\u30c9\u30c6\u30fc\u30d6\u30eb\u3067taskToken\u3092\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'aws dynamodb get-item \\\n  --table-name dev-myapp-sample-command \\\n  --endpoint-url http://localhost:8000 \\\n  --key \'{"pk":{"S":"TODO#tenant"},"sk":{"S":"TODO#001@2"}}\' \\\n  --projection-expression "taskToken, version, #s" \\\n  --expression-attribute-names \'{"#s": "status"}\'\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u624b\u52d5\u3067\u518d\u958b\uff08\u30c7\u30d0\u30c3\u30b0\u76ee\u7684\u306e\u307f\uff09\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'aws stepfunctions send-task-success \\\n  --endpoint-url http://localhost:8083 \\\n  --task-token "TASK_TOKEN_FROM_COMMAND" \\\n  --task-output \'{"Payload":[[{"result":0}]]}\'\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u30b7\u30ca\u30ea\u30aa3\u91cd\u8907\u30b3\u30de\u30f3\u30c9\u304c\u51e6\u7406\u3055\u308c\u3066\u3044\u308b",children:"\u30b7\u30ca\u30ea\u30aa3\uff1a\u91cd\u8907\u30b3\u30de\u30f3\u30c9\u304c\u51e6\u7406\u3055\u308c\u3066\u3044\u308b"}),"\n",(0,i.jsx)(e.p,{children:"\u75c7\u72b6\uff1a\u540c\u3058\u30b3\u30de\u30f3\u30c9\u304c\u8907\u6570\u56de\u51e6\u7406\u3055\u308c\u3066\u3044\u307e\u3059\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u30c7\u30d0\u30c3\u30b0\u624b\u9806\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u540c\u3058\u30c7\u30fc\u30bf\u3067\u8907\u6570\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'aws dynamodb query --table-name dev-myapp-sample-command \\\n  --endpoint-url http://localhost:8000 \\\n  --key-condition-expression "pk = :pk AND begins_with(sk, :sk)" \\\n  --expression-attribute-values \'{":pk":{"S":"TODO#tenant"},":sk":{"S":"TODO#001@"}}\' \\\n  --projection-expression "sk, version, requestId, createdAt"\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"requestId\u306e\u5024\u3092\u6bd4\u8f03\u3057\u3066\u91cd\u8907\u9001\u4fe1\u3092\u7279\u5b9a"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u6642\u306b\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u3044\u308b\u304b\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u78ba\u8a8d"}),"\n",(0,i.jsx)(e.li,{children:"\u51aa\u7b49\u6027\u30ad\u30fc\u3092\u5b9f\u88c5"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u30b7\u30ca\u30ea\u30aa4\u30c7\u30fc\u30bf\u540c\u671f\u30cf\u30f3\u30c9\u30e9\u30fc\u304c\u5b9f\u884c\u3055\u308c\u306a\u3044",children:"\u30b7\u30ca\u30ea\u30aa4\uff1a\u30c7\u30fc\u30bf\u540c\u671f\u30cf\u30f3\u30c9\u30e9\u30fc\u304c\u5b9f\u884c\u3055\u308c\u306a\u3044"}),"\n",(0,i.jsx)(e.p,{children:"\u75c7\u72b6\uff1a\u30b3\u30de\u30f3\u30c9\u306f\u4fdd\u5b58\u3055\u308c\u307e\u3057\u305f\u304c\u3001\u5916\u90e8\u30b7\u30b9\u30c6\u30e0\u306f\u66f4\u65b0\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u30c7\u30d0\u30c3\u30b0\u624b\u9806\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u30cf\u30f3\u30c9\u30e9\u30fc\u304c\u6b63\u3057\u304f\u30c7\u30b3\u30ec\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"@DataSyncHandler({\n  tableName: 'sample',\n  type: 'custom-sync',\n})\nexport class CustomSyncHandler implements IDataSyncHandler {\n  // ...\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u30cf\u30f3\u30c9\u30e9\u30fc\u304c\u691c\u51fa\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u30c7\u30d0\u30c3\u30b0\u30ed\u30ae\u30f3\u30b0\u3092\u6709\u52b9\u5316\uff1a",(0,i.jsx)(e.code,{children:"DEBUG=* npm run offline"})]}),"\n",(0,i.jsx)(e.li,{children:'"find data sync handlers from decorator"\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u63a2\u3059'}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u30cf\u30f3\u30c9\u30e9\u30fc\u306b\u30c7\u30d0\u30c3\u30b0\u3092\u8ffd\u52a0\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"async up(command: CommandModel): Promise<void> {\n  this.logger.debug(`CustomSyncHandler.up called: ${command.pk}#${command.sk}`);\n  // Your sync logic (\u540c\u671f\u30ed\u30b8\u30c3\u30af)\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u30b7\u30ca\u30ea\u30aa5x-ray\u30c8\u30ec\u30fc\u30b9\u304c\u8868\u793a\u3055\u308c\u306a\u3044",children:"\u30b7\u30ca\u30ea\u30aa5\uff1aX-Ray\u30c8\u30ec\u30fc\u30b9\u304c\u8868\u793a\u3055\u308c\u306a\u3044"}),"\n",(0,i.jsx)(e.p,{children:"\u75c7\u72b6\uff1aX-Ray\u30b5\u30fc\u30d3\u30b9\u30de\u30c3\u30d7\u307e\u305f\u306f\u30c8\u30ec\u30fc\u30b9\u304c\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u30c7\u30d0\u30c3\u30b0\u624b\u9806\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"CDK\u3067X-Ray\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"// Check Lambda function configuration (Lambda\u95a2\u6570\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d)\nconst handler = new NodejsFunction(this, 'Handler', {\n  tracing: lambda.Tracing.ACTIVE, // Should be ACTIVE (ACTIVE\u3067\u3042\u308b\u3079\u304d)\n});\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"IAM\u6a29\u9650\u306bX-Ray\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\n  "Effect": "Allow",\n  "Action": [\n    "xray:PutTraceSegments",\n    "xray:PutTelemetryRecords"\n  ],\n  "Resource": "*"\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"SDK\u30a4\u30f3\u30b9\u30c8\u30eb\u30e1\u30f3\u30c6\u30fc\u30b7\u30e7\u30f3\u306e\u5834\u5408\u3001\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u78ba\u8a8d\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import * as AWSXRay from 'aws-xray-sdk';\n// Must be called before any AWS SDK usage (AWS SDK\u4f7f\u7528\u524d\u306b\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u3042\u308b)\nconst AWS = AWSXRay.captureAWS(require('aws-sdk'));\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"./common-issues",children:"\u3088\u304f\u3042\u308b\u554f\u984c"})," - \u65e2\u77e5\u306e\u554f\u984c\u3068\u89e3\u6c7a\u7b56"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"./monitoring-logging",children:"\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3068\u30ed\u30ae\u30f3\u30b0"})," - \u5305\u62ec\u7684\u306a\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(o,{...n})}):o(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>l,x:()=>r});var a=s(6540);const i={},t=a.createContext(i);function l(n){const e=a.useContext(t);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),a.createElement(t.Provider,{value:e},n.children)}}}]);